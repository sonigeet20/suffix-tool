â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     DEPLOYMENT QUICK REFERENCE - Bright Data Fix             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… Date: January 14, 2026
ğŸ¯ Strategy: Incremental with rollback at each step
â±ï¸  Total Time: ~75 minutes
ğŸ”„ Rollback: Available at every phase

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ AUTOMATED DEPLOYMENT (RECOMMENDED)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

cd /Users/geetsoni/Downloads/suffix-tool-main\ 2
./deploy-incremental.sh

This script will:
âœ“ Create backups automatically
âœ“ Deploy Supabase edge function with --no-verify-jwt
âœ“ Test on single instance first (44.193.24.197)
âœ“ Run 10-minute soak test
âœ“ Deploy to remaining instances only if test passes
âœ“ Validate all components
âœ“ Stop at any failure with instructions

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“– MANUAL DEPLOYMENT (Step-by-step)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Follow: INCREMENTAL-DEPLOYMENT.md

Key Phases:
1. Backup & Preparation (5 min)
2. Supabase Edge Function (5 min) - with --no-verify-jwt
3. Test Instance Validation (20 min)
4. Remaining Instances (15 min)
5. Monitoring (30 min)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”´ EMERGENCY ROLLBACK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SUPABASE:
cd /Users/geetsoni/Downloads/suffix-tool-main\ 2
git checkout HEAD~1 supabase/functions/trace-redirects/index.ts
supabase functions deploy trace-redirects \
  --project-id rfhuqenntxiqurplenjn --no-verify-jwt

AWS EC2 (per instance):
ssh -i suffix-server.pem ec2-user@44.193.24.197
cd suffix-tool && git checkout HEAD~1
pm2 restart proxy-service

Full rollback guide: ROLLBACK-PLAN.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ª CRITICAL TESTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Edge Function:
curl -X POST https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/trace-redirects \
  -H "Content-Type: application/json" \
  -d '{"url":"https://httpbin.org/ip","mode":"http","max_redirects":5}' | jq .

EC2 Health:
ssh -i suffix-server.pem ec2-user@44.193.24.197 \
  "curl http://localhost:3000/health | jq .status"

Bright Data Fix Verification:
curl -X POST https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/trace-redirects \
  -H "Content-Type: application/json" \
  -d '{"url":"https://httpbin.org/ip","mode":"brightdata_browser","user_id":"test","offer_id":"test"}' \
  | jq .error

Expected: "No enabled Bright Data Browser provider found"
NOT: "requires user context" (would mean fix failed)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… SUCCESS CRITERIA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Supabase edge function deployed with --no-verify-jwt
âœ“ All 3 EC2 instances healthy
âœ“ HTTP mode working
âœ“ Browser mode working (Luna proxy)
âœ“ Bright Data error changed (fix verified)
âœ“ No critical errors in logs
âœ“ 10-minute soak test passed
âœ“ Error rate stable
âœ“ Response times normal

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš ï¸  STOP DEPLOYMENT IF
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ Edge function returns 500 errors
âŒ PM2 service crashes
âŒ Health check fails
âŒ Error rate increases >50%
âŒ Test instance shows critical errors
âŒ Proxy connections fail

â†’ Execute immediate rollback (see ROLLBACK-PLAN.md)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š POST-DEPLOYMENT MONITORING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Monitor for 24 hours:

Error Logs:
ssh -i suffix-server.pem ec2-user@44.193.24.197
pm2 logs proxy-service --lines 100 | grep -i error

Proxy IPs:
pm2 logs proxy-service --lines 100 | grep "Proxy IP used"

Health Status:
watch -n 60 'curl -s http://localhost:3000/health | jq .status'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ FILES REFERENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Deployment Plans:
  â”œâ”€ INCREMENTAL-DEPLOYMENT.md   (detailed step-by-step)
  â”œâ”€ ROLLBACK-PLAN.md            (emergency procedures)
  â”œâ”€ deploy-incremental.sh       (automated script)
  â””â”€ DEPLOYMENT-QUICK-REF.txt    (this file)

Test Reports:
  â”œâ”€ DEPLOYMENT-CHECKLIST.txt    (pre-deployment validation)
  â””â”€ PROXY-PROVIDERS-TEST-REPORT.txt (local test results)

Code Changes:
  â”œâ”€ NEW: proxy-service/lib/proxy-providers-handler.js
  â”œâ”€ MODIFIED: proxy-service/server.js
  â””â”€ MODIFIED: supabase/functions/trace-redirects/index.ts

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”‘ KEY POINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ Deploy edge function with --no-verify-jwt to keep public
âœ“ Test on 1 instance first (44.193.24.197)
âœ“ Run 10-minute soak test before proceeding
âœ“ Deploy to other instances only if test passes
âœ“ Rollback available at every step
âœ“ Backups created automatically
âœ“ All changes are backward compatible
âœ“ Zero breaking changes to existing functionality

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ INSTANCES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Test Instance (deploy first):
  IP: 44.193.24.197
  SSH: ssh -i suffix-server.pem ec2-user@44.193.24.197

Instance 2 (deploy after test):
  IP: 3.215.185.91
  SSH: ssh -i suffix-server.pem ec2-user@3.215.185.91

Instance 3 (deploy last):
  IP: 18.209.212.159
  SSH: ssh -i suffix-server.pem ec2-user@18.209.212.159

Supabase Project:
  ID: rfhuqenntxiqurplenjn
  Dashboard: https://app.supabase.com/project/rfhuqenntxiqurplenjn

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ¨ READY TO DEPLOY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Run automated deployment:
  cd /Users/geetsoni/Downloads/suffix-tool-main\ 2
  ./deploy-incremental.sh

Or follow manual steps:
  Read INCREMENTAL-DEPLOYMENT.md

Keep this file open during deployment for quick reference!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
