function D0(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function $0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var kd={exports:{}},Ga={},_d={exports:{}},G={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Es=Symbol.for("react.element"),M0=Symbol.for("react.portal"),z0=Symbol.for("react.fragment"),F0=Symbol.for("react.strict_mode"),B0=Symbol.for("react.profiler"),q0=Symbol.for("react.provider"),V0=Symbol.for("react.context"),W0=Symbol.for("react.forward_ref"),H0=Symbol.for("react.suspense"),G0=Symbol.for("react.memo"),K0=Symbol.for("react.lazy"),Ru=Symbol.iterator;function J0(e){return e===null||typeof e!="object"?null:(e=Ru&&e[Ru]||e["@@iterator"],typeof e=="function"?e:null)}var jd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nd=Object.assign,Sd={};function _n(e,t,r){this.props=e,this.context=t,this.refs=Sd,this.updater=r||jd}_n.prototype.isReactComponent={};_n.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_n.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ed(){}Ed.prototype=_n.prototype;function po(e,t,r){this.props=e,this.context=t,this.refs=Sd,this.updater=r||jd}var mo=po.prototype=new Ed;mo.constructor=po;Nd(mo,_n.prototype);mo.isPureReactComponent=!0;var Au=Array.isArray,Cd=Object.prototype.hasOwnProperty,go={current:null},Td={key:!0,ref:!0,__self:!0,__source:!0};function Rd(e,t,r){var n,s={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Cd.call(t,n)&&!Td.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Es,type:e,key:i,ref:l,props:s,_owner:go.current}}function Y0(e,t){return{$$typeof:Es,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xo(e){return typeof e=="object"&&e!==null&&e.$$typeof===Es}function Q0(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Pu=/\/+/g;function yi(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Q0(""+e.key):t.toString(36)}function na(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Es:case M0:l=!0}}if(l)return l=e,s=s(l),e=n===""?"."+yi(l,0):n,Au(s)?(r="",e!=null&&(r=e.replace(Pu,"$&/")+"/"),na(s,t,r,"",function(c){return c})):s!=null&&(xo(s)&&(s=Y0(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(Pu,"$&/")+"/")+e)),t.push(s)),1;if(l=0,n=n===""?".":n+":",Au(e))for(var o=0;o<e.length;o++){i=e[o];var u=n+yi(i,o);l+=na(i,t,r,u,s)}else if(u=J0(e),typeof u=="function")for(e=u.call(e),o=0;!(i=e.next()).done;)i=i.value,u=n+yi(i,o++),l+=na(i,t,r,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Us(e,t,r){if(e==null)return e;var n=[],s=0;return na(e,n,"","",function(i){return t.call(r,i,s++)}),n}function X0(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Le={current:null},sa={transition:null},Z0={ReactCurrentDispatcher:Le,ReactCurrentBatchConfig:sa,ReactCurrentOwner:go};function Ad(){throw Error("act(...) is not supported in production builds of React.")}G.Children={map:Us,forEach:function(e,t,r){Us(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Us(e,function(){t++}),t},toArray:function(e){return Us(e,function(t){return t})||[]},only:function(e){if(!xo(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};G.Component=_n;G.Fragment=z0;G.Profiler=B0;G.PureComponent=po;G.StrictMode=F0;G.Suspense=H0;G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z0;G.act=Ad;G.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Nd({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=go.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)Cd.call(t,u)&&!Td.hasOwnProperty(u)&&(n[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Es,type:e.type,key:s,ref:i,props:n,_owner:l}};G.createContext=function(e){return e={$$typeof:V0,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:q0,_context:e},e.Consumer=e};G.createElement=Rd;G.createFactory=function(e){var t=Rd.bind(null,e);return t.type=e,t};G.createRef=function(){return{current:null}};G.forwardRef=function(e){return{$$typeof:W0,render:e}};G.isValidElement=xo;G.lazy=function(e){return{$$typeof:K0,_payload:{_status:-1,_result:e},_init:X0}};G.memo=function(e,t){return{$$typeof:G0,type:e,compare:t===void 0?null:t}};G.startTransition=function(e){var t=sa.transition;sa.transition={};try{e()}finally{sa.transition=t}};G.unstable_act=Ad;G.useCallback=function(e,t){return Le.current.useCallback(e,t)};G.useContext=function(e){return Le.current.useContext(e)};G.useDebugValue=function(){};G.useDeferredValue=function(e){return Le.current.useDeferredValue(e)};G.useEffect=function(e,t){return Le.current.useEffect(e,t)};G.useId=function(){return Le.current.useId()};G.useImperativeHandle=function(e,t,r){return Le.current.useImperativeHandle(e,t,r)};G.useInsertionEffect=function(e,t){return Le.current.useInsertionEffect(e,t)};G.useLayoutEffect=function(e,t){return Le.current.useLayoutEffect(e,t)};G.useMemo=function(e,t){return Le.current.useMemo(e,t)};G.useReducer=function(e,t,r){return Le.current.useReducer(e,t,r)};G.useRef=function(e){return Le.current.useRef(e)};G.useState=function(e){return Le.current.useState(e)};G.useSyncExternalStore=function(e,t,r){return Le.current.useSyncExternalStore(e,t,r)};G.useTransition=function(){return Le.current.useTransition()};G.version="18.3.1";_d.exports=G;var w=_d.exports;const Pd=$0(w),ep=D0({__proto__:null,default:Pd},[w]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tp=w,rp=Symbol.for("react.element"),np=Symbol.for("react.fragment"),sp=Object.prototype.hasOwnProperty,ap=tp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ip={key:!0,ref:!0,__self:!0,__source:!0};function Od(e,t,r){var n,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)sp.call(t,n)&&!ip.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:rp,type:e,key:i,ref:l,props:s,_owner:ap.current}}Ga.Fragment=np;Ga.jsx=Od;Ga.jsxs=Od;kd.exports=Ga;var a=kd.exports,tl={},Id={exports:{}},Xe={},Ld={exports:{}},Ud={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,E){var P=T.length;T.push(E);e:for(;0<P;){var U=P-1>>>1,B=T[U];if(0<s(B,E))T[U]=E,T[P]=B,P=U;else break e}}function r(T){return T.length===0?null:T[0]}function n(T){if(T.length===0)return null;var E=T[0],P=T.pop();if(P!==E){T[0]=P;e:for(var U=0,B=T.length,D=B>>>1;U<D;){var me=2*(U+1)-1,K=T[me],we=me+1,jt=T[we];if(0>s(K,P))we<B&&0>s(jt,K)?(T[U]=jt,T[we]=P,U=we):(T[U]=K,T[me]=P,U=me);else if(we<B&&0>s(jt,P))T[U]=jt,T[we]=P,U=we;else break e}}return E}function s(T,E){var P=T.sortIndex-E.sortIndex;return P!==0?P:T.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var u=[],c=[],h=1,d=null,f=3,y=!1,x=!1,v=!1,j=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(T){for(var E=r(c);E!==null;){if(E.callback===null)n(c);else if(E.startTime<=T)n(c),E.sortIndex=E.expirationTime,t(u,E);else break;E=r(c)}}function _(T){if(v=!1,p(T),!x)if(r(u)!==null)x=!0,_t(C);else{var E=r(c);E!==null&&q(_,E.startTime-T)}}function C(T,E){x=!1,v&&(v=!1,g(k),k=-1),y=!0;var P=f;try{for(p(E),d=r(u);d!==null&&(!(d.expirationTime>E)||T&&!W());){var U=d.callback;if(typeof U=="function"){d.callback=null,f=d.priorityLevel;var B=U(d.expirationTime<=E);E=e.unstable_now(),typeof B=="function"?d.callback=B:d===r(u)&&n(u),p(E)}else n(u);d=r(u)}if(d!==null)var D=!0;else{var me=r(c);me!==null&&q(_,me.startTime-E),D=!1}return D}finally{d=null,f=P,y=!1}}var S=!1,N=null,k=-1,O=5,L=-1;function W(){return!(e.unstable_now()-L<O)}function le(){if(N!==null){var T=e.unstable_now();L=T;var E=!0;try{E=N(!0,T)}finally{E?ce():(S=!1,N=null)}}else S=!1}var ce;if(typeof m=="function")ce=function(){m(le)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,kt=Pe.port2;Pe.port1.onmessage=le,ce=function(){kt.postMessage(null)}}else ce=function(){j(le,0)};function _t(T){N=T,S||(S=!0,ce())}function q(T,E){k=j(function(){T(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){x||y||(x=!0,_t(C))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(T){switch(f){case 1:case 2:case 3:var E=3;break;default:E=f}var P=f;f=E;try{return T()}finally{f=P}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,E){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var P=f;f=T;try{return E()}finally{f=P}},e.unstable_scheduleCallback=function(T,E,P){var U=e.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?U+P:U):P=U,T){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=P+B,T={id:h++,callback:E,priorityLevel:T,startTime:P,expirationTime:B,sortIndex:-1},P>U?(T.sortIndex=P,t(c,T),r(u)===null&&T===r(c)&&(v?(g(k),k=-1):v=!0,q(_,P-U))):(T.sortIndex=B,t(u,T),x||y||(x=!0,_t(C))),T},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(T){var E=f;return function(){var P=f;f=E;try{return T.apply(this,arguments)}finally{f=P}}}})(Ud);Ld.exports=Ud;var lp=Ld.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var op=w,Qe=lp;function R(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dd=new Set,es={};function Ir(e,t){gn(e,t),gn(e+"Capture",t)}function gn(e,t){for(es[e]=t,e=0;e<t.length;e++)Dd.add(t[e])}var Pt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rl=Object.prototype.hasOwnProperty,up=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ou={},Iu={};function cp(e){return rl.call(Iu,e)?!0:rl.call(Ou,e)?!1:up.test(e)?Iu[e]=!0:(Ou[e]=!0,!1)}function dp(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hp(e,t,r,n){if(t===null||typeof t>"u"||dp(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ue(e,t,r,n,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var Se={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Se[e]=new Ue(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Se[t]=new Ue(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Se[e]=new Ue(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Se[e]=new Ue(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Se[e]=new Ue(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Se[e]=new Ue(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Se[e]=new Ue(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Se[e]=new Ue(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Se[e]=new Ue(e,5,!1,e.toLowerCase(),null,!1,!1)});var yo=/[\-:]([a-z])/g;function vo(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(yo,vo);Se[t]=new Ue(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(yo,vo);Se[t]=new Ue(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(yo,vo);Se[t]=new Ue(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Se[e]=new Ue(e,1,!1,e.toLowerCase(),null,!1,!1)});Se.xlinkHref=new Ue("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Se[e]=new Ue(e,1,!1,e.toLowerCase(),null,!0,!0)});function bo(e,t,r,n){var s=Se.hasOwnProperty(t)?Se[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hp(t,r,s,n)&&(r=null),n||s===null?cp(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Dt=op.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ds=Symbol.for("react.element"),Jr=Symbol.for("react.portal"),Yr=Symbol.for("react.fragment"),wo=Symbol.for("react.strict_mode"),nl=Symbol.for("react.profiler"),$d=Symbol.for("react.provider"),Md=Symbol.for("react.context"),ko=Symbol.for("react.forward_ref"),sl=Symbol.for("react.suspense"),al=Symbol.for("react.suspense_list"),_o=Symbol.for("react.memo"),Ft=Symbol.for("react.lazy"),zd=Symbol.for("react.offscreen"),Lu=Symbol.iterator;function Tn(e){return e===null||typeof e!="object"?null:(e=Lu&&e[Lu]||e["@@iterator"],typeof e=="function"?e:null)}var ie=Object.assign,vi;function $n(e){if(vi===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);vi=t&&t[1]||""}return`
`+vi+e}var bi=!1;function wi(e,t){if(!e||bi)return"";bi=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),l=s.length-1,o=i.length-1;1<=l&&0<=o&&s[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(s[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||s[l]!==i[o]){var u=`
`+s[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=o);break}}}finally{bi=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?$n(e):""}function fp(e){switch(e.tag){case 5:return $n(e.type);case 16:return $n("Lazy");case 13:return $n("Suspense");case 19:return $n("SuspenseList");case 0:case 2:case 15:return e=wi(e.type,!1),e;case 11:return e=wi(e.type.render,!1),e;case 1:return e=wi(e.type,!0),e;default:return""}}function il(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Yr:return"Fragment";case Jr:return"Portal";case nl:return"Profiler";case wo:return"StrictMode";case sl:return"Suspense";case al:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Md:return(e.displayName||"Context")+".Consumer";case $d:return(e._context.displayName||"Context")+".Provider";case ko:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _o:return t=e.displayName||null,t!==null?t:il(e.type)||"Memo";case Ft:t=e._payload,e=e._init;try{return il(e(t))}catch{}}return null}function pp(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return il(t);case 8:return t===wo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ir(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Fd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function mp(e){var t=Fd(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $s(e){e._valueTracker||(e._valueTracker=mp(e))}function Bd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Fd(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ga(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ll(e,t){var r=t.checked;return ie({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Uu(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ir(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function qd(e,t){t=t.checked,t!=null&&bo(e,"checked",t,!1)}function ol(e,t){qd(e,t);var r=ir(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ul(e,t.type,r):t.hasOwnProperty("defaultValue")&&ul(e,t.type,ir(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Du(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ul(e,t,r){(t!=="number"||ga(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Mn=Array.isArray;function un(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ir(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function cl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(R(91));return ie({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $u(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(R(92));if(Mn(r)){if(1<r.length)throw Error(R(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ir(r)}}function Vd(e,t){var r=ir(t.value),n=ir(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Mu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Wd(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Wd(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ms,Hd=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ms=Ms||document.createElement("div"),Ms.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ms.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ts(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var qn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gp=["Webkit","ms","Moz","O"];Object.keys(qn).forEach(function(e){gp.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),qn[t]=qn[e]})});function Gd(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||qn.hasOwnProperty(e)&&qn[e]?(""+t).trim():t+"px"}function Kd(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Gd(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var xp=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hl(e,t){if(t){if(xp[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(R(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(R(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(R(61))}if(t.style!=null&&typeof t.style!="object")throw Error(R(62))}}function fl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pl=null;function jo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ml=null,cn=null,dn=null;function zu(e){if(e=Rs(e)){if(typeof ml!="function")throw Error(R(280));var t=e.stateNode;t&&(t=Xa(t),ml(e.stateNode,e.type,t))}}function Jd(e){cn?dn?dn.push(e):dn=[e]:cn=e}function Yd(){if(cn){var e=cn,t=dn;if(dn=cn=null,zu(e),t)for(e=0;e<t.length;e++)zu(t[e])}}function Qd(e,t){return e(t)}function Xd(){}var ki=!1;function Zd(e,t,r){if(ki)return e(t,r);ki=!0;try{return Qd(e,t,r)}finally{ki=!1,(cn!==null||dn!==null)&&(Xd(),Yd())}}function rs(e,t){var r=e.stateNode;if(r===null)return null;var n=Xa(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(R(231,t,typeof r));return r}var gl=!1;if(Pt)try{var Rn={};Object.defineProperty(Rn,"passive",{get:function(){gl=!0}}),window.addEventListener("test",Rn,Rn),window.removeEventListener("test",Rn,Rn)}catch{gl=!1}function yp(e,t,r,n,s,i,l,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(h){this.onError(h)}}var Vn=!1,xa=null,ya=!1,xl=null,vp={onError:function(e){Vn=!0,xa=e}};function bp(e,t,r,n,s,i,l,o,u){Vn=!1,xa=null,yp.apply(vp,arguments)}function wp(e,t,r,n,s,i,l,o,u){if(bp.apply(this,arguments),Vn){if(Vn){var c=xa;Vn=!1,xa=null}else throw Error(R(198));ya||(ya=!0,xl=c)}}function Lr(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function eh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Fu(e){if(Lr(e)!==e)throw Error(R(188))}function kp(e){var t=e.alternate;if(!t){if(t=Lr(e),t===null)throw Error(R(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Fu(s),e;if(i===n)return Fu(s),t;i=i.sibling}throw Error(R(188))}if(r.return!==n.return)r=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l)throw Error(R(189))}}if(r.alternate!==n)throw Error(R(190))}if(r.tag!==3)throw Error(R(188));return r.stateNode.current===r?e:t}function th(e){return e=kp(e),e!==null?rh(e):null}function rh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=rh(e);if(t!==null)return t;e=e.sibling}return null}var nh=Qe.unstable_scheduleCallback,Bu=Qe.unstable_cancelCallback,_p=Qe.unstable_shouldYield,jp=Qe.unstable_requestPaint,de=Qe.unstable_now,Np=Qe.unstable_getCurrentPriorityLevel,No=Qe.unstable_ImmediatePriority,sh=Qe.unstable_UserBlockingPriority,va=Qe.unstable_NormalPriority,Sp=Qe.unstable_LowPriority,ah=Qe.unstable_IdlePriority,Ka=null,bt=null;function Ep(e){if(bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(Ka,e,void 0,(e.current.flags&128)===128)}catch{}}var ft=Math.clz32?Math.clz32:Rp,Cp=Math.log,Tp=Math.LN2;function Rp(e){return e>>>=0,e===0?32:31-(Cp(e)/Tp|0)|0}var zs=64,Fs=4194304;function zn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ba(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~s;o!==0?n=zn(o):(i&=l,i!==0&&(n=zn(i)))}else l=r&~s,l!==0?n=zn(l):i!==0&&(n=zn(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ft(t),s=1<<r,n|=e[r],t&=~s;return n}function Ap(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pp(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-ft(i),o=1<<l,u=s[l];u===-1?(!(o&r)||o&n)&&(s[l]=Ap(o,t)):u<=t&&(e.expiredLanes|=o),i&=~o}}function yl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ih(){var e=zs;return zs<<=1,!(zs&4194240)&&(zs=64),e}function _i(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Cs(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ft(t),e[t]=r}function Op(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-ft(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function So(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ft(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Q=0;function lh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var oh,Eo,uh,ch,dh,vl=!1,Bs=[],Yt=null,Qt=null,Xt=null,ns=new Map,ss=new Map,Vt=[],Ip="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qu(e,t){switch(e){case"focusin":case"focusout":Yt=null;break;case"dragenter":case"dragleave":Qt=null;break;case"mouseover":case"mouseout":Xt=null;break;case"pointerover":case"pointerout":ns.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ss.delete(t.pointerId)}}function An(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Rs(t),t!==null&&Eo(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Lp(e,t,r,n,s){switch(t){case"focusin":return Yt=An(Yt,e,t,r,n,s),!0;case"dragenter":return Qt=An(Qt,e,t,r,n,s),!0;case"mouseover":return Xt=An(Xt,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return ns.set(i,An(ns.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,ss.set(i,An(ss.get(i)||null,e,t,r,n,s)),!0}return!1}function hh(e){var t=br(e.target);if(t!==null){var r=Lr(t);if(r!==null){if(t=r.tag,t===13){if(t=eh(r),t!==null){e.blockedOn=t,dh(e.priority,function(){uh(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function aa(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=bl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);pl=n,r.target.dispatchEvent(n),pl=null}else return t=Rs(r),t!==null&&Eo(t),e.blockedOn=r,!1;t.shift()}return!0}function Vu(e,t,r){aa(e)&&r.delete(t)}function Up(){vl=!1,Yt!==null&&aa(Yt)&&(Yt=null),Qt!==null&&aa(Qt)&&(Qt=null),Xt!==null&&aa(Xt)&&(Xt=null),ns.forEach(Vu),ss.forEach(Vu)}function Pn(e,t){e.blockedOn===t&&(e.blockedOn=null,vl||(vl=!0,Qe.unstable_scheduleCallback(Qe.unstable_NormalPriority,Up)))}function as(e){function t(s){return Pn(s,e)}if(0<Bs.length){Pn(Bs[0],e);for(var r=1;r<Bs.length;r++){var n=Bs[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Yt!==null&&Pn(Yt,e),Qt!==null&&Pn(Qt,e),Xt!==null&&Pn(Xt,e),ns.forEach(t),ss.forEach(t),r=0;r<Vt.length;r++)n=Vt[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Vt.length&&(r=Vt[0],r.blockedOn===null);)hh(r),r.blockedOn===null&&Vt.shift()}var hn=Dt.ReactCurrentBatchConfig,wa=!0;function Dp(e,t,r,n){var s=Q,i=hn.transition;hn.transition=null;try{Q=1,Co(e,t,r,n)}finally{Q=s,hn.transition=i}}function $p(e,t,r,n){var s=Q,i=hn.transition;hn.transition=null;try{Q=4,Co(e,t,r,n)}finally{Q=s,hn.transition=i}}function Co(e,t,r,n){if(wa){var s=bl(e,t,r,n);if(s===null)Oi(e,t,n,ka,r),qu(e,n);else if(Lp(s,e,t,r,n))n.stopPropagation();else if(qu(e,n),t&4&&-1<Ip.indexOf(e)){for(;s!==null;){var i=Rs(s);if(i!==null&&oh(i),i=bl(e,t,r,n),i===null&&Oi(e,t,n,ka,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Oi(e,t,n,null,r)}}var ka=null;function bl(e,t,r,n){if(ka=null,e=jo(n),e=br(e),e!==null)if(t=Lr(e),t===null)e=null;else if(r=t.tag,r===13){if(e=eh(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ka=e,null}function fh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Np()){case No:return 1;case sh:return 4;case va:case Sp:return 16;case ah:return 536870912;default:return 16}default:return 16}}var Gt=null,To=null,ia=null;function ph(){if(ia)return ia;var e,t=To,r=t.length,n,s="value"in Gt?Gt.value:Gt.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===s[i-n];n++);return ia=s.slice(e,1<n?1-n:void 0)}function la(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function qs(){return!0}function Wu(){return!1}function Ze(e){function t(r,n,s,i,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?qs:Wu,this.isPropagationStopped=Wu,this}return ie(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qs)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qs)},persist:function(){},isPersistent:qs}),t}var jn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=Ze(jn),Ts=ie({},jn,{view:0,detail:0}),Mp=Ze(Ts),ji,Ni,On,Ja=ie({},Ts,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ao,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==On&&(On&&e.type==="mousemove"?(ji=e.screenX-On.screenX,Ni=e.screenY-On.screenY):Ni=ji=0,On=e),ji)},movementY:function(e){return"movementY"in e?e.movementY:Ni}}),Hu=Ze(Ja),zp=ie({},Ja,{dataTransfer:0}),Fp=Ze(zp),Bp=ie({},Ts,{relatedTarget:0}),Si=Ze(Bp),qp=ie({},jn,{animationName:0,elapsedTime:0,pseudoElement:0}),Vp=Ze(qp),Wp=ie({},jn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Hp=Ze(Wp),Gp=ie({},jn,{data:0}),Gu=Ze(Gp),Kp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Yp[e])?!!t[e]:!1}function Ao(){return Qp}var Xp=ie({},Ts,{key:function(e){if(e.key){var t=Kp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=la(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Jp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ao,charCode:function(e){return e.type==="keypress"?la(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?la(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Zp=Ze(Xp),em=ie({},Ja,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ku=Ze(em),tm=ie({},Ts,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ao}),rm=Ze(tm),nm=ie({},jn,{propertyName:0,elapsedTime:0,pseudoElement:0}),sm=Ze(nm),am=ie({},Ja,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),im=Ze(am),lm=[9,13,27,32],Po=Pt&&"CompositionEvent"in window,Wn=null;Pt&&"documentMode"in document&&(Wn=document.documentMode);var om=Pt&&"TextEvent"in window&&!Wn,mh=Pt&&(!Po||Wn&&8<Wn&&11>=Wn),Ju=" ",Yu=!1;function gh(e,t){switch(e){case"keyup":return lm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Qr=!1;function um(e,t){switch(e){case"compositionend":return xh(t);case"keypress":return t.which!==32?null:(Yu=!0,Ju);case"textInput":return e=t.data,e===Ju&&Yu?null:e;default:return null}}function cm(e,t){if(Qr)return e==="compositionend"||!Po&&gh(e,t)?(e=ph(),ia=To=Gt=null,Qr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return mh&&t.locale!=="ko"?null:t.data;default:return null}}var dm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!dm[e.type]:t==="textarea"}function yh(e,t,r,n){Jd(n),t=_a(t,"onChange"),0<t.length&&(r=new Ro("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Hn=null,is=null;function hm(e){Th(e,0)}function Ya(e){var t=en(e);if(Bd(t))return e}function fm(e,t){if(e==="change")return t}var vh=!1;if(Pt){var Ei;if(Pt){var Ci="oninput"in document;if(!Ci){var Xu=document.createElement("div");Xu.setAttribute("oninput","return;"),Ci=typeof Xu.oninput=="function"}Ei=Ci}else Ei=!1;vh=Ei&&(!document.documentMode||9<document.documentMode)}function Zu(){Hn&&(Hn.detachEvent("onpropertychange",bh),is=Hn=null)}function bh(e){if(e.propertyName==="value"&&Ya(is)){var t=[];yh(t,is,e,jo(e)),Zd(hm,t)}}function pm(e,t,r){e==="focusin"?(Zu(),Hn=t,is=r,Hn.attachEvent("onpropertychange",bh)):e==="focusout"&&Zu()}function mm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ya(is)}function gm(e,t){if(e==="click")return Ya(t)}function xm(e,t){if(e==="input"||e==="change")return Ya(t)}function ym(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mt=typeof Object.is=="function"?Object.is:ym;function ls(e,t){if(mt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!rl.call(t,s)||!mt(e[s],t[s]))return!1}return!0}function ec(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tc(e,t){var r=ec(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ec(r)}}function wh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?wh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function kh(){for(var e=window,t=ga();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ga(e.document)}return t}function Oo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function vm(e){var t=kh(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&wh(r.ownerDocument.documentElement,r)){if(n!==null&&Oo(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=tc(r,i);var l=tc(r,n);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var bm=Pt&&"documentMode"in document&&11>=document.documentMode,Xr=null,wl=null,Gn=null,kl=!1;function rc(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;kl||Xr==null||Xr!==ga(n)||(n=Xr,"selectionStart"in n&&Oo(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Gn&&ls(Gn,n)||(Gn=n,n=_a(wl,"onSelect"),0<n.length&&(t=new Ro("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Xr)))}function Vs(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Zr={animationend:Vs("Animation","AnimationEnd"),animationiteration:Vs("Animation","AnimationIteration"),animationstart:Vs("Animation","AnimationStart"),transitionend:Vs("Transition","TransitionEnd")},Ti={},_h={};Pt&&(_h=document.createElement("div").style,"AnimationEvent"in window||(delete Zr.animationend.animation,delete Zr.animationiteration.animation,delete Zr.animationstart.animation),"TransitionEvent"in window||delete Zr.transitionend.transition);function Qa(e){if(Ti[e])return Ti[e];if(!Zr[e])return e;var t=Zr[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in _h)return Ti[e]=t[r];return e}var jh=Qa("animationend"),Nh=Qa("animationiteration"),Sh=Qa("animationstart"),Eh=Qa("transitionend"),Ch=new Map,nc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function or(e,t){Ch.set(e,t),Ir(t,[e])}for(var Ri=0;Ri<nc.length;Ri++){var Ai=nc[Ri],wm=Ai.toLowerCase(),km=Ai[0].toUpperCase()+Ai.slice(1);or(wm,"on"+km)}or(jh,"onAnimationEnd");or(Nh,"onAnimationIteration");or(Sh,"onAnimationStart");or("dblclick","onDoubleClick");or("focusin","onFocus");or("focusout","onBlur");or(Eh,"onTransitionEnd");gn("onMouseEnter",["mouseout","mouseover"]);gn("onMouseLeave",["mouseout","mouseover"]);gn("onPointerEnter",["pointerout","pointerover"]);gn("onPointerLeave",["pointerout","pointerover"]);Ir("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ir("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ir("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ir("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_m=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fn));function sc(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,wp(n,t,void 0,e),e.currentTarget=null}function Th(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==i&&s.isPropagationStopped())break e;sc(s,o,c),i=u}else for(l=0;l<n.length;l++){if(o=n[l],u=o.instance,c=o.currentTarget,o=o.listener,u!==i&&s.isPropagationStopped())break e;sc(s,o,c),i=u}}}if(ya)throw e=xl,ya=!1,xl=null,e}function ee(e,t){var r=t[El];r===void 0&&(r=t[El]=new Set);var n=e+"__bubble";r.has(n)||(Rh(t,e,2,!1),r.add(n))}function Pi(e,t,r){var n=0;t&&(n|=4),Rh(r,e,n,t)}var Ws="_reactListening"+Math.random().toString(36).slice(2);function os(e){if(!e[Ws]){e[Ws]=!0,Dd.forEach(function(r){r!=="selectionchange"&&(_m.has(r)||Pi(r,!1,e),Pi(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ws]||(t[Ws]=!0,Pi("selectionchange",!1,t))}}function Rh(e,t,r,n){switch(fh(t)){case 1:var s=Dp;break;case 4:s=$p;break;default:s=Co}r=s.bind(null,t,r,e),s=void 0,!gl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Oi(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;l=l.return}for(;o!==null;){if(l=br(o),l===null)return;if(u=l.tag,u===5||u===6){n=i=l;continue e}o=o.parentNode}}n=n.return}Zd(function(){var c=i,h=jo(r),d=[];e:{var f=Ch.get(e);if(f!==void 0){var y=Ro,x=e;switch(e){case"keypress":if(la(r)===0)break e;case"keydown":case"keyup":y=Zp;break;case"focusin":x="focus",y=Si;break;case"focusout":x="blur",y=Si;break;case"beforeblur":case"afterblur":y=Si;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Hu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=Fp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=rm;break;case jh:case Nh:case Sh:y=Vp;break;case Eh:y=sm;break;case"scroll":y=Mp;break;case"wheel":y=im;break;case"copy":case"cut":case"paste":y=Hp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Ku}var v=(t&4)!==0,j=!v&&e==="scroll",g=v?f!==null?f+"Capture":null:f;v=[];for(var m=c,p;m!==null;){p=m;var _=p.stateNode;if(p.tag===5&&_!==null&&(p=_,g!==null&&(_=rs(m,g),_!=null&&v.push(us(m,_,p)))),j)break;m=m.return}0<v.length&&(f=new y(f,x,null,r,h),d.push({event:f,listeners:v}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",f&&r!==pl&&(x=r.relatedTarget||r.fromElement)&&(br(x)||x[Ot]))break e;if((y||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,y?(x=r.relatedTarget||r.toElement,y=c,x=x?br(x):null,x!==null&&(j=Lr(x),x!==j||x.tag!==5&&x.tag!==6)&&(x=null)):(y=null,x=c),y!==x)){if(v=Hu,_="onMouseLeave",g="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(v=Ku,_="onPointerLeave",g="onPointerEnter",m="pointer"),j=y==null?f:en(y),p=x==null?f:en(x),f=new v(_,m+"leave",y,r,h),f.target=j,f.relatedTarget=p,_=null,br(h)===c&&(v=new v(g,m+"enter",x,r,h),v.target=p,v.relatedTarget=j,_=v),j=_,y&&x)t:{for(v=y,g=x,m=0,p=v;p;p=Dr(p))m++;for(p=0,_=g;_;_=Dr(_))p++;for(;0<m-p;)v=Dr(v),m--;for(;0<p-m;)g=Dr(g),p--;for(;m--;){if(v===g||g!==null&&v===g.alternate)break t;v=Dr(v),g=Dr(g)}v=null}else v=null;y!==null&&ac(d,f,y,v,!1),x!==null&&j!==null&&ac(d,j,x,v,!0)}}e:{if(f=c?en(c):window,y=f.nodeName&&f.nodeName.toLowerCase(),y==="select"||y==="input"&&f.type==="file")var C=fm;else if(Qu(f))if(vh)C=xm;else{C=mm;var S=pm}else(y=f.nodeName)&&y.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=gm);if(C&&(C=C(e,c))){yh(d,C,r,h);break e}S&&S(e,f,c),e==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&ul(f,"number",f.value)}switch(S=c?en(c):window,e){case"focusin":(Qu(S)||S.contentEditable==="true")&&(Xr=S,wl=c,Gn=null);break;case"focusout":Gn=wl=Xr=null;break;case"mousedown":kl=!0;break;case"contextmenu":case"mouseup":case"dragend":kl=!1,rc(d,r,h);break;case"selectionchange":if(bm)break;case"keydown":case"keyup":rc(d,r,h)}var N;if(Po)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Qr?gh(e,r)&&(k="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(mh&&r.locale!=="ko"&&(Qr||k!=="onCompositionStart"?k==="onCompositionEnd"&&Qr&&(N=ph()):(Gt=h,To="value"in Gt?Gt.value:Gt.textContent,Qr=!0)),S=_a(c,k),0<S.length&&(k=new Gu(k,e,null,r,h),d.push({event:k,listeners:S}),N?k.data=N:(N=xh(r),N!==null&&(k.data=N)))),(N=om?um(e,r):cm(e,r))&&(c=_a(c,"onBeforeInput"),0<c.length&&(h=new Gu("onBeforeInput","beforeinput",null,r,h),d.push({event:h,listeners:c}),h.data=N))}Th(d,t)})}function us(e,t,r){return{instance:e,listener:t,currentTarget:r}}function _a(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=rs(e,r),i!=null&&n.unshift(us(e,i,s)),i=rs(e,t),i!=null&&n.push(us(e,i,s))),e=e.return}return n}function Dr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ac(e,t,r,n,s){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,u=o.alternate,c=o.stateNode;if(u!==null&&u===n)break;o.tag===5&&c!==null&&(o=c,s?(u=rs(r,i),u!=null&&l.unshift(us(r,u,o))):s||(u=rs(r,i),u!=null&&l.push(us(r,u,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var jm=/\r\n?/g,Nm=/\u0000|\uFFFD/g;function ic(e){return(typeof e=="string"?e:""+e).replace(jm,`
`).replace(Nm,"")}function Hs(e,t,r){if(t=ic(t),ic(e)!==t&&r)throw Error(R(425))}function ja(){}var _l=null,jl=null;function Nl(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Sl=typeof setTimeout=="function"?setTimeout:void 0,Sm=typeof clearTimeout=="function"?clearTimeout:void 0,lc=typeof Promise=="function"?Promise:void 0,Em=typeof queueMicrotask=="function"?queueMicrotask:typeof lc<"u"?function(e){return lc.resolve(null).then(e).catch(Cm)}:Sl;function Cm(e){setTimeout(function(){throw e})}function Ii(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),as(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);as(t)}function Zt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function oc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Nn=Math.random().toString(36).slice(2),vt="__reactFiber$"+Nn,cs="__reactProps$"+Nn,Ot="__reactContainer$"+Nn,El="__reactEvents$"+Nn,Tm="__reactListeners$"+Nn,Rm="__reactHandles$"+Nn;function br(e){var t=e[vt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ot]||r[vt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=oc(e);e!==null;){if(r=e[vt])return r;e=oc(e)}return t}e=r,r=e.parentNode}return null}function Rs(e){return e=e[vt]||e[Ot],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function en(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(R(33))}function Xa(e){return e[cs]||null}var Cl=[],tn=-1;function ur(e){return{current:e}}function te(e){0>tn||(e.current=Cl[tn],Cl[tn]=null,tn--)}function Z(e,t){tn++,Cl[tn]=e.current,e.current=t}var lr={},Ae=ur(lr),Me=ur(!1),Tr=lr;function xn(e,t){var r=e.type.contextTypes;if(!r)return lr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ze(e){return e=e.childContextTypes,e!=null}function Na(){te(Me),te(Ae)}function uc(e,t,r){if(Ae.current!==lr)throw Error(R(168));Z(Ae,t),Z(Me,r)}function Ah(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(R(108,pp(e)||"Unknown",s));return ie({},r,n)}function Sa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||lr,Tr=Ae.current,Z(Ae,e),Z(Me,Me.current),!0}function cc(e,t,r){var n=e.stateNode;if(!n)throw Error(R(169));r?(e=Ah(e,t,Tr),n.__reactInternalMemoizedMergedChildContext=e,te(Me),te(Ae),Z(Ae,e)):te(Me),Z(Me,r)}var Ct=null,Za=!1,Li=!1;function Ph(e){Ct===null?Ct=[e]:Ct.push(e)}function Am(e){Za=!0,Ph(e)}function cr(){if(!Li&&Ct!==null){Li=!0;var e=0,t=Q;try{var r=Ct;for(Q=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ct=null,Za=!1}catch(s){throw Ct!==null&&(Ct=Ct.slice(e+1)),nh(No,cr),s}finally{Q=t,Li=!1}}return null}var rn=[],nn=0,Ea=null,Ca=0,et=[],tt=0,Rr=null,Tt=1,Rt="";function mr(e,t){rn[nn++]=Ca,rn[nn++]=Ea,Ea=e,Ca=t}function Oh(e,t,r){et[tt++]=Tt,et[tt++]=Rt,et[tt++]=Rr,Rr=e;var n=Tt;e=Rt;var s=32-ft(n)-1;n&=~(1<<s),r+=1;var i=32-ft(t)+s;if(30<i){var l=s-s%5;i=(n&(1<<l)-1).toString(32),n>>=l,s-=l,Tt=1<<32-ft(t)+s|r<<s|n,Rt=i+e}else Tt=1<<i|r<<s|n,Rt=e}function Io(e){e.return!==null&&(mr(e,1),Oh(e,1,0))}function Lo(e){for(;e===Ea;)Ea=rn[--nn],rn[nn]=null,Ca=rn[--nn],rn[nn]=null;for(;e===Rr;)Rr=et[--tt],et[tt]=null,Rt=et[--tt],et[tt]=null,Tt=et[--tt],et[tt]=null}var Ye=null,Je=null,re=!1,ht=null;function Ih(e,t){var r=rt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function dc(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ye=e,Je=Zt(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ye=e,Je=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Rr!==null?{id:Tt,overflow:Rt}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=rt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ye=e,Je=null,!0):!1;default:return!1}}function Tl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rl(e){if(re){var t=Je;if(t){var r=t;if(!dc(e,t)){if(Tl(e))throw Error(R(418));t=Zt(r.nextSibling);var n=Ye;t&&dc(e,t)?Ih(n,r):(e.flags=e.flags&-4097|2,re=!1,Ye=e)}}else{if(Tl(e))throw Error(R(418));e.flags=e.flags&-4097|2,re=!1,Ye=e}}}function hc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ye=e}function Gs(e){if(e!==Ye)return!1;if(!re)return hc(e),re=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Nl(e.type,e.memoizedProps)),t&&(t=Je)){if(Tl(e))throw Lh(),Error(R(418));for(;t;)Ih(e,t),t=Zt(t.nextSibling)}if(hc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(R(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Je=Zt(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Je=null}}else Je=Ye?Zt(e.stateNode.nextSibling):null;return!0}function Lh(){for(var e=Je;e;)e=Zt(e.nextSibling)}function yn(){Je=Ye=null,re=!1}function Uo(e){ht===null?ht=[e]:ht.push(e)}var Pm=Dt.ReactCurrentBatchConfig;function In(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(R(309));var n=r.stateNode}if(!n)throw Error(R(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=s.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(R(284));if(!r._owner)throw Error(R(290,e))}return e}function Ks(e,t){throw e=Object.prototype.toString.call(t),Error(R(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fc(e){var t=e._init;return t(e._payload)}function Uh(e){function t(g,m){if(e){var p=g.deletions;p===null?(g.deletions=[m],g.flags|=16):p.push(m)}}function r(g,m){if(!e)return null;for(;m!==null;)t(g,m),m=m.sibling;return null}function n(g,m){for(g=new Map;m!==null;)m.key!==null?g.set(m.key,m):g.set(m.index,m),m=m.sibling;return g}function s(g,m){return g=nr(g,m),g.index=0,g.sibling=null,g}function i(g,m,p){return g.index=p,e?(p=g.alternate,p!==null?(p=p.index,p<m?(g.flags|=2,m):p):(g.flags|=2,m)):(g.flags|=1048576,m)}function l(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,m,p,_){return m===null||m.tag!==6?(m=Bi(p,g.mode,_),m.return=g,m):(m=s(m,p),m.return=g,m)}function u(g,m,p,_){var C=p.type;return C===Yr?h(g,m,p.props.children,_,p.key):m!==null&&(m.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ft&&fc(C)===m.type)?(_=s(m,p.props),_.ref=In(g,m,p),_.return=g,_):(_=pa(p.type,p.key,p.props,null,g.mode,_),_.ref=In(g,m,p),_.return=g,_)}function c(g,m,p,_){return m===null||m.tag!==4||m.stateNode.containerInfo!==p.containerInfo||m.stateNode.implementation!==p.implementation?(m=qi(p,g.mode,_),m.return=g,m):(m=s(m,p.children||[]),m.return=g,m)}function h(g,m,p,_,C){return m===null||m.tag!==7?(m=Er(p,g.mode,_,C),m.return=g,m):(m=s(m,p),m.return=g,m)}function d(g,m,p){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Bi(""+m,g.mode,p),m.return=g,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ds:return p=pa(m.type,m.key,m.props,null,g.mode,p),p.ref=In(g,null,m),p.return=g,p;case Jr:return m=qi(m,g.mode,p),m.return=g,m;case Ft:var _=m._init;return d(g,_(m._payload),p)}if(Mn(m)||Tn(m))return m=Er(m,g.mode,p,null),m.return=g,m;Ks(g,m)}return null}function f(g,m,p,_){var C=m!==null?m.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return C!==null?null:o(g,m,""+p,_);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ds:return p.key===C?u(g,m,p,_):null;case Jr:return p.key===C?c(g,m,p,_):null;case Ft:return C=p._init,f(g,m,C(p._payload),_)}if(Mn(p)||Tn(p))return C!==null?null:h(g,m,p,_,null);Ks(g,p)}return null}function y(g,m,p,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(p)||null,o(m,g,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ds:return g=g.get(_.key===null?p:_.key)||null,u(m,g,_,C);case Jr:return g=g.get(_.key===null?p:_.key)||null,c(m,g,_,C);case Ft:var S=_._init;return y(g,m,p,S(_._payload),C)}if(Mn(_)||Tn(_))return g=g.get(p)||null,h(m,g,_,C,null);Ks(m,_)}return null}function x(g,m,p,_){for(var C=null,S=null,N=m,k=m=0,O=null;N!==null&&k<p.length;k++){N.index>k?(O=N,N=null):O=N.sibling;var L=f(g,N,p[k],_);if(L===null){N===null&&(N=O);break}e&&N&&L.alternate===null&&t(g,N),m=i(L,m,k),S===null?C=L:S.sibling=L,S=L,N=O}if(k===p.length)return r(g,N),re&&mr(g,k),C;if(N===null){for(;k<p.length;k++)N=d(g,p[k],_),N!==null&&(m=i(N,m,k),S===null?C=N:S.sibling=N,S=N);return re&&mr(g,k),C}for(N=n(g,N);k<p.length;k++)O=y(N,g,k,p[k],_),O!==null&&(e&&O.alternate!==null&&N.delete(O.key===null?k:O.key),m=i(O,m,k),S===null?C=O:S.sibling=O,S=O);return e&&N.forEach(function(W){return t(g,W)}),re&&mr(g,k),C}function v(g,m,p,_){var C=Tn(p);if(typeof C!="function")throw Error(R(150));if(p=C.call(p),p==null)throw Error(R(151));for(var S=C=null,N=m,k=m=0,O=null,L=p.next();N!==null&&!L.done;k++,L=p.next()){N.index>k?(O=N,N=null):O=N.sibling;var W=f(g,N,L.value,_);if(W===null){N===null&&(N=O);break}e&&N&&W.alternate===null&&t(g,N),m=i(W,m,k),S===null?C=W:S.sibling=W,S=W,N=O}if(L.done)return r(g,N),re&&mr(g,k),C;if(N===null){for(;!L.done;k++,L=p.next())L=d(g,L.value,_),L!==null&&(m=i(L,m,k),S===null?C=L:S.sibling=L,S=L);return re&&mr(g,k),C}for(N=n(g,N);!L.done;k++,L=p.next())L=y(N,g,k,L.value,_),L!==null&&(e&&L.alternate!==null&&N.delete(L.key===null?k:L.key),m=i(L,m,k),S===null?C=L:S.sibling=L,S=L);return e&&N.forEach(function(le){return t(g,le)}),re&&mr(g,k),C}function j(g,m,p,_){if(typeof p=="object"&&p!==null&&p.type===Yr&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case Ds:e:{for(var C=p.key,S=m;S!==null;){if(S.key===C){if(C=p.type,C===Yr){if(S.tag===7){r(g,S.sibling),m=s(S,p.props.children),m.return=g,g=m;break e}}else if(S.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ft&&fc(C)===S.type){r(g,S.sibling),m=s(S,p.props),m.ref=In(g,S,p),m.return=g,g=m;break e}r(g,S);break}else t(g,S);S=S.sibling}p.type===Yr?(m=Er(p.props.children,g.mode,_,p.key),m.return=g,g=m):(_=pa(p.type,p.key,p.props,null,g.mode,_),_.ref=In(g,m,p),_.return=g,g=_)}return l(g);case Jr:e:{for(S=p.key;m!==null;){if(m.key===S)if(m.tag===4&&m.stateNode.containerInfo===p.containerInfo&&m.stateNode.implementation===p.implementation){r(g,m.sibling),m=s(m,p.children||[]),m.return=g,g=m;break e}else{r(g,m);break}else t(g,m);m=m.sibling}m=qi(p,g.mode,_),m.return=g,g=m}return l(g);case Ft:return S=p._init,j(g,m,S(p._payload),_)}if(Mn(p))return x(g,m,p,_);if(Tn(p))return v(g,m,p,_);Ks(g,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,m!==null&&m.tag===6?(r(g,m.sibling),m=s(m,p),m.return=g,g=m):(r(g,m),m=Bi(p,g.mode,_),m.return=g,g=m),l(g)):r(g,m)}return j}var vn=Uh(!0),Dh=Uh(!1),Ta=ur(null),Ra=null,sn=null,Do=null;function $o(){Do=sn=Ra=null}function Mo(e){var t=Ta.current;te(Ta),e._currentValue=t}function Al(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function fn(e,t){Ra=e,Do=sn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($e=!0),e.firstContext=null)}function st(e){var t=e._currentValue;if(Do!==e)if(e={context:e,memoizedValue:t,next:null},sn===null){if(Ra===null)throw Error(R(308));sn=e,Ra.dependencies={lanes:0,firstContext:e}}else sn=sn.next=e;return t}var wr=null;function zo(e){wr===null?wr=[e]:wr.push(e)}function $h(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,zo(t)):(r.next=s.next,s.next=r),t.interleaved=r,It(e,n)}function It(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Bt=!1;function Fo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function At(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function er(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,J&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,It(e,r)}return s=n.interleaved,s===null?(t.next=t,zo(n)):(t.next=s.next,s.next=t),n.interleaved=t,It(e,r)}function oa(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,So(e,r)}}function pc(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Aa(e,t,r,n){var s=e.updateQueue;Bt=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,c=u.next;u.next=null,l===null?i=c:l.next=c,l=u;var h=e.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==l&&(o===null?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=u))}if(i!==null){var d=s.baseState;l=0,h=c=u=null,o=i;do{var f=o.lane,y=o.eventTime;if((n&f)===f){h!==null&&(h=h.next={eventTime:y,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,v=o;switch(f=t,y=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){d=x.call(y,d,f);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,f=typeof x=="function"?x.call(y,d,f):x,f==null)break e;d=ie({},d,f);break e;case 2:Bt=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else y={eventTime:y,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(c=h=y,u=d):h=h.next=y,l|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(h===null&&(u=d),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=h,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Pr|=l,e.lanes=l,e.memoizedState=d}}function mc(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(R(191,s));s.call(n)}}}var As={},wt=ur(As),ds=ur(As),hs=ur(As);function kr(e){if(e===As)throw Error(R(174));return e}function Bo(e,t){switch(Z(hs,t),Z(ds,e),Z(wt,As),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dl(t,e)}te(wt),Z(wt,t)}function bn(){te(wt),te(ds),te(hs)}function zh(e){kr(hs.current);var t=kr(wt.current),r=dl(t,e.type);t!==r&&(Z(ds,e),Z(wt,r))}function qo(e){ds.current===e&&(te(wt),te(ds))}var se=ur(0);function Pa(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ui=[];function Vo(){for(var e=0;e<Ui.length;e++)Ui[e]._workInProgressVersionPrimary=null;Ui.length=0}var ua=Dt.ReactCurrentDispatcher,Di=Dt.ReactCurrentBatchConfig,Ar=0,ae=null,xe=null,ve=null,Oa=!1,Kn=!1,fs=0,Om=0;function Ce(){throw Error(R(321))}function Wo(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!mt(e[r],t[r]))return!1;return!0}function Ho(e,t,r,n,s,i){if(Ar=i,ae=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ua.current=e===null||e.memoizedState===null?Dm:$m,e=r(n,s),Kn){i=0;do{if(Kn=!1,fs=0,25<=i)throw Error(R(301));i+=1,ve=xe=null,t.updateQueue=null,ua.current=Mm,e=r(n,s)}while(Kn)}if(ua.current=Ia,t=xe!==null&&xe.next!==null,Ar=0,ve=xe=ae=null,Oa=!1,t)throw Error(R(300));return e}function Go(){var e=fs!==0;return fs=0,e}function xt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ve===null?ae.memoizedState=ve=e:ve=ve.next=e,ve}function at(){if(xe===null){var e=ae.alternate;e=e!==null?e.memoizedState:null}else e=xe.next;var t=ve===null?ae.memoizedState:ve.next;if(t!==null)ve=t,xe=e;else{if(e===null)throw Error(R(310));xe=e,e={memoizedState:xe.memoizedState,baseState:xe.baseState,baseQueue:xe.baseQueue,queue:xe.queue,next:null},ve===null?ae.memoizedState=ve=e:ve=ve.next=e}return ve}function ps(e,t){return typeof t=="function"?t(e):t}function $i(e){var t=at(),r=t.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=e;var n=xe,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=l=null,u=null,c=i;do{var h=c.lane;if((Ar&h)===h)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=d,l=n):u=u.next=d,ae.lanes|=h,Pr|=h}c=c.next}while(c!==null&&c!==i);u===null?l=n:u.next=o,mt(n,t.memoizedState)||($e=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=u,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,ae.lanes|=i,Pr|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Mi(e){var t=at(),r=t.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);mt(i,t.memoizedState)||($e=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function Fh(){}function Bh(e,t){var r=ae,n=at(),s=t(),i=!mt(n.memoizedState,s);if(i&&(n.memoizedState=s,$e=!0),n=n.queue,Ko(Wh.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||ve!==null&&ve.memoizedState.tag&1){if(r.flags|=2048,ms(9,Vh.bind(null,r,n,s,t),void 0,null),be===null)throw Error(R(349));Ar&30||qh(r,t,s)}return s}function qh(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ae.updateQueue,t===null?(t={lastEffect:null,stores:null},ae.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Vh(e,t,r,n){t.value=r,t.getSnapshot=n,Hh(t)&&Gh(e)}function Wh(e,t,r){return r(function(){Hh(t)&&Gh(e)})}function Hh(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!mt(e,r)}catch{return!0}}function Gh(e){var t=It(e,1);t!==null&&pt(t,e,1,-1)}function gc(e){var t=xt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:e},t.queue=e,e=e.dispatch=Um.bind(null,ae,e),[t.memoizedState,e]}function ms(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ae.updateQueue,t===null?(t={lastEffect:null,stores:null},ae.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Kh(){return at().memoizedState}function ca(e,t,r,n){var s=xt();ae.flags|=e,s.memoizedState=ms(1|t,r,void 0,n===void 0?null:n)}function ei(e,t,r,n){var s=at();n=n===void 0?null:n;var i=void 0;if(xe!==null){var l=xe.memoizedState;if(i=l.destroy,n!==null&&Wo(n,l.deps)){s.memoizedState=ms(t,r,i,n);return}}ae.flags|=e,s.memoizedState=ms(1|t,r,i,n)}function xc(e,t){return ca(8390656,8,e,t)}function Ko(e,t){return ei(2048,8,e,t)}function Jh(e,t){return ei(4,2,e,t)}function Yh(e,t){return ei(4,4,e,t)}function Qh(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Xh(e,t,r){return r=r!=null?r.concat([e]):null,ei(4,4,Qh.bind(null,t,e),r)}function Jo(){}function Zh(e,t){var r=at();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Wo(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ef(e,t){var r=at();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Wo(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function tf(e,t,r){return Ar&21?(mt(r,t)||(r=ih(),ae.lanes|=r,Pr|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$e=!0),e.memoizedState=r)}function Im(e,t){var r=Q;Q=r!==0&&4>r?r:4,e(!0);var n=Di.transition;Di.transition={};try{e(!1),t()}finally{Q=r,Di.transition=n}}function rf(){return at().memoizedState}function Lm(e,t,r){var n=rr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},nf(e))sf(t,r);else if(r=$h(e,t,r,n),r!==null){var s=Ie();pt(r,e,n,s),af(r,t,n)}}function Um(e,t,r){var n=rr(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(nf(e))sf(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(s.hasEagerState=!0,s.eagerState=o,mt(o,l)){var u=t.interleaved;u===null?(s.next=s,zo(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}r=$h(e,t,s,n),r!==null&&(s=Ie(),pt(r,e,n,s),af(r,t,n))}}function nf(e){var t=e.alternate;return e===ae||t!==null&&t===ae}function sf(e,t){Kn=Oa=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function af(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,So(e,r)}}var Ia={readContext:st,useCallback:Ce,useContext:Ce,useEffect:Ce,useImperativeHandle:Ce,useInsertionEffect:Ce,useLayoutEffect:Ce,useMemo:Ce,useReducer:Ce,useRef:Ce,useState:Ce,useDebugValue:Ce,useDeferredValue:Ce,useTransition:Ce,useMutableSource:Ce,useSyncExternalStore:Ce,useId:Ce,unstable_isNewReconciler:!1},Dm={readContext:st,useCallback:function(e,t){return xt().memoizedState=[e,t===void 0?null:t],e},useContext:st,useEffect:xc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ca(4194308,4,Qh.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ca(4194308,4,e,t)},useInsertionEffect:function(e,t){return ca(4,2,e,t)},useMemo:function(e,t){var r=xt();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=xt();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Lm.bind(null,ae,e),[n.memoizedState,e]},useRef:function(e){var t=xt();return e={current:e},t.memoizedState=e},useState:gc,useDebugValue:Jo,useDeferredValue:function(e){return xt().memoizedState=e},useTransition:function(){var e=gc(!1),t=e[0];return e=Im.bind(null,e[1]),xt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ae,s=xt();if(re){if(r===void 0)throw Error(R(407));r=r()}else{if(r=t(),be===null)throw Error(R(349));Ar&30||qh(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,xc(Wh.bind(null,n,i,e),[e]),n.flags|=2048,ms(9,Vh.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=xt(),t=be.identifierPrefix;if(re){var r=Rt,n=Tt;r=(n&~(1<<32-ft(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=fs++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Om++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$m={readContext:st,useCallback:Zh,useContext:st,useEffect:Ko,useImperativeHandle:Xh,useInsertionEffect:Jh,useLayoutEffect:Yh,useMemo:ef,useReducer:$i,useRef:Kh,useState:function(){return $i(ps)},useDebugValue:Jo,useDeferredValue:function(e){var t=at();return tf(t,xe.memoizedState,e)},useTransition:function(){var e=$i(ps)[0],t=at().memoizedState;return[e,t]},useMutableSource:Fh,useSyncExternalStore:Bh,useId:rf,unstable_isNewReconciler:!1},Mm={readContext:st,useCallback:Zh,useContext:st,useEffect:Ko,useImperativeHandle:Xh,useInsertionEffect:Jh,useLayoutEffect:Yh,useMemo:ef,useReducer:Mi,useRef:Kh,useState:function(){return Mi(ps)},useDebugValue:Jo,useDeferredValue:function(e){var t=at();return xe===null?t.memoizedState=e:tf(t,xe.memoizedState,e)},useTransition:function(){var e=Mi(ps)[0],t=at().memoizedState;return[e,t]},useMutableSource:Fh,useSyncExternalStore:Bh,useId:rf,unstable_isNewReconciler:!1};function ot(e,t){if(e&&e.defaultProps){t=ie({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Pl(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ie({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ti={isMounted:function(e){return(e=e._reactInternals)?Lr(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ie(),s=rr(e),i=At(n,s);i.payload=t,r!=null&&(i.callback=r),t=er(e,i,s),t!==null&&(pt(t,e,s,n),oa(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ie(),s=rr(e),i=At(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=er(e,i,s),t!==null&&(pt(t,e,s,n),oa(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ie(),n=rr(e),s=At(r,n);s.tag=2,t!=null&&(s.callback=t),t=er(e,s,n),t!==null&&(pt(t,e,n,r),oa(t,e,n))}};function yc(e,t,r,n,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!ls(r,n)||!ls(s,i):!0}function lf(e,t,r){var n=!1,s=lr,i=t.contextType;return typeof i=="object"&&i!==null?i=st(i):(s=ze(t)?Tr:Ae.current,n=t.contextTypes,i=(n=n!=null)?xn(e,s):lr),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ti,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function vc(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ti.enqueueReplaceState(t,t.state,null)}function Ol(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Fo(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=st(i):(i=ze(t)?Tr:Ae.current,s.context=xn(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Pl(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ti.enqueueReplaceState(s,s.state,null),Aa(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function wn(e,t){try{var r="",n=t;do r+=fp(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function zi(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Il(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var zm=typeof WeakMap=="function"?WeakMap:Map;function of(e,t,r){r=At(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ua||(Ua=!0,Vl=n),Il(e,t)},r}function uf(e,t,r){r=At(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Il(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Il(e,t),typeof n!="function"&&(tr===null?tr=new Set([this]):tr.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function bc(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new zm;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=eg.bind(null,e,t,r),t.then(e,e))}function wc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function kc(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=At(-1,1),t.tag=2,er(r,t,1))),r.lanes|=1),e)}var Fm=Dt.ReactCurrentOwner,$e=!1;function Oe(e,t,r,n){t.child=e===null?Dh(t,null,r,n):vn(t,e.child,r,n)}function _c(e,t,r,n,s){r=r.render;var i=t.ref;return fn(t,s),n=Ho(e,t,r,n,i,s),r=Go(),e!==null&&!$e?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Lt(e,t,s)):(re&&r&&Io(t),t.flags|=1,Oe(e,t,n,s),t.child)}function jc(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!nu(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,cf(e,t,i,n,s)):(e=pa(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:ls,r(l,n)&&e.ref===t.ref)return Lt(e,t,s)}return t.flags|=1,e=nr(i,n),e.ref=t.ref,e.return=t,t.child=e}function cf(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(ls(i,n)&&e.ref===t.ref)if($e=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&($e=!0);else return t.lanes=e.lanes,Lt(e,t,s)}return Ll(e,t,r,n,s)}function df(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Z(ln,We),We|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Z(ln,We),We|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Z(ln,We),We|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Z(ln,We),We|=n;return Oe(e,t,s,r),t.child}function hf(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ll(e,t,r,n,s){var i=ze(r)?Tr:Ae.current;return i=xn(t,i),fn(t,s),r=Ho(e,t,r,n,i,s),n=Go(),e!==null&&!$e?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Lt(e,t,s)):(re&&n&&Io(t),t.flags|=1,Oe(e,t,r,s),t.child)}function Nc(e,t,r,n,s){if(ze(r)){var i=!0;Sa(t)}else i=!1;if(fn(t,s),t.stateNode===null)da(e,t),lf(t,r,n),Ol(t,r,n,s),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var u=l.context,c=r.contextType;typeof c=="object"&&c!==null?c=st(c):(c=ze(r)?Tr:Ae.current,c=xn(t,c));var h=r.getDerivedStateFromProps,d=typeof h=="function"||typeof l.getSnapshotBeforeUpdate=="function";d||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||u!==c)&&vc(t,l,n,c),Bt=!1;var f=t.memoizedState;l.state=f,Aa(t,n,l,s),u=t.memoizedState,o!==n||f!==u||Me.current||Bt?(typeof h=="function"&&(Pl(t,r,h,n),u=t.memoizedState),(o=Bt||yc(t,r,o,n,f,u,c))?(d||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),l.props=n,l.state=u,l.context=c,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Mh(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ot(t.type,o),l.props=c,d=t.pendingProps,f=l.context,u=r.contextType,typeof u=="object"&&u!==null?u=st(u):(u=ze(r)?Tr:Ae.current,u=xn(t,u));var y=r.getDerivedStateFromProps;(h=typeof y=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==d||f!==u)&&vc(t,l,n,u),Bt=!1,f=t.memoizedState,l.state=f,Aa(t,n,l,s);var x=t.memoizedState;o!==d||f!==x||Me.current||Bt?(typeof y=="function"&&(Pl(t,r,y,n),x=t.memoizedState),(c=Bt||yc(t,r,c,n,f,x,u)||!1)?(h||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,x,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,x,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),l.props=n,l.state=x,l.context=u,n=c):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Ul(e,t,r,n,i,s)}function Ul(e,t,r,n,s,i){hf(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return s&&cc(t,r,!1),Lt(e,t,i);n=t.stateNode,Fm.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=vn(t,e.child,null,i),t.child=vn(t,null,o,i)):Oe(e,t,o,i),t.memoizedState=n.state,s&&cc(t,r,!0),t.child}function ff(e){var t=e.stateNode;t.pendingContext?uc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&uc(e,t.context,!1),Bo(e,t.containerInfo)}function Sc(e,t,r,n,s){return yn(),Uo(s),t.flags|=256,Oe(e,t,r,n),t.child}var Dl={dehydrated:null,treeContext:null,retryLane:0};function $l(e){return{baseLanes:e,cachePool:null,transitions:null}}function pf(e,t,r){var n=t.pendingProps,s=se.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Z(se,s&1),e===null)return Rl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=si(l,n,0,null),e=Er(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=$l(r),t.memoizedState=Dl,e):Yo(t,l));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return Bm(e,t,l,n,o,s,r);if(i){i=n.fallback,l=t.mode,s=e.child,o=s.sibling;var u={mode:"hidden",children:n.children};return!(l&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=u,t.deletions=null):(n=nr(s,u),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=nr(o,i):(i=Er(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?$l(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=Dl,n}return i=e.child,e=i.sibling,n=nr(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Yo(e,t){return t=si({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Js(e,t,r,n){return n!==null&&Uo(n),vn(t,e.child,null,r),e=Yo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Bm(e,t,r,n,s,i,l){if(r)return t.flags&256?(t.flags&=-257,n=zi(Error(R(422))),Js(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=si({mode:"visible",children:n.children},s,0,null),i=Er(i,s,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&vn(t,e.child,null,l),t.child.memoizedState=$l(l),t.memoizedState=Dl,i);if(!(t.mode&1))return Js(e,t,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(R(419)),n=zi(i,n,void 0),Js(e,t,l,n)}if(o=(l&e.childLanes)!==0,$e||o){if(n=be,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,It(e,s),pt(n,e,s,-1))}return ru(),n=zi(Error(R(421))),Js(e,t,l,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=tg.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Je=Zt(s.nextSibling),Ye=t,re=!0,ht=null,e!==null&&(et[tt++]=Tt,et[tt++]=Rt,et[tt++]=Rr,Tt=e.id,Rt=e.overflow,Rr=t),t=Yo(t,n.children),t.flags|=4096,t)}function Ec(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Al(e.return,t,r)}function Fi(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function mf(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Oe(e,t,n.children,r),n=se.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ec(e,r,t);else if(e.tag===19)Ec(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Z(se,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Pa(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Fi(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Pa(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Fi(t,!0,r,null,i);break;case"together":Fi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function da(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Lt(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Pr|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(R(153));if(t.child!==null){for(e=t.child,r=nr(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=nr(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function qm(e,t,r){switch(t.tag){case 3:ff(t),yn();break;case 5:zh(t);break;case 1:ze(t.type)&&Sa(t);break;case 4:Bo(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Z(Ta,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Z(se,se.current&1),t.flags|=128,null):r&t.child.childLanes?pf(e,t,r):(Z(se,se.current&1),e=Lt(e,t,r),e!==null?e.sibling:null);Z(se,se.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return mf(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Z(se,se.current),n)break;return null;case 22:case 23:return t.lanes=0,df(e,t,r)}return Lt(e,t,r)}var gf,Ml,xf,yf;gf=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ml=function(){};xf=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,kr(wt.current);var i=null;switch(r){case"input":s=ll(e,s),n=ll(e,n),i=[];break;case"select":s=ie({},s,{value:void 0}),n=ie({},n,{value:void 0}),i=[];break;case"textarea":s=cl(e,s),n=cl(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=ja)}hl(r,n);var l;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(es.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var u=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(r||(r={}),r[l]=u[l])}else r||(i||(i=[]),i.push(c,r)),r=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(es.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&ee("scroll",e),i||o===u||(i=[])):(i=i||[]).push(c,u))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};yf=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ln(e,t){if(!re)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Te(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Vm(e,t,r){var n=t.pendingProps;switch(Lo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Te(t),null;case 1:return ze(t.type)&&Na(),Te(t),null;case 3:return n=t.stateNode,bn(),te(Me),te(Ae),Vo(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Gs(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ht!==null&&(Gl(ht),ht=null))),Ml(e,t),Te(t),null;case 5:qo(t);var s=kr(hs.current);if(r=t.type,e!==null&&t.stateNode!=null)xf(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(R(166));return Te(t),null}if(e=kr(wt.current),Gs(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[vt]=t,n[cs]=i,e=(t.mode&1)!==0,r){case"dialog":ee("cancel",n),ee("close",n);break;case"iframe":case"object":case"embed":ee("load",n);break;case"video":case"audio":for(s=0;s<Fn.length;s++)ee(Fn[s],n);break;case"source":ee("error",n);break;case"img":case"image":case"link":ee("error",n),ee("load",n);break;case"details":ee("toggle",n);break;case"input":Uu(n,i),ee("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ee("invalid",n);break;case"textarea":$u(n,i),ee("invalid",n)}hl(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Hs(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Hs(n.textContent,o,e),s=["children",""+o]):es.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&ee("scroll",n)}switch(r){case"input":$s(n),Du(n,i,!0);break;case"textarea":$s(n),Mu(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=ja)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Wd(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[vt]=t,e[cs]=n,gf(e,t,!1,!1),t.stateNode=e;e:{switch(l=fl(r,n),r){case"dialog":ee("cancel",e),ee("close",e),s=n;break;case"iframe":case"object":case"embed":ee("load",e),s=n;break;case"video":case"audio":for(s=0;s<Fn.length;s++)ee(Fn[s],e);s=n;break;case"source":ee("error",e),s=n;break;case"img":case"image":case"link":ee("error",e),ee("load",e),s=n;break;case"details":ee("toggle",e),s=n;break;case"input":Uu(e,n),s=ll(e,n),ee("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=ie({},n,{value:void 0}),ee("invalid",e);break;case"textarea":$u(e,n),s=cl(e,n),ee("invalid",e);break;default:s=n}hl(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?Kd(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Hd(e,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&ts(e,u):typeof u=="number"&&ts(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(es.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ee("scroll",e):u!=null&&bo(e,i,u,l))}switch(r){case"input":$s(e),Du(e,n,!1);break;case"textarea":$s(e),Mu(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ir(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?un(e,!!n.multiple,i,!1):n.defaultValue!=null&&un(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ja)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Te(t),null;case 6:if(e&&t.stateNode!=null)yf(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(R(166));if(r=kr(hs.current),kr(wt.current),Gs(t)){if(n=t.stateNode,r=t.memoizedProps,n[vt]=t,(i=n.nodeValue!==r)&&(e=Ye,e!==null))switch(e.tag){case 3:Hs(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Hs(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[vt]=t,t.stateNode=n}return Te(t),null;case 13:if(te(se),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(re&&Je!==null&&t.mode&1&&!(t.flags&128))Lh(),yn(),t.flags|=98560,i=!1;else if(i=Gs(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(R(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));i[vt]=t}else yn(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Te(t),i=!1}else ht!==null&&(Gl(ht),ht=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||se.current&1?ye===0&&(ye=3):ru())),t.updateQueue!==null&&(t.flags|=4),Te(t),null);case 4:return bn(),Ml(e,t),e===null&&os(t.stateNode.containerInfo),Te(t),null;case 10:return Mo(t.type._context),Te(t),null;case 17:return ze(t.type)&&Na(),Te(t),null;case 19:if(te(se),i=t.memoizedState,i===null)return Te(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)Ln(i,!1);else{if(ye!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Pa(e),l!==null){for(t.flags|=128,Ln(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Z(se,se.current&1|2),t.child}e=e.sibling}i.tail!==null&&de()>kn&&(t.flags|=128,n=!0,Ln(i,!1),t.lanes=4194304)}else{if(!n)if(e=Pa(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ln(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!re)return Te(t),null}else 2*de()-i.renderingStartTime>kn&&r!==1073741824&&(t.flags|=128,n=!0,Ln(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=de(),t.sibling=null,r=se.current,Z(se,n?r&1|2:r&1),t):(Te(t),null);case 22:case 23:return tu(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?We&1073741824&&(Te(t),t.subtreeFlags&6&&(t.flags|=8192)):Te(t),null;case 24:return null;case 25:return null}throw Error(R(156,t.tag))}function Wm(e,t){switch(Lo(t),t.tag){case 1:return ze(t.type)&&Na(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bn(),te(Me),te(Ae),Vo(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return qo(t),null;case 13:if(te(se),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(R(340));yn()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return te(se),null;case 4:return bn(),null;case 10:return Mo(t.type._context),null;case 22:case 23:return tu(),null;case 24:return null;default:return null}}var Ys=!1,Re=!1,Hm=typeof WeakSet=="function"?WeakSet:Set,I=null;function an(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ue(e,t,n)}else r.current=null}function zl(e,t,r){try{r()}catch(n){ue(e,t,n)}}var Cc=!1;function Gm(e,t){if(_l=wa,e=kh(),Oo(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,u=-1,c=0,h=0,d=e,f=null;t:for(;;){for(var y;d!==r||s!==0&&d.nodeType!==3||(o=l+s),d!==i||n!==0&&d.nodeType!==3||(u=l+n),d.nodeType===3&&(l+=d.nodeValue.length),(y=d.firstChild)!==null;)f=d,d=y;for(;;){if(d===e)break t;if(f===r&&++c===s&&(o=l),f===i&&++h===n&&(u=l),(y=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=y}r=o===-1||u===-1?null:{start:o,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(jl={focusedElem:e,selectionRange:r},wa=!1,I=t;I!==null;)if(t=I,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,I=e;else for(;I!==null;){t=I;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,j=x.memoizedState,g=t.stateNode,m=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:ot(t.type,v),j);g.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(_){ue(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,I=e;break}I=t.return}return x=Cc,Cc=!1,x}function Jn(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&zl(t,r,i)}s=s.next}while(s!==n)}}function ri(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Fl(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function vf(e){var t=e.alternate;t!==null&&(e.alternate=null,vf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[vt],delete t[cs],delete t[El],delete t[Tm],delete t[Rm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function bf(e){return e.tag===5||e.tag===3||e.tag===4}function Tc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||bf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Bl(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=ja));else if(n!==4&&(e=e.child,e!==null))for(Bl(e,t,r),e=e.sibling;e!==null;)Bl(e,t,r),e=e.sibling}function ql(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(ql(e,t,r),e=e.sibling;e!==null;)ql(e,t,r),e=e.sibling}var je=null,ct=!1;function zt(e,t,r){for(r=r.child;r!==null;)wf(e,t,r),r=r.sibling}function wf(e,t,r){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(Ka,r)}catch{}switch(r.tag){case 5:Re||an(r,t);case 6:var n=je,s=ct;je=null,zt(e,t,r),je=n,ct=s,je!==null&&(ct?(e=je,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):je.removeChild(r.stateNode));break;case 18:je!==null&&(ct?(e=je,r=r.stateNode,e.nodeType===8?Ii(e.parentNode,r):e.nodeType===1&&Ii(e,r),as(e)):Ii(je,r.stateNode));break;case 4:n=je,s=ct,je=r.stateNode.containerInfo,ct=!0,zt(e,t,r),je=n,ct=s;break;case 0:case 11:case 14:case 15:if(!Re&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&zl(r,t,l),s=s.next}while(s!==n)}zt(e,t,r);break;case 1:if(!Re&&(an(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){ue(r,t,o)}zt(e,t,r);break;case 21:zt(e,t,r);break;case 22:r.mode&1?(Re=(n=Re)||r.memoizedState!==null,zt(e,t,r),Re=n):zt(e,t,r);break;default:zt(e,t,r)}}function Rc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Hm),t.forEach(function(n){var s=rg.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function it(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:je=o.stateNode,ct=!1;break e;case 3:je=o.stateNode.containerInfo,ct=!0;break e;case 4:je=o.stateNode.containerInfo,ct=!0;break e}o=o.return}if(je===null)throw Error(R(160));wf(i,l,s),je=null,ct=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){ue(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kf(t,e),t=t.sibling}function kf(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(it(t,e),gt(e),n&4){try{Jn(3,e,e.return),ri(3,e)}catch(v){ue(e,e.return,v)}try{Jn(5,e,e.return)}catch(v){ue(e,e.return,v)}}break;case 1:it(t,e),gt(e),n&512&&r!==null&&an(r,r.return);break;case 5:if(it(t,e),gt(e),n&512&&r!==null&&an(r,r.return),e.flags&32){var s=e.stateNode;try{ts(s,"")}catch(v){ue(e,e.return,v)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&qd(s,i),fl(o,l);var c=fl(o,i);for(l=0;l<u.length;l+=2){var h=u[l],d=u[l+1];h==="style"?Kd(s,d):h==="dangerouslySetInnerHTML"?Hd(s,d):h==="children"?ts(s,d):bo(s,h,d,c)}switch(o){case"input":ol(s,i);break;case"textarea":Vd(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?un(s,!!i.multiple,y,!1):f!==!!i.multiple&&(i.defaultValue!=null?un(s,!!i.multiple,i.defaultValue,!0):un(s,!!i.multiple,i.multiple?[]:"",!1))}s[cs]=i}catch(v){ue(e,e.return,v)}}break;case 6:if(it(t,e),gt(e),n&4){if(e.stateNode===null)throw Error(R(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(v){ue(e,e.return,v)}}break;case 3:if(it(t,e),gt(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{as(t.containerInfo)}catch(v){ue(e,e.return,v)}break;case 4:it(t,e),gt(e);break;case 13:it(t,e),gt(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zo=de())),n&4&&Rc(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(Re=(c=Re)||h,it(t,e),Re=c):it(t,e),gt(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!h&&e.mode&1)for(I=e,h=e.child;h!==null;){for(d=I=h;I!==null;){switch(f=I,y=f.child,f.tag){case 0:case 11:case 14:case 15:Jn(4,f,f.return);break;case 1:an(f,f.return);var x=f.stateNode;if(typeof x.componentWillUnmount=="function"){n=f,r=f.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(v){ue(n,r,v)}}break;case 5:an(f,f.return);break;case 22:if(f.memoizedState!==null){Pc(d);continue}}y!==null?(y.return=f,I=y):Pc(d)}h=h.sibling}e:for(h=null,d=e;;){if(d.tag===5){if(h===null){h=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,u=d.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=Gd("display",l))}catch(v){ue(e,e.return,v)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(v){ue(e,e.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:it(t,e),gt(e),n&4&&Rc(e);break;case 21:break;default:it(t,e),gt(e)}}function gt(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(bf(r)){var n=r;break e}r=r.return}throw Error(R(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ts(s,""),n.flags&=-33);var i=Tc(e);ql(e,i,s);break;case 3:case 4:var l=n.stateNode.containerInfo,o=Tc(e);Bl(e,o,l);break;default:throw Error(R(161))}}catch(u){ue(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Km(e,t,r){I=e,_f(e)}function _f(e,t,r){for(var n=(e.mode&1)!==0;I!==null;){var s=I,i=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||Ys;if(!l){var o=s.alternate,u=o!==null&&o.memoizedState!==null||Re;o=Ys;var c=Re;if(Ys=l,(Re=u)&&!c)for(I=s;I!==null;)l=I,u=l.child,l.tag===22&&l.memoizedState!==null?Oc(s):u!==null?(u.return=l,I=u):Oc(s);for(;i!==null;)I=i,_f(i),i=i.sibling;I=s,Ys=o,Re=c}Ac(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,I=i):Ac(e)}}function Ac(e){for(;I!==null;){var t=I;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Re||ri(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Re)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ot(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&mc(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}mc(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&as(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Re||t.flags&512&&Fl(t)}catch(f){ue(t,t.return,f)}}if(t===e){I=null;break}if(r=t.sibling,r!==null){r.return=t.return,I=r;break}I=t.return}}function Pc(e){for(;I!==null;){var t=I;if(t===e){I=null;break}var r=t.sibling;if(r!==null){r.return=t.return,I=r;break}I=t.return}}function Oc(e){for(;I!==null;){var t=I;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ri(4,t)}catch(u){ue(t,r,u)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(u){ue(t,s,u)}}var i=t.return;try{Fl(t)}catch(u){ue(t,i,u)}break;case 5:var l=t.return;try{Fl(t)}catch(u){ue(t,l,u)}}}catch(u){ue(t,t.return,u)}if(t===e){I=null;break}var o=t.sibling;if(o!==null){o.return=t.return,I=o;break}I=t.return}}var Jm=Math.ceil,La=Dt.ReactCurrentDispatcher,Qo=Dt.ReactCurrentOwner,nt=Dt.ReactCurrentBatchConfig,J=0,be=null,pe=null,Ne=0,We=0,ln=ur(0),ye=0,gs=null,Pr=0,ni=0,Xo=0,Yn=null,De=null,Zo=0,kn=1/0,St=null,Ua=!1,Vl=null,tr=null,Qs=!1,Kt=null,Da=0,Qn=0,Wl=null,ha=-1,fa=0;function Ie(){return J&6?de():ha!==-1?ha:ha=de()}function rr(e){return e.mode&1?J&2&&Ne!==0?Ne&-Ne:Pm.transition!==null?(fa===0&&(fa=ih()),fa):(e=Q,e!==0||(e=window.event,e=e===void 0?16:fh(e.type)),e):1}function pt(e,t,r,n){if(50<Qn)throw Qn=0,Wl=null,Error(R(185));Cs(e,r,n),(!(J&2)||e!==be)&&(e===be&&(!(J&2)&&(ni|=r),ye===4&&Wt(e,Ne)),Fe(e,n),r===1&&J===0&&!(t.mode&1)&&(kn=de()+500,Za&&cr()))}function Fe(e,t){var r=e.callbackNode;Pp(e,t);var n=ba(e,e===be?Ne:0);if(n===0)r!==null&&Bu(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Bu(r),t===1)e.tag===0?Am(Ic.bind(null,e)):Ph(Ic.bind(null,e)),Em(function(){!(J&6)&&cr()}),r=null;else{switch(lh(n)){case 1:r=No;break;case 4:r=sh;break;case 16:r=va;break;case 536870912:r=ah;break;default:r=va}r=Af(r,jf.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function jf(e,t){if(ha=-1,fa=0,J&6)throw Error(R(327));var r=e.callbackNode;if(pn()&&e.callbackNode!==r)return null;var n=ba(e,e===be?Ne:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=$a(e,n);else{t=n;var s=J;J|=2;var i=Sf();(be!==e||Ne!==t)&&(St=null,kn=de()+500,Sr(e,t));do try{Xm();break}catch(o){Nf(e,o)}while(!0);$o(),La.current=i,J=s,pe!==null?t=0:(be=null,Ne=0,t=ye)}if(t!==0){if(t===2&&(s=yl(e),s!==0&&(n=s,t=Hl(e,s))),t===1)throw r=gs,Sr(e,0),Wt(e,n),Fe(e,de()),r;if(t===6)Wt(e,n);else{if(s=e.current.alternate,!(n&30)&&!Ym(s)&&(t=$a(e,n),t===2&&(i=yl(e),i!==0&&(n=i,t=Hl(e,i))),t===1))throw r=gs,Sr(e,0),Wt(e,n),Fe(e,de()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(R(345));case 2:gr(e,De,St);break;case 3:if(Wt(e,n),(n&130023424)===n&&(t=Zo+500-de(),10<t)){if(ba(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Ie(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Sl(gr.bind(null,e,De,St),t);break}gr(e,De,St);break;case 4:if(Wt(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-ft(n);i=1<<l,l=t[l],l>s&&(s=l),n&=~i}if(n=s,n=de()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Jm(n/1960))-n,10<n){e.timeoutHandle=Sl(gr.bind(null,e,De,St),n);break}gr(e,De,St);break;case 5:gr(e,De,St);break;default:throw Error(R(329))}}}return Fe(e,de()),e.callbackNode===r?jf.bind(null,e):null}function Hl(e,t){var r=Yn;return e.current.memoizedState.isDehydrated&&(Sr(e,t).flags|=256),e=$a(e,t),e!==2&&(t=De,De=r,t!==null&&Gl(t)),e}function Gl(e){De===null?De=e:De.push.apply(De,e)}function Ym(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!mt(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wt(e,t){for(t&=~Xo,t&=~ni,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ft(t),n=1<<r;e[r]=-1,t&=~n}}function Ic(e){if(J&6)throw Error(R(327));pn();var t=ba(e,0);if(!(t&1))return Fe(e,de()),null;var r=$a(e,t);if(e.tag!==0&&r===2){var n=yl(e);n!==0&&(t=n,r=Hl(e,n))}if(r===1)throw r=gs,Sr(e,0),Wt(e,t),Fe(e,de()),r;if(r===6)throw Error(R(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,gr(e,De,St),Fe(e,de()),null}function eu(e,t){var r=J;J|=1;try{return e(t)}finally{J=r,J===0&&(kn=de()+500,Za&&cr())}}function Or(e){Kt!==null&&Kt.tag===0&&!(J&6)&&pn();var t=J;J|=1;var r=nt.transition,n=Q;try{if(nt.transition=null,Q=1,e)return e()}finally{Q=n,nt.transition=r,J=t,!(J&6)&&cr()}}function tu(){We=ln.current,te(ln)}function Sr(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Sm(r)),pe!==null)for(r=pe.return;r!==null;){var n=r;switch(Lo(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Na();break;case 3:bn(),te(Me),te(Ae),Vo();break;case 5:qo(n);break;case 4:bn();break;case 13:te(se);break;case 19:te(se);break;case 10:Mo(n.type._context);break;case 22:case 23:tu()}r=r.return}if(be=e,pe=e=nr(e.current,null),Ne=We=t,ye=0,gs=null,Xo=ni=Pr=0,De=Yn=null,wr!==null){for(t=0;t<wr.length;t++)if(r=wr[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,n.next=l}r.pending=n}wr=null}return e}function Nf(e,t){do{var r=pe;try{if($o(),ua.current=Ia,Oa){for(var n=ae.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Oa=!1}if(Ar=0,ve=xe=ae=null,Kn=!1,fs=0,Qo.current=null,r===null||r.return===null){ye=1,gs=t,pe=null;break}e:{var i=e,l=r.return,o=r,u=t;if(t=Ne,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=wc(l);if(y!==null){y.flags&=-257,kc(y,l,o,i,t),y.mode&1&&bc(i,c,t),t=y,u=c;var x=t.updateQueue;if(x===null){var v=new Set;v.add(u),t.updateQueue=v}else x.add(u);break e}else{if(!(t&1)){bc(i,c,t),ru();break e}u=Error(R(426))}}else if(re&&o.mode&1){var j=wc(l);if(j!==null){!(j.flags&65536)&&(j.flags|=256),kc(j,l,o,i,t),Uo(wn(u,o));break e}}i=u=wn(u,o),ye!==4&&(ye=2),Yn===null?Yn=[i]:Yn.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=of(i,u,t);pc(i,g);break e;case 1:o=u;var m=i.type,p=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(tr===null||!tr.has(p)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=uf(i,o,t);pc(i,_);break e}}i=i.return}while(i!==null)}Cf(r)}catch(C){t=C,pe===r&&r!==null&&(pe=r=r.return);continue}break}while(!0)}function Sf(){var e=La.current;return La.current=Ia,e===null?Ia:e}function ru(){(ye===0||ye===3||ye===2)&&(ye=4),be===null||!(Pr&268435455)&&!(ni&268435455)||Wt(be,Ne)}function $a(e,t){var r=J;J|=2;var n=Sf();(be!==e||Ne!==t)&&(St=null,Sr(e,t));do try{Qm();break}catch(s){Nf(e,s)}while(!0);if($o(),J=r,La.current=n,pe!==null)throw Error(R(261));return be=null,Ne=0,ye}function Qm(){for(;pe!==null;)Ef(pe)}function Xm(){for(;pe!==null&&!_p();)Ef(pe)}function Ef(e){var t=Rf(e.alternate,e,We);e.memoizedProps=e.pendingProps,t===null?Cf(e):pe=t,Qo.current=null}function Cf(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Wm(r,t),r!==null){r.flags&=32767,pe=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ye=6,pe=null;return}}else if(r=Vm(r,t,We),r!==null){pe=r;return}if(t=t.sibling,t!==null){pe=t;return}pe=t=e}while(t!==null);ye===0&&(ye=5)}function gr(e,t,r){var n=Q,s=nt.transition;try{nt.transition=null,Q=1,Zm(e,t,r,n)}finally{nt.transition=s,Q=n}return null}function Zm(e,t,r,n){do pn();while(Kt!==null);if(J&6)throw Error(R(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(R(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Op(e,i),e===be&&(pe=be=null,Ne=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Qs||(Qs=!0,Af(va,function(){return pn(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=nt.transition,nt.transition=null;var l=Q;Q=1;var o=J;J|=4,Qo.current=null,Gm(e,r),kf(r,e),vm(jl),wa=!!_l,jl=_l=null,e.current=r,Km(r),jp(),J=o,Q=l,nt.transition=i}else e.current=r;if(Qs&&(Qs=!1,Kt=e,Da=s),i=e.pendingLanes,i===0&&(tr=null),Ep(r.stateNode),Fe(e,de()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ua)throw Ua=!1,e=Vl,Vl=null,e;return Da&1&&e.tag!==0&&pn(),i=e.pendingLanes,i&1?e===Wl?Qn++:(Qn=0,Wl=e):Qn=0,cr(),null}function pn(){if(Kt!==null){var e=lh(Da),t=nt.transition,r=Q;try{if(nt.transition=null,Q=16>e?16:e,Kt===null)var n=!1;else{if(e=Kt,Kt=null,Da=0,J&6)throw Error(R(331));var s=J;for(J|=4,I=e.current;I!==null;){var i=I,l=i.child;if(I.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(I=c;I!==null;){var h=I;switch(h.tag){case 0:case 11:case 15:Jn(8,h,i)}var d=h.child;if(d!==null)d.return=h,I=d;else for(;I!==null;){h=I;var f=h.sibling,y=h.return;if(vf(h),h===c){I=null;break}if(f!==null){f.return=y,I=f;break}I=y}}}var x=i.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var j=v.sibling;v.sibling=null,v=j}while(v!==null)}}I=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,I=l;else e:for(;I!==null;){if(i=I,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Jn(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,I=g;break e}I=i.return}}var m=e.current;for(I=m;I!==null;){l=I;var p=l.child;if(l.subtreeFlags&2064&&p!==null)p.return=l,I=p;else e:for(l=m;I!==null;){if(o=I,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ri(9,o)}}catch(C){ue(o,o.return,C)}if(o===l){I=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,I=_;break e}I=o.return}}if(J=s,cr(),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(Ka,e)}catch{}n=!0}return n}finally{Q=r,nt.transition=t}}return!1}function Lc(e,t,r){t=wn(r,t),t=of(e,t,1),e=er(e,t,1),t=Ie(),e!==null&&(Cs(e,1,t),Fe(e,t))}function ue(e,t,r){if(e.tag===3)Lc(e,e,r);else for(;t!==null;){if(t.tag===3){Lc(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(tr===null||!tr.has(n))){e=wn(r,e),e=uf(t,e,1),t=er(t,e,1),e=Ie(),t!==null&&(Cs(t,1,e),Fe(t,e));break}}t=t.return}}function eg(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ie(),e.pingedLanes|=e.suspendedLanes&r,be===e&&(Ne&r)===r&&(ye===4||ye===3&&(Ne&130023424)===Ne&&500>de()-Zo?Sr(e,0):Xo|=r),Fe(e,t)}function Tf(e,t){t===0&&(e.mode&1?(t=Fs,Fs<<=1,!(Fs&130023424)&&(Fs=4194304)):t=1);var r=Ie();e=It(e,t),e!==null&&(Cs(e,t,r),Fe(e,r))}function tg(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Tf(e,r)}function rg(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(R(314))}n!==null&&n.delete(t),Tf(e,r)}var Rf;Rf=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Me.current)$e=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return $e=!1,qm(e,t,r);$e=!!(e.flags&131072)}else $e=!1,re&&t.flags&1048576&&Oh(t,Ca,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;da(e,t),e=t.pendingProps;var s=xn(t,Ae.current);fn(t,r),s=Ho(null,t,n,e,s,r);var i=Go();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ze(n)?(i=!0,Sa(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Fo(t),s.updater=ti,t.stateNode=s,s._reactInternals=t,Ol(t,n,e,r),t=Ul(null,t,n,!0,i,r)):(t.tag=0,re&&i&&Io(t),Oe(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(da(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=sg(n),e=ot(n,e),s){case 0:t=Ll(null,t,n,e,r);break e;case 1:t=Nc(null,t,n,e,r);break e;case 11:t=_c(null,t,n,e,r);break e;case 14:t=jc(null,t,n,ot(n.type,e),r);break e}throw Error(R(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ot(n,s),Ll(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ot(n,s),Nc(e,t,n,s,r);case 3:e:{if(ff(t),e===null)throw Error(R(387));n=t.pendingProps,i=t.memoizedState,s=i.element,Mh(e,t),Aa(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=wn(Error(R(423)),t),t=Sc(e,t,n,r,s);break e}else if(n!==s){s=wn(Error(R(424)),t),t=Sc(e,t,n,r,s);break e}else for(Je=Zt(t.stateNode.containerInfo.firstChild),Ye=t,re=!0,ht=null,r=Dh(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(yn(),n===s){t=Lt(e,t,r);break e}Oe(e,t,n,r)}t=t.child}return t;case 5:return zh(t),e===null&&Rl(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,Nl(n,s)?l=null:i!==null&&Nl(n,i)&&(t.flags|=32),hf(e,t),Oe(e,t,l,r),t.child;case 6:return e===null&&Rl(t),null;case 13:return pf(e,t,r);case 4:return Bo(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=vn(t,null,n,r):Oe(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ot(n,s),_c(e,t,n,s,r);case 7:return Oe(e,t,t.pendingProps,r),t.child;case 8:return Oe(e,t,t.pendingProps.children,r),t.child;case 12:return Oe(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,Z(Ta,n._currentValue),n._currentValue=l,i!==null)if(mt(i.value,l)){if(i.children===s.children&&!Me.current){t=Lt(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var u=o.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=At(-1,r&-r),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),Al(i.return,r,t),o.lanes|=r;break}u=u.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(R(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Al(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Oe(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,fn(t,r),s=st(s),n=n(s),t.flags|=1,Oe(e,t,n,r),t.child;case 14:return n=t.type,s=ot(n,t.pendingProps),s=ot(n.type,s),jc(e,t,n,s,r);case 15:return cf(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ot(n,s),da(e,t),t.tag=1,ze(n)?(e=!0,Sa(t)):e=!1,fn(t,r),lf(t,n,s),Ol(t,n,s,r),Ul(null,t,n,!0,e,r);case 19:return mf(e,t,r);case 22:return df(e,t,r)}throw Error(R(156,t.tag))};function Af(e,t){return nh(e,t)}function ng(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rt(e,t,r,n){return new ng(e,t,r,n)}function nu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sg(e){if(typeof e=="function")return nu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ko)return 11;if(e===_o)return 14}return 2}function nr(e,t){var r=e.alternate;return r===null?(r=rt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function pa(e,t,r,n,s,i){var l=2;if(n=e,typeof e=="function")nu(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Yr:return Er(r.children,s,i,t);case wo:l=8,s|=8;break;case nl:return e=rt(12,r,t,s|2),e.elementType=nl,e.lanes=i,e;case sl:return e=rt(13,r,t,s),e.elementType=sl,e.lanes=i,e;case al:return e=rt(19,r,t,s),e.elementType=al,e.lanes=i,e;case zd:return si(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $d:l=10;break e;case Md:l=9;break e;case ko:l=11;break e;case _o:l=14;break e;case Ft:l=16,n=null;break e}throw Error(R(130,e==null?e:typeof e,""))}return t=rt(l,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Er(e,t,r,n){return e=rt(7,e,n,t),e.lanes=r,e}function si(e,t,r,n){return e=rt(22,e,n,t),e.elementType=zd,e.lanes=r,e.stateNode={isHidden:!1},e}function Bi(e,t,r){return e=rt(6,e,null,t),e.lanes=r,e}function qi(e,t,r){return t=rt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ag(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_i(0),this.expirationTimes=_i(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_i(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function su(e,t,r,n,s,i,l,o,u){return e=new ag(e,t,r,o,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=rt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(i),e}function ig(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Jr,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Pf(e){if(!e)return lr;e=e._reactInternals;e:{if(Lr(e)!==e||e.tag!==1)throw Error(R(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ze(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(R(171))}if(e.tag===1){var r=e.type;if(ze(r))return Ah(e,r,t)}return t}function Of(e,t,r,n,s,i,l,o,u){return e=su(r,n,!0,e,s,i,l,o,u),e.context=Pf(null),r=e.current,n=Ie(),s=rr(r),i=At(n,s),i.callback=t??null,er(r,i,s),e.current.lanes=s,Cs(e,s,n),Fe(e,n),e}function ai(e,t,r,n){var s=t.current,i=Ie(),l=rr(s);return r=Pf(r),t.context===null?t.context=r:t.pendingContext=r,t=At(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=er(s,t,l),e!==null&&(pt(e,s,l,i),oa(e,s,l)),l}function Ma(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Uc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function au(e,t){Uc(e,t),(e=e.alternate)&&Uc(e,t)}function lg(){return null}var If=typeof reportError=="function"?reportError:function(e){console.error(e)};function iu(e){this._internalRoot=e}ii.prototype.render=iu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(R(409));ai(e,t,null,null)};ii.prototype.unmount=iu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Or(function(){ai(null,e,null,null)}),t[Ot]=null}};function ii(e){this._internalRoot=e}ii.prototype.unstable_scheduleHydration=function(e){if(e){var t=ch();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vt.length&&t!==0&&t<Vt[r].priority;r++);Vt.splice(r,0,e),r===0&&hh(e)}};function lu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function li(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dc(){}function og(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=Ma(l);i.call(c)}}var l=Of(t,n,e,0,null,!1,!1,"",Dc);return e._reactRootContainer=l,e[Ot]=l.current,os(e.nodeType===8?e.parentNode:e),Or(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Ma(u);o.call(c)}}var u=su(e,0,!1,null,null,!1,!1,"",Dc);return e._reactRootContainer=u,e[Ot]=u.current,os(e.nodeType===8?e.parentNode:e),Or(function(){ai(t,u,r,n)}),u}function oi(e,t,r,n,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var o=s;s=function(){var u=Ma(l);o.call(u)}}ai(t,l,e,s)}else l=og(r,t,e,s,n);return Ma(l)}oh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=zn(t.pendingLanes);r!==0&&(So(t,r|1),Fe(t,de()),!(J&6)&&(kn=de()+500,cr()))}break;case 13:Or(function(){var n=It(e,1);if(n!==null){var s=Ie();pt(n,e,1,s)}}),au(e,1)}};Eo=function(e){if(e.tag===13){var t=It(e,134217728);if(t!==null){var r=Ie();pt(t,e,134217728,r)}au(e,134217728)}};uh=function(e){if(e.tag===13){var t=rr(e),r=It(e,t);if(r!==null){var n=Ie();pt(r,e,t,n)}au(e,t)}};ch=function(){return Q};dh=function(e,t){var r=Q;try{return Q=e,t()}finally{Q=r}};ml=function(e,t,r){switch(t){case"input":if(ol(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Xa(n);if(!s)throw Error(R(90));Bd(n),ol(n,s)}}}break;case"textarea":Vd(e,r);break;case"select":t=r.value,t!=null&&un(e,!!r.multiple,t,!1)}};Qd=eu;Xd=Or;var ug={usingClientEntryPoint:!1,Events:[Rs,en,Xa,Jd,Yd,eu]},Un={findFiberByHostInstance:br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cg={bundleType:Un.bundleType,version:Un.version,rendererPackageName:Un.rendererPackageName,rendererConfig:Un.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Dt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=th(e),e===null?null:e.stateNode},findFiberByHostInstance:Un.findFiberByHostInstance||lg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xs.isDisabled&&Xs.supportsFiber)try{Ka=Xs.inject(cg),bt=Xs}catch{}}Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ug;Xe.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lu(t))throw Error(R(200));return ig(e,t,null,r)};Xe.createRoot=function(e,t){if(!lu(e))throw Error(R(299));var r=!1,n="",s=If;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=su(e,1,!1,null,null,r,!1,n,s),e[Ot]=t.current,os(e.nodeType===8?e.parentNode:e),new iu(t)};Xe.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(R(188)):(e=Object.keys(e).join(","),Error(R(268,e)));return e=th(t),e=e===null?null:e.stateNode,e};Xe.flushSync=function(e){return Or(e)};Xe.hydrate=function(e,t,r){if(!li(t))throw Error(R(200));return oi(null,e,t,!0,r)};Xe.hydrateRoot=function(e,t,r){if(!lu(e))throw Error(R(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",l=If;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Of(t,null,e,1,r??null,s,!1,i,l),e[Ot]=t.current,os(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new ii(t)};Xe.render=function(e,t,r){if(!li(t))throw Error(R(200));return oi(null,e,t,!1,r)};Xe.unmountComponentAtNode=function(e){if(!li(e))throw Error(R(40));return e._reactRootContainer?(Or(function(){oi(null,null,e,!1,function(){e._reactRootContainer=null,e[Ot]=null})}),!0):!1};Xe.unstable_batchedUpdates=eu;Xe.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!li(r))throw Error(R(200));if(e==null||e._reactInternals===void 0)throw Error(R(38));return oi(e,t,r,!1,n)};Xe.version="18.3.1-next-f1338f8080-20240426";function Lf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Lf)}catch(e){console.error(e)}}Lf(),Id.exports=Xe;var dg=Id.exports,$c=dg;tl.createRoot=$c.createRoot,tl.hydrateRoot=$c.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xs(){return xs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xs.apply(this,arguments)}var Jt;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Jt||(Jt={}));const Mc="popstate";function hg(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:l,hash:o}=n.location;return Kl("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:za(s)}return pg(t,r,null,e)}function he(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ou(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function fg(){return Math.random().toString(36).substr(2,8)}function zc(e,t){return{usr:e.state,key:e.key,idx:t}}function Kl(e,t,r,n){return r===void 0&&(r=null),xs({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Sn(t):t,{state:r,key:t&&t.key||n||fg()})}function za(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Sn(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function pg(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,l=s.history,o=Jt.Pop,u=null,c=h();c==null&&(c=0,l.replaceState(xs({},l.state,{idx:c}),""));function h(){return(l.state||{idx:null}).idx}function d(){o=Jt.Pop;let j=h(),g=j==null?null:j-c;c=j,u&&u({action:o,location:v.location,delta:g})}function f(j,g){o=Jt.Push;let m=Kl(v.location,j,g);c=h()+1;let p=zc(m,c),_=v.createHref(m);try{l.pushState(p,"",_)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;s.location.assign(_)}i&&u&&u({action:o,location:v.location,delta:1})}function y(j,g){o=Jt.Replace;let m=Kl(v.location,j,g);c=h();let p=zc(m,c),_=v.createHref(m);l.replaceState(p,"",_),i&&u&&u({action:o,location:v.location,delta:0})}function x(j){let g=s.location.origin!=="null"?s.location.origin:s.location.href,m=typeof j=="string"?j:za(j);return m=m.replace(/ $/,"%20"),he(g,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,g)}let v={get action(){return o},get location(){return e(s,l)},listen(j){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Mc,d),u=j,()=>{s.removeEventListener(Mc,d),u=null}},createHref(j){return t(s,j)},createURL:x,encodeLocation(j){let g=x(j);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:y,go(j){return l.go(j)}};return v}var Fc;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Fc||(Fc={}));function mg(e,t,r){return r===void 0&&(r="/"),gg(e,t,r)}function gg(e,t,r,n){let s=typeof t=="string"?Sn(t):t,i=uu(s.pathname||"/",r);if(i==null)return null;let l=Uf(e);xg(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let c=Tg(i);o=Sg(l[u],c)}return o}function Uf(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(he(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let c=sr([n,u.relativePath]),h=r.concat(u);i.children&&i.children.length>0&&(he(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),Uf(i.children,t,h,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:jg(c,i.index),routesMeta:h})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let u of Df(i.path))s(i,l,u)}),t}function Df(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let l=Df(n.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),s&&o.push(...l),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function xg(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Ng(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const yg=/^:[\w-]+$/,vg=3,bg=2,wg=1,kg=10,_g=-2,Bc=e=>e==="*";function jg(e,t){let r=e.split("/"),n=r.length;return r.some(Bc)&&(n+=_g),t&&(n+=bg),r.filter(s=>!Bc(s)).reduce((s,i)=>s+(yg.test(i)?vg:i===""?wg:kg),n)}function Ng(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function Sg(e,t,r){let{routesMeta:n}=e,s={},i="/",l=[];for(let o=0;o<n.length;++o){let u=n[o],c=o===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",d=Eg({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},h),f=u.route;if(!d)return null;Object.assign(s,d.params),l.push({params:s,pathname:sr([i,d.pathname]),pathnameBase:Ig(sr([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=sr([i,d.pathnameBase]))}return l}function Eg(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Cg(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,h,d)=>{let{paramName:f,isOptional:y}=h;if(f==="*"){let v=o[d]||"";l=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[d];return y&&!x?c[f]=void 0:c[f]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:l,pattern:e}}function Cg(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ou(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Tg(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ou(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function uu(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const Rg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ag=e=>Rg.test(e);function Pg(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Sn(e):e,i;if(r)if(Ag(r))i=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),ou(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?i=qc(r.substring(1),"/"):i=qc(r,t)}else i=t;return{pathname:i,search:Lg(n),hash:Ug(s)}}function qc(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Vi(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Og(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function cu(e,t){let r=Og(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function du(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Sn(e):(s=xs({},e),he(!s.pathname||!s.pathname.includes("?"),Vi("?","pathname","search",s)),he(!s.pathname||!s.pathname.includes("#"),Vi("#","pathname","hash",s)),he(!s.search||!s.search.includes("#"),Vi("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let d=t.length-1;if(!n&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}o=d>=0?t[d]:"/"}let u=Pg(s,o),c=l&&l!=="/"&&l.endsWith("/"),h=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||h)&&(u.pathname+="/"),u}const sr=e=>e.join("/").replace(/\/\/+/g,"/"),Ig=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Lg=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Ug=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Dg(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const $f=["post","put","patch","delete"];new Set($f);const $g=["get",...$f];new Set($g);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ys(){return ys=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ys.apply(this,arguments)}const hu=w.createContext(null),Mg=w.createContext(null),dr=w.createContext(null),ui=w.createContext(null),hr=w.createContext({outlet:null,matches:[],isDataRoute:!1}),Mf=w.createContext(null);function zg(e,t){let{relative:r}=t===void 0?{}:t;En()||he(!1);let{basename:n,navigator:s}=w.useContext(dr),{hash:i,pathname:l,search:o}=Bf(e,{relative:r}),u=l;return n!=="/"&&(u=l==="/"?n:sr([n,l])),s.createHref({pathname:u,search:o,hash:i})}function En(){return w.useContext(ui)!=null}function Cn(){return En()||he(!1),w.useContext(ui).location}function zf(e){w.useContext(dr).static||w.useLayoutEffect(e)}function Ff(){let{isDataRoute:e}=w.useContext(hr);return e?Zg():Fg()}function Fg(){En()||he(!1);let e=w.useContext(hu),{basename:t,future:r,navigator:n}=w.useContext(dr),{matches:s}=w.useContext(hr),{pathname:i}=Cn(),l=JSON.stringify(cu(s,r.v7_relativeSplatPath)),o=w.useRef(!1);return zf(()=>{o.current=!0}),w.useCallback(function(c,h){if(h===void 0&&(h={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=du(c,JSON.parse(l),i,h.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:sr([t,d.pathname])),(h.replace?n.replace:n.push)(d,h.state,h)},[t,n,l,i,e])}function Bf(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=w.useContext(dr),{matches:s}=w.useContext(hr),{pathname:i}=Cn(),l=JSON.stringify(cu(s,n.v7_relativeSplatPath));return w.useMemo(()=>du(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function Bg(e,t){return qg(e,t)}function qg(e,t,r,n){En()||he(!1);let{navigator:s}=w.useContext(dr),{matches:i}=w.useContext(hr),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let c=Cn(),h;if(t){var d;let j=typeof t=="string"?Sn(t):t;u==="/"||(d=j.pathname)!=null&&d.startsWith(u)||he(!1),h=j}else h=c;let f=h.pathname||"/",y=f;if(u!=="/"){let j=u.replace(/^\//,"").split("/");y="/"+f.replace(/^\//,"").split("/").slice(j.length).join("/")}let x=mg(e,{pathname:y}),v=Kg(x&&x.map(j=>Object.assign({},j,{params:Object.assign({},o,j.params),pathname:sr([u,s.encodeLocation?s.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?u:sr([u,s.encodeLocation?s.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),i,r,n);return t&&v?w.createElement(ui.Provider,{value:{location:ys({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Jt.Pop}},v):v}function Vg(){let e=Xg(),t=Dg(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:s},r):null,null)}const Wg=w.createElement(Vg,null);class Hg extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(hr.Provider,{value:this.props.routeContext},w.createElement(Mf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Gg(e){let{routeContext:t,match:r,children:n}=e,s=w.useContext(hu);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(hr.Provider,{value:t},n)}function Kg(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let h=l.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);h>=0||he(!1),l=l.slice(0,Math.min(l.length,h+1))}let u=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<l.length;h++){let d=l[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=h),d.route.id){let{loaderData:f,errors:y}=r,x=d.route.loader&&f[d.route.id]===void 0&&(!y||y[d.route.id]===void 0);if(d.route.lazy||x){u=!0,c>=0?l=l.slice(0,c+1):l=[l[0]];break}}}return l.reduceRight((h,d,f)=>{let y,x=!1,v=null,j=null;r&&(y=o&&d.route.id?o[d.route.id]:void 0,v=d.route.errorElement||Wg,u&&(c<0&&f===0?(ex("route-fallback"),x=!0,j=null):c===f&&(x=!0,j=d.route.hydrateFallbackElement||null)));let g=t.concat(l.slice(0,f+1)),m=()=>{let p;return y?p=v:x?p=j:d.route.Component?p=w.createElement(d.route.Component,null):d.route.element?p=d.route.element:p=h,w.createElement(Gg,{match:d,routeContext:{outlet:h,matches:g,isDataRoute:r!=null},children:p})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?w.createElement(Hg,{location:r.location,revalidation:r.revalidation,component:v,error:y,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}var qf=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(qf||{}),Vf=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Vf||{});function Jg(e){let t=w.useContext(hu);return t||he(!1),t}function Yg(e){let t=w.useContext(Mg);return t||he(!1),t}function Qg(e){let t=w.useContext(hr);return t||he(!1),t}function Wf(e){let t=Qg(),r=t.matches[t.matches.length-1];return r.route.id||he(!1),r.route.id}function Xg(){var e;let t=w.useContext(Mf),r=Yg(),n=Wf();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Zg(){let{router:e}=Jg(qf.UseNavigateStable),t=Wf(Vf.UseNavigateStable),r=w.useRef(!1);return zf(()=>{r.current=!0}),w.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,ys({fromRouteId:t},i)))},[e,t])}const Vc={};function ex(e,t,r){Vc[e]||(Vc[e]=!0)}function tx(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Wc(e){let{to:t,replace:r,state:n,relative:s}=e;En()||he(!1);let{future:i,static:l}=w.useContext(dr),{matches:o}=w.useContext(hr),{pathname:u}=Cn(),c=Ff(),h=du(t,cu(o,i.v7_relativeSplatPath),u,s==="path"),d=JSON.stringify(h);return w.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:s}),[c,d,s,r,n]),null}function Nt(e){he(!1)}function rx(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Jt.Pop,navigator:i,static:l=!1,future:o}=e;En()&&he(!1);let u=t.replace(/^\/*/,"/"),c=w.useMemo(()=>({basename:u,navigator:i,static:l,future:ys({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof n=="string"&&(n=Sn(n));let{pathname:h="/",search:d="",hash:f="",state:y=null,key:x="default"}=n,v=w.useMemo(()=>{let j=uu(h,u);return j==null?null:{location:{pathname:j,search:d,hash:f,state:y,key:x},navigationType:s}},[u,h,d,f,y,x,s]);return v==null?null:w.createElement(dr.Provider,{value:c},w.createElement(ui.Provider,{children:r,value:v}))}function nx(e){let{children:t,location:r}=e;return Bg(Jl(t),r)}new Promise(()=>{});function Jl(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,s)=>{if(!w.isValidElement(n))return;let i=[...t,s];if(n.type===w.Fragment){r.push.apply(r,Jl(n.props.children,i));return}n.type!==Nt&&he(!1),!n.props.index||!n.props.children||he(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Jl(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yl(){return Yl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yl.apply(this,arguments)}function sx(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function ax(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function ix(e,t){return e.button===0&&(!t||t==="_self")&&!ax(e)}const lx=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ox="6";try{window.__reactRouterVersion=ox}catch{}const ux="startTransition",Hc=ep[ux];function cx(e){let{basename:t,children:r,future:n,window:s}=e,i=w.useRef();i.current==null&&(i.current=hg({window:s,v5Compat:!0}));let l=i.current,[o,u]=w.useState({action:l.action,location:l.location}),{v7_startTransition:c}=n||{},h=w.useCallback(d=>{c&&Hc?Hc(()=>u(d)):u(d)},[u,c]);return w.useLayoutEffect(()=>l.listen(h),[l,h]),w.useEffect(()=>tx(n),[n]),w.createElement(rx,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const dx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",hx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dn=w.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:l,state:o,target:u,to:c,preventScrollReset:h,viewTransition:d}=t,f=sx(t,lx),{basename:y}=w.useContext(dr),x,v=!1;if(typeof c=="string"&&hx.test(c)&&(x=c,dx))try{let p=new URL(window.location.href),_=c.startsWith("//")?new URL(p.protocol+c):new URL(c),C=uu(_.pathname,y);_.origin===p.origin&&C!=null?c=C+_.search+_.hash:v=!0}catch{}let j=zg(c,{relative:s}),g=fx(c,{replace:l,state:o,target:u,preventScrollReset:h,relative:s,viewTransition:d});function m(p){n&&n(p),p.defaultPrevented||g(p)}return w.createElement("a",Yl({},f,{href:x||j,onClick:v||i?n:m,ref:r,target:u}))});var Gc;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Gc||(Gc={}));var Kc;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Kc||(Kc={}));function fx(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,u=Ff(),c=Cn(),h=Bf(e,{relative:l});return w.useCallback(d=>{if(ix(d,r)){d.preventDefault();let f=n!==void 0?n:za(c)===za(h);u(e,{replace:f,state:s,preventScrollReset:i,relative:l,viewTransition:o})}},[c,u,h,n,s,r,e,i,l,o])}function ci(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function px(e,t,r,n){function s(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(h){try{c(n.next(h))}catch(d){l(d)}}function u(h){try{c(n.throw(h))}catch(d){l(d)}}function c(h){h.done?i(h.value):s(h.value).then(o,u)}c((n=n.apply(e,t||[])).next())})}const mx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class fu extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class gx extends fu{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Jc extends fu{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Yc extends fu{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ql;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Ql||(Ql={}));class xx{constructor(t,{headers:r={},customFetch:n,region:s=Ql.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=mx(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return px(this,arguments,void 0,function*(r,n={}){var s;let i,l;try{const{headers:o,method:u,body:c,signal:h,timeout:d}=n;let f={},{region:y}=n;y||(y=this.region);const x=new URL(`${this.url}/${r}`);y&&y!=="any"&&(f["x-region"]=y,x.searchParams.set("forceFunctionRegion",y));let v;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",v=c):typeof c=="string"?(f["Content-Type"]="text/plain",v=c):typeof FormData<"u"&&c instanceof FormData?v=c:(f["Content-Type"]="application/json",v=JSON.stringify(c)):v=c;let j=h;d&&(l=new AbortController,i=setTimeout(()=>l.abort(),d),h?(j=l.signal,h.addEventListener("abort",()=>l.abort())):j=l.signal);const g=yield this.fetch(x.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:v,signal:j}).catch(C=>{throw new gx(C)}),m=g.headers.get("x-relay-error");if(m&&m==="true")throw new Jc(g);if(!g.ok)throw new Yc(g);let p=((s=g.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),_;return p==="application/json"?_=yield g.json():p==="application/octet-stream"||p==="application/pdf"?_=yield g.blob():p==="text/event-stream"?_=g:p==="multipart/form-data"?_=yield g.formData():_=yield g.text(),{data:_,error:null,response:g}}catch(o){return{data:null,error:o,response:o instanceof Yc||o instanceof Jc?o.context:void 0}}finally{i&&clearTimeout(i)}})}}var yx=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},vx=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let l=null,o=null,u=null,c=i.status,h=i.statusText;if(i.ok){var d,f;if(r.method!=="HEAD"){var y;const g=await i.text();g===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((y=r.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?o=g:o=JSON.parse(g))}const v=(d=r.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),j=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");v&&j&&j.length>1&&(u=parseInt(j[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(l={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,u=null,c=406,h="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var x;const v=await i.text();try{l=JSON.parse(v),Array.isArray(l)&&i.status===404&&(o=[],l=null,c=200,h="OK")}catch{i.status===404&&v===""?(c=204,h="No Content"):l={message:v}}if(l&&r.isMaybeSingle&&(!(l==null||(x=l.details)===null||x===void 0)&&x.includes("0 rows"))&&(l=null,c=200,h="OK"),l&&r.shouldThrowOnError)throw new yx(l)}return{error:l,data:o,count:u,status:c,statusText:h}});return this.shouldThrowOnError||(s=s.catch(i=>{var l;let o="";const u=i==null?void 0:i.cause;if(u){var c,h,d,f;const x=(c=u==null?void 0:u.message)!==null&&c!==void 0?c:"",v=(h=u==null?void 0:u.code)!==null&&h!==void 0?h:"";o=`${(d=i==null?void 0:i.name)!==null&&d!==void 0?d:"FetchError"}: ${i==null?void 0:i.message}`,o+=`

Caused by: ${(f=u==null?void 0:u.name)!==null&&f!==void 0?f:"Error"}: ${x}`,v&&(o+=` (${v})`),u!=null&&u.stack&&(o+=`
${u.stack}`)}else{var y;o=(y=i==null?void 0:i.stack)!==null&&y!==void 0?y:""}return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},bx=class extends vx{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:i="text"}={}){var l;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${o};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Qc=new RegExp("[,()]");var Vr=class extends bx{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Qc.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Qc.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},wx=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,t){const{head:r=!1,count:n}=t??{},s=r?"HEAD":"GET";let i=!1;const l=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",l),n&&this.headers.append("Prefer",`count=${n}`),new Vr({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const s="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((l,o)=>l.concat(Object.keys(o)),[]);if(i.length>0){const l=[...new Set(i)].map(o=>`"${o}"`);this.url.searchParams.set("columns",l.join(","))}}return new Vr({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(o.length>0){const u=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Vr({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Vr({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Vr({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},kx=class Hf{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new wx(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Hf(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){var l;let o;const u=new URL(`${this.url}/rpc/${t}`);let c;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{u.searchParams.append(d,f)})):(o="POST",c=r);const h=new Headers(this.headers);return i&&h.set("Prefer",`count=${i}`),new Vr({method:o,url:u,headers:h,schema:this.schemaName,body:c,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class _x{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const jx="2.89.0",Nx=`realtime-js/${jx}`,Gf="1.0.0",Sx="2.0.0",Xc=Gf,Xl=1e4,Ex=1e3,Cx=100;var qt;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(qt||(qt={}));var ge;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ge||(ge={}));var dt;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(dt||(dt={}));var Zl;(function(e){e.websocket="websocket"})(Zl||(Zl={}));var yr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(yr||(yr={}));class Tx{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var s,i;const l=t.topic,o=(s=t.ref)!==null&&s!==void 0?s:"",u=(i=t.join_ref)!==null&&i!==void 0?i:"",c=t.payload.event,h=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},d=Object.keys(h).length===0?"":JSON.stringify(h);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+o.length+l.length+c.length+d.length,y=new ArrayBuffer(this.HEADER_LENGTH+f);let x=new DataView(y),v=0;x.setUint8(v++,this.KINDS.userBroadcastPush),x.setUint8(v++,u.length),x.setUint8(v++,o.length),x.setUint8(v++,l.length),x.setUint8(v++,c.length),x.setUint8(v++,d.length),x.setUint8(v++,r),Array.from(u,g=>x.setUint8(v++,g.charCodeAt(0))),Array.from(o,g=>x.setUint8(v++,g.charCodeAt(0))),Array.from(l,g=>x.setUint8(v++,g.charCodeAt(0))),Array.from(c,g=>x.setUint8(v++,g.charCodeAt(0))),Array.from(d,g=>x.setUint8(v++,g.charCodeAt(0)));var j=new Uint8Array(y.byteLength+n.byteLength);return j.set(new Uint8Array(y),0),j.set(new Uint8Array(n),y.byteLength),j.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[s,i,l,o,u]=n;return r({join_ref:s,ref:i,topic:l,event:o,payload:u})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2),l=r.getUint8(3),o=r.getUint8(4);let u=this.HEADER_LENGTH+4;const c=n.decode(t.slice(u,u+s));u=u+s;const h=n.decode(t.slice(u,u+i));u=u+i;const d=n.decode(t.slice(u,u+l));u=u+l;const f=t.slice(u,t.byteLength),y=o===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,x={type:this.BROADCAST_EVENT,event:h,payload:y};return l>0&&(x.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class Kf{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var X;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(X||(X={}));const Zc=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,l)=>(i[l]=Rx(l,e,t,s),i),{}):{}},Rx=(e,t,r,n)=>{const s=t.find(o=>o.name===e),i=s==null?void 0:s.type,l=r[e];return i&&!n.includes(i)?Jf(i,l):eo(l)},Jf=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Ix(t,r)}switch(e){case X.bool:return Ax(t);case X.float4:case X.float8:case X.int2:case X.int4:case X.int8:case X.numeric:case X.oid:return Px(t);case X.json:case X.jsonb:return Ox(t);case X.timestamp:return Lx(t);case X.abstime:case X.date:case X.daterange:case X.int4range:case X.int8range:case X.money:case X.reltime:case X.text:case X.time:case X.timestamptz:case X.timetz:case X.tsrange:case X.tstzrange:return eo(t);default:return eo(t)}},eo=e=>e,Ax=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Px=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ox=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},Ix=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(o=>Jf(t,o))}return e},Lx=e=>typeof e=="string"?e.replace(" ","T"):e,Yf=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Wi{constructor(t,r,n={},s=Xl){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ed;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ed||(ed={}));class Xn{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Xn.syncState(this.state,s,i,l),this.pendingDiffs.forEach(u=>{this.state=Xn.syncDiff(this.state,u,i,l)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:l,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Xn.syncDiff(this.state,s,i,l),o())}),this.onJoin((s,i,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:l})}),this.onLeave((s,i,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),l=this.transformState(r),o={},u={};return this.map(i,(c,h)=>{l[c]||(u[c]=h)}),this.map(l,(c,h)=>{const d=i[c];if(d){const f=h.map(j=>j.presence_ref),y=d.map(j=>j.presence_ref),x=h.filter(j=>y.indexOf(j.presence_ref)<0),v=d.filter(j=>f.indexOf(j.presence_ref)<0);x.length>0&&(o[c]=x),v.length>0&&(u[c]=v)}else o[c]=h}),this.syncDiff(i,{joins:o,leaves:u},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var c;const h=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(u),h.length>0){const d=t[o].map(y=>y.presence_ref),f=h.filter(y=>d.indexOf(y.presence_ref)<0);t[o].unshift(...f)}n(o,h,u)}),this.map(l,(o,u)=>{let c=t[o];if(!c)return;const h=u.map(d=>d.presence_ref);c=c.filter(d=>h.indexOf(d.presence_ref)<0),t[o]=c,s(o,c,u),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var td;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(td||(td={}));var Zn;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Zn||(Zn={}));var Et;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Et||(Et={}));class on{constructor(t,r={config:{}},n){var s,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=ge.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Wi(this,dt.join,this.params,this.timeout),this.rejoinTimer=new Kf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ge.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ge.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=ge.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ge.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=ge.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dt.reply,{},(l,o)=>{this._trigger(this._replyEventName(o),l)}),this.presence=new Xn(this),this.broadcastEndpointURL=Yf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==ge.closed){const{config:{broadcast:l,presence:o,private:u}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(y=>y.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[Zn.PRESENCE]&&this.bindings[Zn.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},f={broadcast:l,presence:Object.assign(Object.assign({},o),{enabled:h}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(y=>t==null?void 0:t(Et.CHANNEL_ERROR,y)),this._onClose(()=>t==null?void 0:t(Et.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:y})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){t==null||t(Et.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,j=(x=v==null?void 0:v.length)!==null&&x!==void 0?x:0,g=[];for(let m=0;m<j;m++){const p=v[m],{filter:{event:_,schema:C,table:S,filter:N}}=p,k=y&&y[m];if(k&&k.event===_&&on.isFilterValueEqual(k.schema,C)&&on.isFilterValueEqual(k.table,S)&&on.isFilterValueEqual(k.filter,N))g.push(Object.assign(Object.assign({},p),{id:k.id}));else{this.unsubscribe(),this.state=ge.errored,t==null||t(Et.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Et.SUBSCRIBED);return}}).receive("error",y=>{this.state=ge.errored,t==null||t(Et.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Et.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===ge.joined&&t===Zn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(o.status===202)return{success:!0};let u=o.statusText;try{const c=await o.json();u=c.error||c.message||u}catch{}return Promise.reject(new Error(u))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:l}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,o,u;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(o=(l=this.params)===null||l===void 0?void 0:l.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ge.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dt.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Wi(this,dt.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ge.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Wi(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Cx){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const l=t.toLocaleLowerCase(),{close:o,error:u,leave:c,join:h}=dt;if(n&&[o,u,c,h].indexOf(l)>=0&&n!==this._joinRef())return;let f=this._onMessage(l,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var x,v,j;return((x=y.filter)===null||x===void 0?void 0:x.event)==="*"||((j=(v=y.filter)===null||v===void 0?void 0:v.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===l}).map(y=>y.callback(f,n)):(i=this.bindings[l])===null||i===void 0||i.filter(y=>{var x,v,j,g,m,p;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in y){const _=y.id,C=(x=y.filter)===null||x===void 0?void 0:x.event;return _&&((v=r.ids)===null||v===void 0?void 0:v.includes(_))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((j=r.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const _=(m=(g=y==null?void 0:y.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return _==="*"||_===((p=r==null?void 0:r.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===l}).map(y=>{if(typeof f=="object"&&"ids"in f){const x=f.data,{schema:v,table:j,commit_timestamp:g,type:m,errors:p}=x;f=Object.assign(Object.assign({},{schema:v,table:j,commit_timestamp:g,eventType:m,new:{},old:{},errors:p}),this._getPayloadRecords(x))}y.callback(f,n)})}_isClosed(){return this.state===ge.closed}_isJoined(){return this.state===ge.joined}_isJoining(){return this.state===ge.joining}_isLeaving(){return this.state===ge.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&on.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(dt.close,{},t)}_onError(t){this._on(dt.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ge.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Zc(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Zc(t.columns,t.old_record)),r}}const Hi=()=>{},Zs={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ux=[1e3,2e3,5e3,1e4],Dx=1e4,$x=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Mx{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Xl,this.transport=null,this.heartbeatIntervalMs=Zs.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Hi,this.ref=0,this.reconnectTimer=null,this.vsn=Xc,this.logger=Hi,this.conn=null,this.sendBuffer=[],this.serializer=new Tx,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Zl.websocket}`,this.httpEndpoint=Yf(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=_x.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case qt.connecting:return yr.Connecting;case qt.open:return yr.Open;case qt.closing:return yr.Closing;default:return yr.Closed}}isConnected(){return this.connectionState()===yr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new on(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,l=()=>{this.encode(t,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Ex,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Zs.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:l}=r,o=l?`(${l})`:"",u=i.status||"";this.log("receive",`${u} ${n} ${s} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(s,i,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===qt.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===qt.open||this.conn.readyState===qt.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(dt.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([$x],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const i={access_token:r,version:Nx};r&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(dt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Kf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zs.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,i,l,o,u,c,h,d,f,y;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Xl,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Zs.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Hi,this.vsn=(u=t==null?void 0:t.vsn)!==null&&u!==void 0?u:Xc,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:x=>Ux[x-1]||Dx,this.vsn){case Gf:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:(x,v)=>v(JSON.stringify(x)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:(x,v)=>v(JSON.parse(x));break;case Sx:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(y=t==null?void 0:t.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var vs=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function zx(e,t,r){const n=new URL(t,e);if(r)for(const[s,i]of Object.entries(r))i!==void 0&&n.searchParams.set(s,i);return n.toString()}async function Fx(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Bx(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:i,headers:l}){const o=zx(e.baseUrl,n,s),u=await Fx(e.auth),c=await t(o,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...u,...l},body:i?JSON.stringify(i):void 0}),h=await c.text(),d=(c.headers.get("content-type")||"").includes("application/json"),f=d&&h?JSON.parse(h):h;if(!c.ok){const y=d?f:void 0,x=y==null?void 0:y.error;throw new vs((x==null?void 0:x.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:y})}return{status:c.status,headers:c.headers,data:f}}}}function ea(e){return e.join("")}var qx=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:ea(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ea(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ea(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ea(e.namespace)}`}),!0}catch(t){if(t instanceof vs&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof vs&&r.status===409)return;throw r}}};function $r(e){return e.join("")}var Vx=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$r(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${$r(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${$r(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$r(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$r(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$r(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof vs&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof vs&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},Wx=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Bx({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new qx(this.client,t),this.tableOps=new Vx(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},di=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function ne(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Hx=class extends di{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},to=class extends di{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const pu=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Gx=()=>Response,ro=e=>{if(Array.isArray(e))return e.map(r=>ro(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=ro(n)}),t},Kx=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Jx=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function bs(e){"@babel/helpers - typeof";return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bs(e)}function Yx(e,t){if(bs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qx(e){var t=Yx(e,"string");return bs(t)=="symbol"?t:t+""}function Xx(e,t,r){return(t=Qx(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rd(Object(r),!0).forEach(function(n){Xx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rd(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Gi=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Zx=async(e,t,r)=>{e instanceof await Gx()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const s=e.status||500,i=(n==null?void 0:n.statusCode)||s+"";t(new Hx(Gi(n),s,i))}).catch(n=>{t(new to(Gi(n),n))}):t(new to(Gi(e),e))},ey=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(Kx(n)?(s.headers=F({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),F(F({},s),r))};async function Ps(e,t,r,n,s,i){return new Promise((l,o)=>{e(r,ey(t,n,s,i)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>l(u)).catch(u=>Zx(u,o,n))})}async function ws(e,t,r,n){return Ps(e,"GET",t,r,n)}async function ut(e,t,r,n,s){return Ps(e,"POST",t,n,s,r)}async function no(e,t,r,n,s){return Ps(e,"PUT",t,n,s,r)}async function ty(e,t,r,n){return Ps(e,"HEAD",t,F(F({},r),{},{noResolveJson:!0}),n)}async function mu(e,t,r,n,s){return Ps(e,"DELETE",t,n,s,r)}var ry=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ne(t))return{data:null,error:t};throw t}}};let Qf;Qf=Symbol.toStringTag;var ny=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Qf]="BlobDownloadBuilder",this.promise=null}asStream(){return new ry(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ne(t))return{data:null,error:t};throw t}}};const sy={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},nd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ay=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=pu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var s=this;try{let i;const l=F(F({},nd),n);let o=F(F({},s.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const u=l.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),u&&i.append("metadata",s.encodeMetadata(u)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",l.cacheControl),u&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(u))):(i=r,o["cache-control"]=`max-age=${l.cacheControl}`,o["content-type"]=l.contentType,u&&(o["x-metadata"]=s.toBase64(s.encodeMetadata(u))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(o=F(F({},o),n.headers));const c=s._removeEmptyFolders(t),h=s._getFinalPath(c),d=await(e=="PUT"?no:ut)(s.fetch,`${s.url}/object/${h}`,i,F({headers:o},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(ne(i))return{data:null,error:i};throw i}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var s=this;const i=s._removeEmptyFolders(e),l=s._getFinalPath(i),o=new URL(s.url+`/object/upload/sign/${l}`);o.searchParams.set("token",t);try{let u;const c=F({upsert:nd.upsert},n),h=F(F({},s.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType),{data:{path:i,fullPath:(await no(s.fetch,o.toString(),u,{headers:h})).Key},error:null}}catch(u){if(s.shouldThrowOnError)throw u;if(ne(u))return{data:null,error:u};throw u}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const s=F({},r.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=await ut(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(r.url+i.url),o=l.searchParams.get("token");if(!o)throw new di("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:o},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ne(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await ut(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ne(s))return{data:null,error:s};throw s}}async copy(e,t,r){var n=this;try{return{data:{path:(await ut(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ne(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,r){var n=this;try{let s=n._getFinalPath(e),i=await ut(n.fetch,`${n.url}/object/sign/${s}`,F({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${n.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ne(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,r){var n=this;try{const s=await ut(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(l=>F(F({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${i}`):null})),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ne(s))return{data:null,error:s};throw s}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),s=n?`?${n}`:"",i=this._getFinalPath(e),l=()=>ws(this.fetch,`${this.url}/${r}/${i}${s}`,{headers:this.headers,noResolveJson:!0});return new ny(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:ro(await ws(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ne(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await ty(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ne(n)&&n instanceof to){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&n.push(s);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(e){var t=this;try{return{data:await mu(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const s=F(F(F({},sy),t),{},{prefix:e||""});return{data:await ut(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},r),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(ne(s))return{data:null,error:s};throw s}}async listV2(e,t){var r=this;try{const n=F({},e);return{data:await ut(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ne(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Xf="2.89.0",Zf={"X-Client-Info":`storage-js/${Xf}`};var iy=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const s=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=F(F({},Zf),t),this.fetch=pu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await ws(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await ws(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await ut(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ne(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await no(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(ne(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await ut(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await mu(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},ly=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=F(F({},Zf),t),this.fetch=pu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await ut(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),s=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await ws(t.fetch,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await mu(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ne(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!Jx(e))throw new di("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Wx({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(s,i){const l=s[i];return typeof l!="function"?l:async(...o)=>{try{return{data:await l.apply(s,o),error:null}}catch(u){if(n)throw u;return{data:null,error:u}}}}})}};const gu={"X-Client-Info":`storage-js/${Xf}`,"Content-Type":"application/json"};var e0=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ge(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Ki=class extends e0{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},oy=class extends e0{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const xu=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),uy=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},sd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),cy=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,s=e;if(typeof s.json=="function")s.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new Ki(sd(i),n,l))}).catch(()=>{const i=n+"";t(new Ki(s.statusText||`HTTP ${n} error`,n,i))});else{const i=n+"";t(new Ki(s.statusText||`HTTP ${n} error`,n,i))}}else t(new oy(sd(e),e))},dy=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(uy(n)?(s.headers=F({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,F(F({},s),r)):s};async function hy(e,t,r,n,s,i){return new Promise((l,o)=>{e(r,dy(t,n,s,i)).then(u=>{if(!u.ok)throw u;if(n!=null&&n.noResolveJson)return u;const c=u.headers.get("content-type");return!c||!c.includes("application/json")?{}:u.json()}).then(u=>l(u)).catch(u=>cy(u,o,n))})}async function Ke(e,t,r,n,s){return hy(e,"POST",t,n,s,r)}var fy=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=F(F({},gu),t),this.fetch=xu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Ke(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ge(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Ke(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ge(n))return{data:null,error:n};throw n}}},py=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=F(F({},gu),t),this.fetch=xu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ke(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Ke(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ke(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}},my=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=F(F({},gu),t),this.fetch=xu(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ke(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ge(r))return{data:null,error:r};throw r}}},gy=class extends my{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new xy(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},xy=class extends fy{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,F(F({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,F(F({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new yy(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},yy=class extends py{constructor(e,t,r,n,s){super(e,t,s),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,F(F({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,F(F({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,F(F({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,F(F({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,F(F({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},vy=class extends iy{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new ay(this.url,this.headers,e,this.fetch)}get vectors(){return new gy(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ly(this.url+"/iceberg",this.headers,this.fetch)}};const t0="2.89.0",Wr=30*1e3,so=3,Ji=so*Wr,by="http://localhost:9999",wy="supabase.auth.token",ky={"X-Client-Info":`gotrue-js/${t0}`},ao="X-Supabase-Api-Version",r0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_y=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jy=10*60*1e3;class ks extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function $(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Ny extends ks{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Sy(e){return $(e)&&e.name==="AuthApiError"}class vr extends ks{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class $t extends ks{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Ve extends $t{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ey(e){return $(e)&&e.name==="AuthSessionMissingError"}class Mr extends $t{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ta extends $t{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ra extends $t{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Cy(e){return $(e)&&e.name==="AuthImplicitGrantRedirectError"}class ad extends $t{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ty extends $t{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class io extends $t{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Yi(e){return $(e)&&e.name==="AuthRetryableFetchError"}class id extends $t{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class lo extends $t{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Fa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ld=` 	
\r=`.split(""),Ry=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ld.length;t+=1)e[ld[t].charCodeAt(0)]=-2;for(let t=0;t<Fa.length;t+=1)e[Fa[t].charCodeAt(0)]=t;return e})();function od(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Fa[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Fa[n]),t.queuedBits-=6}}function n0(e,t,r){const n=Ry[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ud(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=l=>{Oy(l,n,r)};for(let l=0;l<e.length;l+=1)n0(e.charCodeAt(l),s,i);return t.join("")}function Ay(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Py(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Ay(n,t)}}function Oy(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function mn(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)n0(e.charCodeAt(s),r,n);return new Uint8Array(t)}function Iy(e){const t=[];return Py(e,r=>t.push(r)),new Uint8Array(t)}function _r(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>od(s,r,n)),od(null,r,n),t.join("")}function Ly(e){return Math.round(Date.now()/1e3)+e}function Uy(){return Symbol("auth-callback")}const _e=()=>typeof window<"u"&&typeof document<"u",fr={tested:!1,writable:!1},s0=()=>{if(!_e())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fr.tested)return fr.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),fr.tested=!0,fr.writable=!0}catch{fr.tested=!0,fr.writable=!1}return fr.writable};function Dy(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const a0=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$y=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Hr=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},pr=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ke=async(e,t)=>{await e.removeItem(t)};class hi{constructor(){this.promise=new hi.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}hi.promiseConstructor=Promise;function Qi(e){const t=e.split(".");if(t.length!==3)throw new lo("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!_y.test(t[n]))throw new lo("JWT not in base64url format");return{header:JSON.parse(ud(t[0])),payload:JSON.parse(ud(t[1])),signature:mn(t[2]),raw:{header:t[0],payload:t[1]}}}async function My(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function zy(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){s(l);return}}})()})}function Fy(e){return("0"+e.toString(16)).substr(-2)}function By(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,Fy).join("")}async function qy(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function Vy(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await qy(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function zr(e,t,r=!1){const n=By();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Hr(e,`${t}-code-verifier`,s);const i=await Vy(n);return[i,n===i?"plain":"s256"]}const Wy=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Hy(e){const t=e.headers.get(ao);if(!t||!t.match(Wy))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Gy(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Ky(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Jy=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fr(e){if(!Jy.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xi(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Yy(e,t){return new Proxy(e,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,s)}})}function cd(e){return JSON.parse(JSON.stringify(e))}const xr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qy=[502,503,504];async function dd(e){var t;if(!$y(e))throw new io(xr(e),0);if(Qy.includes(e.status))throw new io(xr(e),e.status);let r;try{r=await e.json()}catch(i){throw new vr(xr(i),i)}let n;const s=Hy(e);if(s&&s.getTime()>=r0["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new id(xr(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ve}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new id(xr(r),e.status,r.weak_password.reasons);throw new Ny(xr(r),e.status||500,n)}const Xy=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function z(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[ao]||(i[ao]=r0["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const o=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",u=await Zy(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function Zy(e,t,r,n,s,i){const l=Xy(t,n,s,i);let o;try{o=await e(r,Object.assign({},l))}catch(u){throw console.error(u),new io(xr(u),0)}if(o.ok||await dd(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(u){await dd(u)}}function lt(e){var t;let r=null;rv(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Ly(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function hd(e){const t=lt(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ht(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ev(e){return{data:e,error:null}}function tv(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,l=ci(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},u=Object.assign({},l);return{data:{properties:o,user:u},error:null}}function fd(e){return e}function rv(e){return e.access_token&&e.refresh_token&&e.expires_in}const Zi=["global","local","others"];class nv{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=a0(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Zi[0]){if(Zi.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zi.join(", ")}`);try{return await z(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if($(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await z(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ht})}catch(n){if($(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=ci(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await z(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:tv,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if($(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await z(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ht})}catch(r){if($(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,l,o,u;try{const c={nextPage:null,lastPage:0,total:0},h=await z(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:fd});if(h.error)throw h.error;const d=await h.json(),f=(l=h.headers.get("x-total-count"))!==null&&l!==void 0?l:0,y=(u=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return y.length>0&&(y.forEach(x=>{const v=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(x.split(";")[1].split("=")[1]);c[`${j}Page`]=v}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if($(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Fr(t);try{return await z(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ht})}catch(r){if($(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Fr(t);try{return await z(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ht})}catch(n){if($(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Fr(t);try{return await z(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ht})}catch(n){if($(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Fr(t.userId);try{const{data:r,error:n}=await z(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if($(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Fr(t.userId),Fr(t.id);try{return{data:await z(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,i,l,o,u;try{const c={nextPage:null,lastPage:0,total:0},h=await z(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:fd});if(h.error)throw h.error;const d=await h.json(),f=(l=h.headers.get("x-total-count"))!==null&&l!==void 0?l:0,y=(u=(o=h.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return y.length>0&&(y.forEach(x=>{const v=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(x.split(";")[1].split("=")[1]);c[`${j}Page`]=v}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if($(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await z(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if($(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await z(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if($(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await z(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if($(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await z(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if($(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await z(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if($(r))return{data:null,error:r};throw r}}}function pd(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Br={debug:!!(globalThis&&s0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class i0 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class sv extends i0{}async function av(e,t,r){Br.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Br.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Br.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Br.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Br.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new sv(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Br.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function iv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function l0(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function lv(e){return parseInt(e,16)}function ov(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function uv(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:i=new Date,nonce:l,notBefore:o,requestId:u,resources:c,scheme:h,uri:d,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const y=l0(e.address),x=h?`${h}://${n}`:n,v=e.statement?`${e.statement}
`:"",j=`${x} wants you to sign in with your Ethereum account:
${y}

${v}`;let g=`URI: ${d}
Version: ${f}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${i.toISOString()}`;if(s&&(g+=`
Expiration Time: ${s.toISOString()}`),o&&(g+=`
Not Before: ${o.toISOString()}`),u&&(g+=`
Request ID: ${u}`),c){let m=`
Resources:`;for(const p of c){if(!p||typeof p!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${p}`);m+=`
- ${p}`}g+=m}return`${j}
${g}`}class fe extends Error{constructor({message:t,code:r,cause:n,name:s}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=s??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Ba extends fe{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function cv({error:e,options:t}){var r,n,s;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new fe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new fe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new fe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new fe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new fe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new fe({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new fe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new fe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(o0(l)){if(i.rp.id!==l)return new fe({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new fe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new fe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new fe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new fe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function dv({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new fe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new fe({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(o0(n)){if(r.rpId!==n)return new fe({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new fe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new fe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new fe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class hv{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const fv=new hv;function pv(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=ci(e,["challenge","user","excludeCredentials"]),i=mn(t).buffer,l=Object.assign(Object.assign({},r),{id:mn(r.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:i,user:l});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const c=n[u];o.excludeCredentials[u]=Object.assign(Object.assign({},c),{id:mn(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function mv(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=ci(e,["challenge","allowCredentials"]),s=mn(t).buffer,i=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const o=r[l];i.allowCredentials[l]=Object.assign(Object.assign({},o),{id:mn(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function gv(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:_r(new Uint8Array(e.response.attestationObject)),clientDataJSON:_r(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function xv(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:_r(new Uint8Array(s.authenticatorData)),clientDataJSON:_r(new Uint8Array(s.clientDataJSON)),signature:_r(new Uint8Array(s.signature)),userHandle:s.userHandle?_r(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function o0(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function md(){var e,t;return!!(_e()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function yv(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ba("Browser returned unexpected credential type",t)}:{data:null,error:new Ba("Empty credential response",t)}}catch(t){return{data:null,error:cv({error:t,options:e})}}}async function vv(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ba("Browser returned unexpected credential type",t)}:{data:null,error:new Ba("Empty credential response",t)}}catch(t){return{data:null,error:dv({error:t,options:e})}}}const bv={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},wv={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function qa(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const i in s){const l=s[i];if(l!==void 0)if(Array.isArray(l))n[i]=l;else if(r(l))n[i]=l;else if(t(l)){const o=n[i];t(o)?n[i]=qa(o,l):n[i]=qa(l)}else n[i]=l}return n}function kv(e,t){return qa(bv,e,t||{})}function _v(e,t){return qa(wv,e,t||{})}class jv{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},i){try{const{data:l,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:o};const u=s??fv.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:c}=l.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(l.webauthn.type){case"create":{const c=kv(l.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:h,error:d}=await yv({publicKey:c,signal:u});return h?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}case"request":{const c=_v(l.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:h,error:d}=await vv(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:c,signal:u}));return h?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}}}catch(l){return $(l)?{data:null,error:l}:{data:null,error:new vr("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new ks("rpId is required for WebAuthn authentication")};try{if(!md())return{data:null,error:new vr("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:i});if(!l)return{data:null,error:o};const{webauthn:u}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:u.type,rpId:r,rpOrigins:n,credential_response:u.credential_response}})}catch(l){return $(l)?{data:null,error:l}:{data:null,error:new vr("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new ks("rpId is required for WebAuthn registration")};try{if(!md())return{data:null,error:new vr("Browser does not support WebAuthn",null)};const{data:l,error:o}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(h=>{var d;return(d=h.data)===null||d===void 0?void 0:d.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:o};const{data:u,error:c}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:i});return u?this._verify({factorId:l.id,challengeId:u.challengeId,webauthn:{rpId:r,rpOrigins:n,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:c}}catch(l){return $(l)?{data:null,error:l}:{data:null,error:new vr("Unexpected error in register",l)}}}}iv();const Nv={url:by,storageKey:wy,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ky,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function gd(e,t,r){return await r()}const qr={};class _s{get jwks(){var t,r;return(r=(t=qr[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){qr[this.storageKey]=Object.assign(Object.assign({},qr[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=qr[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){qr[this.storageKey]=Object.assign(Object.assign({},qr[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},Nv),t);if(this.storageKey=i.storageKey,this.instanceID=(r=_s.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,_s.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&_e()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new nv({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=a0(i.fetch),this.lock=i.lock||gd,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&_e()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=av:this.lock=gd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new jv(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:s0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=pd(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=pd(this.memoryStorage)),_e()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${t0}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(_e()&&(r=Dy(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),_e()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Cy(i)){const u=(t=i.details)===null||t===void 0?void 0:t.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",o),await this._saveSession(l),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return $(r)?this._returnResult({error:r}):this._returnResult({error:new vr("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:lt}),{data:l,error:o}=i;if(o||!l)return this._returnResult({data:{user:null,session:null},error:o});const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:c,session:u},error:null})}catch(i){if($(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:h,password:d,options:f}=t;let y=null,x=null;this.flowType==="pkce"&&([y,x]=await zr(this.storage,this.storageKey)),i=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:y,code_challenge_method:x},xform:lt})}else if("phone"in t){const{phone:h,password:d,options:f}=t;i=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:lt})}else throw new ta("You must provide either an email or phone number and a password");const{data:l,error:o}=i;if(o||!l)return await ke(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const u=l.session,c=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:c,session:u},error:null})}catch(i){if(await ke(this.storage,`${this.storageKey}-code-verifier`),$(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:o}=t;r=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:hd})}else if("phone"in t){const{phone:i,password:l,options:o}=t;r=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:hd})}else throw new ta("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const i=new Mr;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if($(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,i,l,o,u,c,h,d,f;let y,x;if("message"in t)y=t.message,x=t.signature;else{const{chain:v,wallet:j,statement:g,options:m}=t;let p;if(_e())if(typeof j=="object")p=j;else{const O=window;if("ethereum"in O&&typeof O.ethereum=="object"&&"request"in O.ethereum&&typeof O.ethereum.request=="function")p=O.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");p=j}const _=new URL((r=m==null?void 0:m.url)!==null&&r!==void 0?r:window.location.href),C=await p.request({method:"eth_requestAccounts"}).then(O=>O).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=l0(C[0]);let N=(n=m==null?void 0:m.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!N){const O=await p.request({method:"eth_chainId"});N=lv(O)}const k={domain:_.host,address:S,statement:g,uri:_.href,version:"1",chainId:N,nonce:(s=m==null?void 0:m.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(l=(i=m==null?void 0:m.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(o=m==null?void 0:m.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(u=m==null?void 0:m.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(c=m==null?void 0:m.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(h=m==null?void 0:m.signInWithEthereum)===null||h===void 0?void 0:h.resources};y=uv(k),x=await p.request({method:"personal_sign",params:[ov(y),S]})}try{const{data:v,error:j}=await z(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:x},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:lt});if(j)throw j;if(!v||!v.session||!v.user){const g=new Mr;return this._returnResult({data:{user:null,session:null},error:g})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:j})}catch(v){if($(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(t){var r,n,s,i,l,o,u,c,h,d,f,y;let x,v;if("message"in t)x=t.message,v=t.signature;else{const{chain:j,wallet:g,statement:m,options:p}=t;let _;if(_e())if(typeof g=="object")_=g;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))_=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=g}const C=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const S=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),m?{statement:m}:null));let N;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")N=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)N=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)x=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),v=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${C.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(s=(n=p==null?void 0:p.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((u=p==null?void 0:p.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((d=(h=p==null?void 0:p.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||d===void 0)&&d.length?["Resources",...p.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const S=await _.signMessage(new TextEncoder().encode(x),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=S}}try{const{data:j,error:g}=await z(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:_r(v)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:lt});if(g)throw g;if(!j||!j.session||!j.user){const m=new Mr;return this._returnResult({data:{user:null,session:null},error:m})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:g})}catch(j){if($(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(t){const r=await pr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new Ty;const{data:i,error:l}=await z(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:lt});if(await ke(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!i||!i.session||!i.user){const o=new Mr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:l})}catch(i){if(await ke(this.storage,`${this.storageKey}-code-verifier`),$(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:l}=t,o=await z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:lt}),{data:u,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!u||!u.session||!u.user){const h=new Mr;return this._returnResult({data:{user:null,session:null},error:h})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:c})}catch(r){if($(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,s,i,l;try{if("email"in t){const{email:o,options:u}=t;let c=null,h=null;this.flowType==="pkce"&&([c,h]=await zr(this.storage,this.storageKey));const{error:d}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=u==null?void 0:u.data)!==null&&r!==void 0?r:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:h},redirectTo:u==null?void 0:u.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in t){const{phone:o,options:u}=t,{data:c,error:h}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(l=u==null?void 0:u.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:h})}throw new ta("You must provide either an email or phone number.")}catch(o){if(await ke(this.storage,`${this.storageKey}-code-verifier`),$(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:o}=await z(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:lt});if(o)throw o;if(!l)throw new Error("An error occurred on token verification.");const u=l.session,c=l.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:c,session:u},error:null})}catch(s){if($(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,n,s,i,l;try{let o=null,u=null;this.flowType==="pkce"&&([o,u]=await zr(this.storage,this.storageKey));const c=await z(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:u}),headers:this.headers,xform:ev});return!((i=c.data)===null||i===void 0)&&i.url&&_e()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await ke(this.storage,`${this.storageKey}-code-verifier`),$(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ve;const{error:s}=await z(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if($(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:l}=await z(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:l,error:o}=await z(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:o})}throw new ta("You must provide either an email or phone number and a type")}catch(r){if($(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await pr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Ji:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await pr(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=Xi()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=Yy(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ht}):await this._useSession(async r=>{var n,s,i;const{data:l,error:o}=r;if(o)throw o;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ve}:await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Ht})})}catch(r){if($(r))return Ey(r)&&(await this._removeSession(),await ke(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Ve;const l=s.session;let o=null,u=null;this.flowType==="pkce"&&t.email!=null&&([o,u]=await zr(this.storage,this.storageKey));const{data:c,error:h}=await z(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:u}),jwt:l.access_token,xform:Ht});if(h)throw h;return l.user=c.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await ke(this.storage,`${this.storageKey}-code-verifier`),$(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ve;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:l}=Qi(t.access_token);if(l.exp&&(n=l.exp,s=n<=r),s){const{data:o,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(t.access_token);if(u)throw u;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if($(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:o}=r;if(o)throw o;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ve;const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if($(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!_e())throw new ra("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ra(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ad("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ra("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ad("No code detected.");const{data:m,error:p}=await this._exchangeCodeForSession(t.code);if(p)throw p;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:l,expires_in:o,expires_at:u,token_type:c}=t;if(!i||!o||!l||!c)throw new ra("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(o);let f=h+d;u&&(f=parseInt(u));const y=f-h;y*1e3<=Wr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${d}s`);const x=f-d;h-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,f,h):h-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,f,h);const{data:v,error:j}=await this._getUser(i);if(j)throw j;const g={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:f,refresh_token:l,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:t.type},error:null})}catch(n){if($(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await pr(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({error:i});const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:o}=await this.admin.signOut(l,t);if(o&&!(Sy(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await ke(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Uy(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await zr(this.storage,this.storageKey,!0));try{return await z(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await ke(this.storage,`${this.storageKey}-code-verifier`),$(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var l,o,u,c,h;const{data:d,error:f}=i;if(f)throw f;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=t.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await z(this.fetch,"GET",y,{headers:this.headers,jwt:(h=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return _e()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if($(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:i}}=r;if(s)throw s;const{options:l,provider:o,token:u,access_token:c,nonce:h}=t,d=await z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:u,access_token:c,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:lt}),{data:f,error:y}=d;return y?this._returnResult({data:{user:null,session:null},error:y}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Mr}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:y}))}catch(s){if(await ke(this.storage,`${this.storageKey}-code-verifier`),$(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)throw l;return await z(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await zy(async s=>(s>0&&await My(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await z(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:lt})),(s,i)=>{const l=200*Math.pow(2,s);return i&&Yi(i)&&Date.now()+l-n<Wr})}catch(n){if(this._debug(r,"error",n),$(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),_e()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await pr(this.storage,this.storageKey);if(s&&this.userStorage){let l=await pr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:s.user},await Hr(this.userStorage,this.storageKey+"-user",l)),s.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:Xi()}else if(s&&!s.user&&!s.user){const l=await pr(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(s.user=l.user,await ke(this.storage,this.storageKey+"-user"),await Hr(this.storage,this.storageKey,s)):s.user=Xi()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ji;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Ji}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:l}=await this._callRefreshToken(s.refresh_token);l&&(console.error(l),Yi(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:o}=await this._getUser(s.access_token);!o&&(l!=null&&l.user)?(s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ve;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new hi;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new Ve;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),$(i)){const l={data:null,error:i};return Yi(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(u){i.push(u)}});if(await Promise.all(l),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await ke(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Hr(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=cd(s);await Hr(this.storage,this.storageKey,i)}else{const s=cd(r);await Hr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ke(this.storage,this.storageKey),await ke(this.storage,this.storageKey+"-code-verifier"),await ke(this.storage,this.storageKey+"-user"),this.userStorage&&await ke(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&_e()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Wr);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Wr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Wr}ms, refresh threshold is ${so} ticks`),s<=so&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof i0)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_e()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await zr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?this._returnResult({data:null,error:i}):await z(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:l}=r;if(l)return this._returnResult({data:null,error:l});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:u,error:c}=await z(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&u.type==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?gv(t.webauthn.credential_response):xv(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:u}=await z(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:u}))})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=await z(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:o}=l;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:pv(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:mv(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Qi(n.access_token);let l=null;i.aal&&(l=i.aal);let o=l;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=i.amr||[];return{data:{currentLevel:l,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await z(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ve})})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Ve});const l=await z(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&_e()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if($(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new Ve});const l=await z(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return l.data&&l.data.redirect_url&&_e()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if($(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await z(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Ve})})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?(await z(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ve})})}catch(r){if($(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+jy>s)return n;const{data:i,error:l}=await z(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:y,error:x}=await this.getSession();if(x||!y.session)return this._returnResult({data:null,error:x});n=y.session.access_token}const{header:s,payload:i,signature:l,raw:{header:o,payload:u}}=Qi(n);r!=null&&r.allowExpired||Gy(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:i,header:s,signature:l},error:null}}const h=Ky(s.alg),d=await crypto.subtle.importKey("jwk",c,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,l,Iy(`${o}.${u}`)))throw new lo("Invalid JWT signature");return{data:{claims:i,header:s,signature:l},error:null}}catch(n){if($(n))return this._returnResult({data:null,error:n});throw n}}}_s.nextInstanceID={};const Sv=_s,Ev="2.89.0";let Bn="";typeof Deno<"u"?Bn="deno":typeof document<"u"?Bn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bn="react-native":Bn="node";const Cv={"X-Client-Info":`supabase-js-${Bn}/${Ev}`},Tv={headers:Cv},Rv={schema:"public"},Av={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Pv={};function js(e){"@babel/helpers - typeof";return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},js(e)}function Ov(e,t){if(js(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(js(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Iv(e){var t=Ov(e,"string");return js(t)=="symbol"?t:t+""}function Lv(e,t,r){return(t=Iv(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xd(Object(r),!0).forEach(function(n){Lv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xd(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Uv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Dv=()=>Headers,$v=(e,t,r)=>{const n=Uv(r),s=Dv();return async(i,l)=>{var o;const u=(o=await t())!==null&&o!==void 0?o:e;let c=new s(l==null?void 0:l.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),n(i,oe(oe({},l),{},{headers:c}))}};function Mv(e){return e.endsWith("/")?e:e+"/"}function zv(e,t){var r,n;const{db:s,auth:i,realtime:l,global:o}=e,{db:u,auth:c,realtime:h,global:d}=t,f={db:oe(oe({},u),s),auth:oe(oe({},c),i),realtime:oe(oe({},h),l),storage:{},global:oe(oe(oe({},d),o),{},{headers:oe(oe({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function Fv(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Mv(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Bv=class extends Sv{constructor(e){super(e)}},qv=class{constructor(e,t,r){var n,s;this.supabaseUrl=e,this.supabaseKey=t;const i=Fv(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const l=`sb-${i.hostname.split(".")[0]}-auth-token`,o={db:Rv,realtime:Pv,auth:oe(oe({},Av),{},{storageKey:l}),global:Tv},u=zv(r??{},o);if(this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=u.auth)!==null&&c!==void 0?c:{},this.headers,u.global.fetch)}this.fetch=$v(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(oe({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new kx(new URL("rest/v1",i).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new vy(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new xx(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,storageKey:i,flowType:l,lock:o,debug:u,throwOnError:c},h,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bv({url:this.authUrl.href,headers:oe(oe({},f),h),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,flowType:l,lock:o,debug:u,throwOnError:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Mx(this.realtimeUrl.href,oe(oe({},e),{},{params:oe(oe({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Vv=(e,t,r)=>new qv(e,t,r);function Wv(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Wv()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Hv="https://rfhuqenntxiqurplenjn.supabase.co",Gv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJmaHVxZW5udHhpcXVycGxlbmpuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5NjEwNDgsImV4cCI6MjA4MTUzNzA0OH0.pi_6p2H2nuPfJvdT3pHNGpk0BTI3WQKTSzsj8dxQBA8",H=Vv(Hv,Gv);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Kv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),M=(e,t)=>{const r=w.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:o="",children:u,...c},h)=>w.createElement("svg",{ref:h,...Kv,width:s,height:s,stroke:n,strokeWidth:l?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Jv(e)}`,o].join(" "),...c},[...t.map(([d,f])=>w.createElement(d,f)),...Array.isArray(u)?u:[u]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=M("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=M("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=M("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=M("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yu=M("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=M("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=M("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=M("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=M("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zv=M("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=M("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=M("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=M("Code2",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=M("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=M("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=M("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=M("FileCode",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=M("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=M("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=M("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=M("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rb=M("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=M("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=M("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=M("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=M("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=M("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=M("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=M("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=M("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=M("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=M("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=M("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=M("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=M("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=M("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=M("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=M("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=M("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=M("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=M("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=M("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=M("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=M("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=M("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=M("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fb=M("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=M("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=M("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=M("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.312.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=M("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),m0=w.createContext(void 0);function mb({children:e}){const[t,r]=w.useState(()=>{if(typeof window>"u")return"dark";const s=localStorage.getItem("theme");return s==="light"||s==="dark"?s:"dark"});w.useEffect(()=>{const s=window.document.documentElement;t==="dark"?(s.classList.add("dark"),s.classList.remove("light")):(s.classList.add("light"),s.classList.remove("dark")),localStorage.setItem("theme",t)},[t]);const n=()=>{r(s=>{const i=s==="light"?"dark":"light";return console.log("Theme toggled:",s,"->",i),i})};return a.jsx(m0.Provider,{value:{theme:t,toggleTheme:n},children:e})}function gb(){const e=w.useContext(m0);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e}function g0(){const[e,t]=w.useState(null),[r,n]=w.useState(!0);w.useEffect(()=>{s();const{data:{subscription:i}}=H.auth.onAuthStateChange(()=>{s()});return()=>i.unsubscribe()},[]);const s=async()=>{try{const{data:{user:i}}=await H.auth.getUser();if(!i){t(null),n(!1);return}const{data:l,error:o}=await H.from("user_profiles").select("role").eq("id",i.id).maybeSingle();o?(console.error("Supabase query error:",o),console.error("Error details:",{code:o.code,message:o.message,details:o.details,hint:o.hint}),t(null)):l?t(l.role):(console.warn("No user profile found for user:",i.id),t(null))}catch(i){console.error("Error fetching role:",i),t(null)}finally{n(!1)}};return{role:e,loading:r,isAdmin:e==="admin",isViewer:e==="viewer",refetch:s}}function xb(){const[e,t]=w.useState(""),[r,n]=w.useState(""),[s,i]=w.useState(!1),[l,o]=w.useState(null),u=async c=>{c.preventDefault(),i(!0),o(null);try{const{error:h}=await H.auth.signInWithPassword({email:e,password:r});if(h)throw h}catch(h){o(h.message||"An error occurred")}finally{i(!1)}};return a.jsx("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-950 flex items-center justify-center p-4 transition-colors",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-xl shadow-lg border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:[a.jsxs("div",{className:"bg-brand-600 p-8 text-white text-center",children:[a.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-white/20 backdrop-blur-sm rounded-lg mx-auto mb-4",children:a.jsx(ar,{size:24})}),a.jsx("h1",{className:"text-2xl font-semibold mb-2",children:"Welcome Back"}),a.jsx("p",{className:"text-white/80 text-sm",children:"Sign in to your URL tracking dashboard"})]}),a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:"mb-6 p-3 bg-brand-500/10 dark:bg-brand-500/20 border border-brand-500/30 dark:border-brand-500/40 rounded-lg flex items-start gap-3 text-brand-700 dark:text-brand-400 text-sm",children:[a.jsx(tb,{size:18,className:"flex-shrink-0 mt-0.5"}),a.jsx("p",{children:"User accounts are created by administrators. Contact your admin if you need access."})]}),l&&a.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 dark:bg-red-500/20 border border-red-500/30 dark:border-red-500/40 rounded-lg flex items-center gap-3 text-red-700 dark:text-red-400",children:[a.jsx(Ut,{size:19,className:"flex-shrink-0"}),a.jsx("span",{className:"text-sm font-medium",children:l})]}),a.jsxs("form",{onSubmit:u,className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(d0,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400",size:18}),a.jsx("input",{type:"email",value:e,onChange:c=>t(c.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-white placeholder-neutral-400 dark:placeholder-neutral-500 focus:ring-2 focus:ring-brand-500/50 focus:border-brand-500 dark:focus:border-brand-500 outline-none transition-all",placeholder:"you@example.com",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(nb,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400",size:18}),a.jsx("input",{type:"password",value:r,onChange:c=>n(c.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-white placeholder-neutral-400 dark:placeholder-neutral-500 focus:ring-2 focus:ring-brand-500/50 focus:border-brand-500 dark:focus:border-brand-500 outline-none transition-all",placeholder:"Enter your password",required:!0,minLength:6})]})]}),a.jsx("button",{type:"submit",disabled:s,className:"w-full bg-brand-600 text-white py-2.5 rounded-lg font-medium hover:bg-brand-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 mt-6",children:s?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),a.jsx("span",{children:"Signing in..."})]}):"Sign In"})]})]})]}),a.jsx("div",{className:"mt-6 text-center text-xs text-neutral-500 dark:text-neutral-400",children:a.jsx("p",{children:"Secure authentication powered by Supabase"})})]})})}function yb({offer:e,onClose:t,onSave:r}){var Nu,Su,Eu,Cu;const[n,s]=w.useState("settings"),[i,l]=w.useState({offer_name:(e==null?void 0:e.offer_name)||"",campaign_name:(e==null?void 0:e.campaign_name)||"",final_url:(e==null?void 0:e.final_url)||"",tracking_template:(e==null?void 0:e.tracking_template)||"",suffix_pattern:(e==null?void 0:e.suffix_pattern)||"",target_geo:(e==null?void 0:e.target_geo)||"",target_country:(e==null?void 0:e.target_country)||"",custom_referrer:(e==null?void 0:e.custom_referrer)||"",redirect_chain_step:(e==null?void 0:e.redirect_chain_step)||0,retry_limit:(e==null?void 0:e.retry_limit)??3,retry_delay_ms:(e==null?void 0:e.retry_delay_ms)??2e3,is_active:(e==null?void 0:e.is_active)??!0,tracking_urls:(e==null?void 0:e.tracking_urls)||[],tracking_url_rotation_mode:(e==null?void 0:e.tracking_url_rotation_mode)||"sequential",referrers:(e==null?void 0:e.referrers)||[],referrer_rotation_mode:(e==null?void 0:e.referrer_rotation_mode)||"sequential",param_filter:(e==null?void 0:e.param_filter)||[],param_filter_mode:(e==null?void 0:e.param_filter_mode)||"all",tracer_mode:(e==null?void 0:e.tracer_mode)||"auto",block_resources:(e==null?void 0:e.block_resources)??!0,extract_only:(e==null?void 0:e.extract_only)??!0,geo_pool:(e==null?void 0:e.geo_pool)||[],geo_strategy:(e==null?void 0:e.geo_strategy)||"weighted",geo_weights:(e==null?void 0:e.geo_weights)||{},provider_id:(e==null?void 0:e.provider_id)||null,device_distribution:(e==null?void 0:e.device_distribution)||[{deviceCategory:"mobile",weight:60},{deviceCategory:"desktop",weight:30},{deviceCategory:"tablet",weight:10}]}),[o,u]=w.useState(!1),[c,h]=w.useState(null),[d,f]=w.useState(i.tracking_urls||[]),[y,x]=w.useState(i.referrers||[]),[v,j]=w.useState(i.param_filter||[]),[g,m]=w.useState(""),[p,_]=w.useState(i.geo_pool||[]),[C,S]=w.useState(i.geo_strategy||"weighted"),[N,k]=w.useState(i.geo_weights||{}),[O,L]=w.useState(""),[W,le]=w.useState(i.device_distribution||[{deviceCategory:"mobile",weight:60},{deviceCategory:"desktop",weight:30},{deviceCategory:"tablet",weight:10}]),[ce,Pe]=w.useState(20),[kt,_t]=w.useState(6e4),[q,T]=w.useState(""),[E,P]=w.useState(!0),[U,B]=w.useState("http_only"),[D,me]=w.useState(!1),[K,we]=w.useState(null),[jt,pi]=w.useState(null),[mi,v0]=w.useState(!1),[bu,b0]=w.useState(new Set),[Be,gi]=w.useState(null),[wu,w0]=w.useState([]),[k0,ku]=w.useState(!0),[_0,j0]=w.useState(!1);w.useEffect(()=>{N0()},[]);const N0=async()=>{try{const{data:{session:b}}=await H.auth.getSession();if(!b){ku(!1);return}const{data:A,error:V}=await H.from("proxy_providers").select("id, name, provider_type, enabled").eq("user_id",b.user.id).order("priority",{ascending:!0});!V&&A&&w0(A);const{data:Y}=await H.from("settings").select("luna_proxy_host, luna_proxy_port, luna_proxy_username, luna_proxy_password").eq("user_id",b.user.id).maybeSingle();Y&&Y.luna_proxy_host&&j0(!0)}catch(b){console.error("Failed to fetch providers:",b)}finally{ku(!1)}};w.useEffect(()=>{l(b=>({...b,tracking_urls:d,referrers:y,param_filter:v,geo_pool:p,geo_strategy:C,geo_weights:N,device_distribution:W}))},[d,y,v,p,C,N,W]);const xi=async b=>{if(b.preventDefault(),u(!0),h(null),!i.offer_name.trim()){h("Offer name is required"),u(!1);return}if(!i.campaign_name.trim()){h("Campaign name is required"),u(!1);return}if(!i.final_url.trim()){h("Final URL is required"),u(!1);return}const A=W.reduce((V,Y)=>V+Y.weight,0);if(A!==100){h(`Device distribution must total 100% (currently ${A}%)`),u(!1);return}try{const{data:{user:V}}=await H.auth.getUser();if(!V)throw new Error("Not authenticated");const Y=Ee=>Ee.map(Ur=>({...Ur,enabled:Ur.enabled!==!1})),qe={...i,tracking_urls:Y(d),referrers:Y(y),param_filter:v,geo_pool:p,geo_strategy:C,geo_weights:N,device_distribution:W};if(e){const{error:Ee}=await H.from("offers").update(qe).eq("id",e.id);if(Ee)throw Ee}else{const{error:Ee}=await H.from("offers").insert([{...qe,user_id:V.id}]);if(Ee)throw Ee}r()}catch(V){h(V.message||"An error occurred")}finally{u(!1)}},S0=()=>{f([...d,{url:"",weight:50,enabled:!0,label:""}])},Os=(b,A,V)=>{const Y=[...d];Y[b]={...Y[b],[A]:V},f(Y)},E0=b=>{f(d.filter((A,V)=>V!==b))},C0=()=>{x([...y,{url:"",weight:50,enabled:!0,label:""}])},Is=(b,A,V)=>{const Y=[...y];Y[b]={...Y[b],[A]:V},x(Y)},T0=b=>{x(y.filter((A,V)=>V!==b))},_u=()=>{g&&!v.includes(g)&&(j([...v,g]),m(""))},R0=b=>{j(v.filter(A=>A!==b))},A0=async()=>{if(!i.tracking_template&&!i.final_url){pi("Please provide a tracking template or final URL");return}me(!0),pi(null),we(null);try{const{data:{session:b}}=await H.auth.getSession();if(!b)throw new Error("Not authenticated");const A=d.filter(Mt=>Mt.enabled!==!1&&Mt.url);let V="";if(A.length>0)if(i.tracking_url_rotation_mode==="random"){const Mt=Math.floor(Math.random()*A.length);V=A[Mt].url}else if(i.tracking_url_rotation_mode==="weighted-random"){const Mt=A.reduce((Ls,U0)=>Ls+(U0.weight||1),0);let Tu=Math.random()*Mt;for(const Ls of A)if(Tu-=Ls.weight||1,Tu<=0){V=Ls.url;break}V||(V=A[0].url)}else V=A[0].url;const Y=V||i.tracking_template||i.final_url,Ee=await fetch("https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/trace-redirects",{method:"POST",headers:{Authorization:`Bearer ${b.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({url:Y,max_redirects:ce,timeout_ms:kt,user_agent:q||void 0,use_proxy:E,target_country:i.target_geo||null,tracer_mode:U,expected_final_url:i.final_url||void 0,geo_pool:p.length>0?p:void 0,geo_strategy:p.length>0?C:void 0,geo_weights:p.length>0&&C==="weighted"?N:void 0})});if(!Ee.ok){const Mt=await Ee.text();throw new Error(`API request failed: ${Ee.statusText} - ${Mt}`)}const Ur=await Ee.json();if(!Ur.success)throw new Error(Ur.error||"Trace failed");we(Ur)}catch(b){pi(b.message||"Failed to execute trace")}finally{me(!1)}},P0=async()=>{if(Be===null){alert("Please select a step first");return}if(!e){l({...i,redirect_chain_step:Be}),alert("Step configuration updated! Save the offer in Settings tab to persist changes."),gi(null);return}u(!0),h(null);try{const{error:b}=await H.from("offers").update({redirect_chain_step:Be}).eq("id",e.id);if(b)throw b;l({...i,redirect_chain_step:Be}),alert(`Configuration saved! Now using step ${Be+1} for parameter extraction.`),gi(null),r()}catch(b){h(b.message||"Failed to save configuration"),alert("Failed to save configuration: "+b.message)}finally{u(!1)}},O0=b=>{const A=new Set(bu);A.has(b)?A.delete(b):A.add(b),b0(A)},ju=b=>{navigator.clipboard.writeText(b)},I0=b=>b>=200&&b<300?"bg-green-100 text-green-700":b>=300&&b<400?"bg-blue-100 text-blue-700":b>=400&&b<500?"bg-orange-100 text-orange-700":b>=500?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700",L0=b=>{switch(b){case"http":return"bg-blue-100 text-blue-700";case"meta":return"bg-pink-100 text-pink-700";case"javascript":return"bg-yellow-100 text-yellow-700";case"final":return"bg-green-100 text-green-700";case"error":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col border border-neutral-200 dark:border-neutral-800",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-neutral-200 dark:border-neutral-800",children:[a.jsx("h2",{className:"text-xl font-bold text-neutral-900 dark:text-neutral-50",children:e?"Edit Offer":"Create New Offer"}),a.jsx("button",{onClick:t,className:"text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300 transition-smooth",children:a.jsx(Cr,{size:24})})]}),a.jsx("div",{className:"border-b border-neutral-200 dark:border-neutral-800",children:a.jsxs("div",{className:"flex overflow-x-auto bg-neutral-50 dark:bg-neutral-850",children:[a.jsx("button",{onClick:()=>s("settings"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-smooth whitespace-nowrap ${n==="settings"?"border-brand-600 dark:border-brand-500 text-brand-600 dark:text-brand-400":"border-transparent text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:"Settings"}),a.jsx("button",{onClick:()=>s("rotation"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-smooth whitespace-nowrap ${n==="rotation"?"border-brand-600 dark:border-brand-500 text-brand-600 dark:text-brand-400":"border-transparent text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:"URL & Referrer Rotation"}),a.jsx("button",{onClick:()=>s("parameters"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-smooth whitespace-nowrap ${n==="parameters"?"border-brand-600 dark:border-brand-500 text-brand-600 dark:text-brand-400":"border-transparent text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:"Parameter Filtering"}),a.jsx("button",{onClick:()=>s("tracer"),className:`px-6 py-3 font-medium text-sm border-b-2 transition-smooth whitespace-nowrap ${n==="tracer"?"border-brand-600 dark:border-brand-500 text-brand-600 dark:text-brand-400":"border-transparent text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:"Redirect Tracer"})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:n==="settings"?a.jsxs("form",{onSubmit:xi,className:"p-6 space-y-4",children:[c&&a.jsx("div",{className:"p-3 bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 rounded-lg text-error-700 dark:text-error-300 text-sm",children:c}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Offer Name"}),a.jsx("input",{type:"text",value:i.offer_name,onChange:b=>l({...i,offer_name:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Campaign Name *"}),a.jsx("input",{type:"text",value:i.campaign_name,onChange:b=>l({...i,campaign_name:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",placeholder:"e.g., Black Friday 2025, Spring Campaign",required:!0}),a.jsx("p",{className:"mt-1 text-sm text-neutral-500 dark:text-neutral-400",children:"Use this to group and identify related offers (searchable)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Final URL"}),a.jsx("input",{type:"url",value:i.final_url,onChange:b=>l({...i,final_url:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Legacy Tracking Template (fallback if no rotation URLs configured)"}),a.jsx("input",{type:"url",value:i.tracking_template,onChange:b=>l({...i,tracking_template:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",placeholder:"Optional"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Target Geo"}),a.jsx("input",{type:"text",value:i.target_geo,onChange:b=>l({...i,target_geo:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",placeholder:"e.g., US, UK"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Target Country for Proxy"}),a.jsx("input",{type:"text",value:i.target_country,onChange:b=>l({...i,target_country:b.target.value.toUpperCase()}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",placeholder:"e.g., US, GB, CA",maxLength:2}),a.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 mt-1",children:"2-letter country code for Luna proxy geo-targeting"})]})]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 space-y-4",children:[a.jsx("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-50 mb-3",children:"Geo Rotation (Per-Trace)"}),a.jsx("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mb-4",children:"Configure country-level proxy rotation for each trace. Leave empty to use single target_country."}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Geo Pool"}),a.jsxs("div",{className:"flex gap-2 mb-2",children:[a.jsx("input",{type:"text",value:O,onChange:b=>L(b.target.value.toUpperCase()),onKeyPress:b=>{if(b.key==="Enter"){b.preventDefault();const A=O.trim();A.length===2&&!p.includes(A)&&(_([...p,A]),C==="weighted"&&!N[A]&&k({...N,[A]:5}),L(""))}},className:"flex-1 px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none",placeholder:"2-letter code (US, FR, etc.)",maxLength:2}),a.jsxs("button",{type:"button",onClick:()=>{const b=O.trim();b.length===2&&!p.includes(b)&&(_([...p,b]),C==="weighted"&&!N[b]&&k({...N,[b]:5}),L(""))},className:"px-4 py-2 bg-brand-500 hover:bg-brand-600 text-white rounded-lg transition-smooth flex items-center gap-2",children:[a.jsx(jr,{size:16})," Add"]})]}),p.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(b=>a.jsxs("div",{className:"flex items-center gap-2 bg-neutral-100 dark:bg-neutral-800 px-3 py-1 rounded-lg",children:[a.jsx("span",{className:"text-sm font-medium",children:b}),a.jsx("button",{type:"button",onClick:()=>{_(p.filter(V=>V!==b));const A={...N};delete A[b],k(A)},className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200",children:a.jsx(Cr,{size:14})})]},b))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Rotation Strategy"}),a.jsxs("select",{value:C,onChange:b=>S(b.target.value),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none",children:[a.jsx("option",{value:"weighted",children:"Weighted"}),a.jsx("option",{value:"round_robin",children:"Round Robin"}),a.jsx("option",{value:"random",children:"Random"})]})]}),C==="weighted"&&p.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Weights"}),a.jsx("div",{className:"space-y-2",children:p.map(b=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-sm font-medium w-12",children:b}),a.jsx("input",{type:"number",value:N[b]||1,onChange:A=>k({...N,[b]:parseInt(A.target.value)||1}),min:"1",className:"flex-1 px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"})]},b))}),a.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 mt-2",children:"Higher weight = more frequent selection"})]})]}),a.jsxs("div",{className:"bg-info-50 dark:bg-info-900/20 border border-info-200 dark:border-info-800 rounded-lg p-4 space-y-4",children:[a.jsx("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-50 mb-3",children:"Device Distribution"}),a.jsx("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mb-4",children:"Configure the percentage distribution of device types for User Agent rotation. Total must equal 100%."}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Mobile %"}),a.jsx("input",{type:"number",value:((Nu=W.find(b=>b.deviceCategory==="mobile"))==null?void 0:Nu.weight)||60,onChange:b=>{const A=parseInt(b.target.value)||0;le(V=>V.map(Y=>Y.deviceCategory==="mobile"?{...Y,weight:A}:Y))},min:"0",max:"100",className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Desktop %"}),a.jsx("input",{type:"number",value:((Su=W.find(b=>b.deviceCategory==="desktop"))==null?void 0:Su.weight)||30,onChange:b=>{const A=parseInt(b.target.value)||0;le(V=>V.map(Y=>Y.deviceCategory==="desktop"?{...Y,weight:A}:Y))},min:"0",max:"100",className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Tablet %"}),a.jsx("input",{type:"number",value:((Eu=W.find(b=>b.deviceCategory==="tablet"))==null?void 0:Eu.weight)||10,onChange:b=>{const A=parseInt(b.target.value)||0;le(V=>V.map(Y=>Y.deviceCategory==="tablet"?{...Y,weight:A}:Y))},min:"0",max:"100",className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:["Total: ",W.reduce((b,A)=>b+A.weight,0),"%"]}),W.reduce((b,A)=>b+A.weight,0)!==100&&a.jsx("span",{className:"text-sm text-warning-600 dark:text-warning-400",children:"(Must equal 100%)"})]}),a.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:"Default: Mobile 60%, Desktop 30%, Tablet 10%. Adjust for campaign-specific targeting."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Redirect Chain Step"}),a.jsx("input",{type:"number",value:i.redirect_chain_step,onChange:b=>l({...i,redirect_chain_step:parseInt(b.target.value)||0}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",min:"0"}),a.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 mt-1",children:"Which step in the redirect chain to extract parameters from (0 = first step)"})]}),a.jsxs("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-lg p-4 space-y-4",children:[a.jsx("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-50 mb-3",children:"Retry Configuration"}),a.jsx("p",{className:"text-sm text-neutral-700 dark:text-neutral-300 mb-4",children:"Configure how many times to retry if trace/fetch fails"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Retry Limit"}),a.jsx("input",{type:"number",value:i.retry_limit,onChange:b=>l({...i,retry_limit:parseInt(b.target.value)||3}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",min:"0",max:"10"}),a.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 mt-1",children:"Number of retry attempts if trace fails (0-10)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Retry Delay (ms)"}),a.jsx("input",{type:"number",value:i.retry_delay_ms,onChange:b=>l({...i,retry_delay_ms:parseInt(b.target.value)||2e3}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",min:"500",max:"10000",step:"500"}),a.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 mt-1",children:"Delay between retries in milliseconds (500-10000ms)"})]})]})]}),a.jsxs("div",{className:"bg-brand-50 dark:bg-brand-900/20 border border-brand-200 dark:border-brand-800 rounded-lg p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-brand-600 dark:bg-brand-500 text-white rounded-full flex items-center justify-center font-bold",children:"AI"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-50 mb-1",children:"Intelligent Tracer System"}),a.jsx("p",{className:"text-sm text-neutral-700 dark:text-neutral-300",children:"Advanced redirect tracing with automatic detection"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Tracer Mode"}),a.jsxs("select",{value:i.tracer_mode,onChange:b=>l({...i,tracer_mode:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",children:[a.jsx("option",{value:"auto",children:"Auto (Intelligent Detection) - Recommended"}),a.jsx("option",{value:"http_only",children:"HTTP-Only (Fast, 2-5s)"}),a.jsx("option",{value:"browser",children:"Browser (Complex, 10-30s)"}),a.jsx("option",{value:"anti_cloaking",children:"Anti-Cloaking (Advanced, 15-60s)"}),a.jsx("option",{value:"interactive",children:"Interactive (Engagement, 20-40s)"}),a.jsx("option",{value:"brightdata_browser",children:"Bright Data Browser (Premium, 5-15s)"})]}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs text-neutral-600 dark:text-neutral-400",children:[a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-brand-700 dark:text-brand-400",children:"Auto:"}),a.jsx("span",{children:"Tries HTTP-only first, falls back to browser if needed. Best for most cases."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-success-700 dark:text-success-400",children:"HTTP-Only:"}),a.jsx("span",{children:"10-50x faster, 99% less bandwidth. Good for simple redirect chains."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-warning-700 dark:text-warning-400",children:"Browser:"}),a.jsx("span",{children:"Full JavaScript execution. Required for complex tracking (CPA networks, SPAs)."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-brand-700 dark:text-brand-400",children:"Anti-Cloaking:"}),a.jsx("span",{children:"Stealth mode with bot detection bypass, popup tracking, and obfuscation decoding."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-purple-700 dark:text-purple-400",children:"Interactive:"}),a.jsx("span",{children:"Anti-cloaking + realistic session engagement (scrolls, mouse moves, waits) on final URL for minimal bandwidth."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-indigo-700 dark:text-indigo-400",children:"Bright Data Browser:"}),a.jsx("span",{children:"Premium residential proxy with full browser automation. Auto-loads API key from settings, minimal bandwidth usage."})]})]})]}),i.tracer_mode==="browser"&&a.jsxs("div",{className:"space-y-3 pt-2 border-t border-brand-200 dark:border-brand-700",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",id:"block_resources",checked:i.block_resources,onChange:b=>l({...i,block_resources:b.target.checked}),className:"w-4 h-4 text-brand-600 border-neutral-300 dark:border-neutral-700 rounded focus:ring-brand-500"}),a.jsx("label",{htmlFor:"block_resources",className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Block Resources (images, CSS, fonts) for faster tracing"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",id:"extract_only",checked:i.extract_only,onChange:b=>l({...i,extract_only:b.target.checked}),className:"w-4 h-4 text-brand-600 border-neutral-300 dark:border-neutral-700 rounded focus:ring-brand-500"}),a.jsx("label",{htmlFor:"extract_only",className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Extract Only (skip full page rendering)"})]})]}),((Cu=e==null?void 0:e.tracer_detection_result)==null?void 0:Cu.mode_used)&&a.jsxs("div",{className:"mt-3 p-3 bg-white dark:bg-neutral-850 rounded-lg border border-brand-300 dark:border-brand-700",children:[a.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-neutral-200 mb-1",children:"Last Auto-Detection Result:"}),a.jsxs("div",{className:"text-xs text-neutral-600 dark:text-neutral-400 space-y-1",children:[a.jsxs("p",{children:["Mode Used: ",a.jsx("span",{className:"font-semibold text-neutral-900 dark:text-neutral-50",children:e.tracer_detection_result.mode_used})]}),a.jsxs("p",{children:["Reason: ",a.jsx("span",{className:"text-neutral-700 dark:text-neutral-300",children:e.tracer_detection_result.detection_reason})]}),a.jsxs("p",{children:["Timing: ",a.jsxs("span",{className:"text-neutral-700 dark:text-neutral-300",children:[e.tracer_detection_result.timing_ms,"ms"]})]}),a.jsxs("p",{children:["Bandwidth: ",a.jsxs("span",{className:"text-neutral-700 dark:text-neutral-300",children:[e.tracer_detection_result.bandwidth_kb," KB"]})]})]})]})]}),a.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4 space-y-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-purple-600 dark:bg-purple-500 text-white rounded-full flex items-center justify-center font-bold",children:""}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-50 mb-1",children:"Provider Override"}),a.jsx("p",{className:"text-sm text-neutral-700 dark:text-neutral-300",children:"Select a specific provider for this offer (overrides default rotation)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Proxy Provider"}),k0?a.jsx("div",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"Loading providers..."}):a.jsxs("select",{value:i.provider_id||"",onChange:b=>l({...i,provider_id:b.target.value||null}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-purple-500/20 dark:focus:ring-purple-400/20 focus:border-purple-500 dark:focus:border-purple-400 outline-none transition-smooth",children:[_0?a.jsx("option",{value:"",children:"Luna Proxy (from Settings) - Default"}):a.jsx("option",{value:"",children:"No Default Provider Configured"}),wu.filter(b=>b.enabled).length>0&&a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"USE_ROTATION",children:" Use Provider Rotation"}),a.jsx("optgroup",{label:"Specific Providers",children:wu.filter(b=>b.enabled).map(b=>a.jsxs("option",{value:b.id,children:[b.name," (",b.provider_type,")"]},b.id))})]})]}),a.jsx("p",{className:"mt-2 text-xs text-neutral-600 dark:text-neutral-400",children:i.provider_id?i.provider_id==="USE_ROTATION"?" Rotating between all enabled providers":" Using selected provider exclusively (no rotation)":" Using Luna from Settings (default, single provider)"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Legacy Custom Referrer (fallback if no rotation referrers configured)"}),a.jsx("input",{type:"text",value:i.custom_referrer,onChange:b=>l({...i,custom_referrer:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",placeholder:"Optional"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",id:"is_active",checked:i.is_active,onChange:b=>l({...i,is_active:b.target.checked}),className:"w-4 h-4 text-brand-600 border-neutral-300 dark:border-neutral-700 rounded focus:ring-brand-500"}),a.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Active"})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t border-neutral-200 dark:border-neutral-800",children:[a.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-neutral-300 dark:border-neutral-700 text-neutral-700 dark:text-neutral-300 rounded-lg hover:bg-neutral-50 dark:hover:bg-neutral-850 transition-smooth font-medium",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-2 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed transition-smooth font-medium flex items-center justify-center gap-2",children:[a.jsx(Nr,{size:18}),o?"Saving...":"Save Offer"]})]})]}):n==="rotation"?a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"bg-brand-50 dark:bg-brand-900/20 border border-brand-200 dark:border-brand-800 rounded-lg p-4",children:a.jsx("p",{className:"text-sm text-brand-900 dark:text-brand-300",children:"Configure multiple tracking URLs and referrers with weighted rotation. URLs and referrers will be selected based on the rotation mode you choose."})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"Tracking URLs"}),a.jsxs("button",{type:"button",onClick:S0,className:"flex items-center gap-2 px-4 py-2 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 transition-smooth text-sm font-medium",children:[a.jsx(jr,{size:16}),"Add URL"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Rotation Mode"}),a.jsxs("select",{value:i.tracking_url_rotation_mode,onChange:b=>l({...i,tracking_url_rotation_mode:b.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",children:[a.jsx("option",{value:"sequential",children:"Sequential (rotates in order)"}),a.jsx("option",{value:"random",children:"Random (picks randomly)"}),a.jsx("option",{value:"weighted-random",children:"Weighted Random (probability based on weights)"})]})]}),a.jsxs("div",{className:"space-y-3",children:[d.map((b,A)=>a.jsx("div",{className:"bg-gray-50 dark:bg-dark-elevated p-4 rounded-lg border border-gray-200 dark:border-dark-border",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3",children:[a.jsxs("div",{className:"col-span-5",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-dark-text-secondary mb-1",children:"URL"}),a.jsx("input",{type:"url",value:b.url,onChange:V=>Os(A,"url",V.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-border rounded-lg bg-white dark:bg-dark-surface text-gray-900 dark:text-dark-text-primary text-sm",placeholder:"https://tracker.com/click?id=123"})]}),a.jsxs("div",{className:"col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-dark-text-secondary mb-1",children:"Label"}),a.jsx("input",{type:"text",value:b.label,onChange:V=>Os(A,"label",V.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-border rounded-lg bg-white dark:bg-dark-surface text-gray-900 dark:text-dark-text-primary text-sm",placeholder:"Primary Tracker"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 dark:text-dark-text-secondary mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:b.weight,onChange:V=>Os(A,"weight",parseInt(V.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 dark:border-dark-border rounded-lg bg-white dark:bg-dark-surface text-gray-900 dark:text-dark-text-primary text-sm",min:"1",max:"100"})]}),a.jsxs("div",{className:"col-span-2 flex items-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>Os(A,"enabled",!b.enabled),className:"flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center gap-1",title:b.enabled?"Enabled":"Disabled",children:b.enabled?a.jsx(bd,{size:20,className:"text-green-600"}):a.jsx(vd,{size:20,className:"text-gray-400"})}),a.jsx("button",{type:"button",onClick:()=>E0(A),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",children:a.jsx(Ss,{size:16})})]})]})},A)),d.length===0&&a.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No tracking URLs configured. Legacy tracking_template will be used as fallback."})]})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Referrers"}),a.jsxs("button",{type:"button",onClick:C0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[a.jsx(jr,{size:16}),"Add Referrer"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Referrer Rotation Mode"}),a.jsxs("select",{value:i.referrer_rotation_mode,onChange:b=>l({...i,referrer_rotation_mode:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"sequential",children:"Sequential (rotates in order)"}),a.jsx("option",{value:"random",children:"Random (picks randomly)"}),a.jsx("option",{value:"weighted-random",children:"Weighted Random (probability based on weights)"})]})]}),a.jsxs("div",{className:"space-y-3",children:[y.map((b,A)=>a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3",children:[a.jsxs("div",{className:"col-span-5",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Referrer URL"}),a.jsx("input",{type:"url",value:b.url,onChange:V=>Is(A,"url",V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"https://example.com/landing"})]}),a.jsxs("div",{className:"col-span-3",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Label"}),a.jsx("input",{type:"text",value:b.label,onChange:V=>Is(A,"label",V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Landing Page 1"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Weight"}),a.jsx("input",{type:"number",value:b.weight,onChange:V=>Is(A,"weight",parseInt(V.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",min:"1",max:"100"})]}),a.jsxs("div",{className:"col-span-2 flex items-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>Is(A,"enabled",!b.enabled),className:"flex-1 px-3 py-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center gap-1",title:b.enabled?"Enabled":"Disabled",children:b.enabled?a.jsx(bd,{size:20,className:"text-green-600"}):a.jsx(vd,{size:20,className:"text-gray-400"})}),a.jsx("button",{type:"button",onClick:()=>T0(A),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",children:a.jsx(Ss,{size:16})})]})]})},A)),y.length===0&&a.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No referrers configured. Legacy custom_referrer will be used as fallback."})]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),a.jsxs("button",{type:"button",onClick:xi,disabled:o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2",children:[a.jsx(Nr,{size:18}),o?"Saving...":"Save Rotation Config"]})]})]}):n==="parameters"?a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:a.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-300",children:"Control which parameters are included in the final suffix sent to Google. Use whitelist to only include specific parameters, or blacklist to exclude specific ones."})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text-secondary mb-2",children:"Filter Mode"}),a.jsxs("select",{value:i.param_filter_mode,onChange:b=>l({...i,param_filter_mode:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-border rounded-lg bg-white dark:bg-dark-elevated text-gray-900 dark:text-dark-text-primary focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"All Parameters (no filtering)"}),a.jsx("option",{value:"whitelist",children:"Whitelist (only include listed parameters)"}),a.jsx("option",{value:"blacklist",children:"Blacklist (exclude listed parameters)"})]})]}),i.param_filter_mode!=="all"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text-secondary mb-2",children:"Parameter Names"}),a.jsxs("div",{className:"flex gap-2 mb-3",children:[a.jsx("input",{type:"text",value:g,onChange:b=>m(b.target.value),onKeyPress:b=>b.key==="Enter"&&(b.preventDefault(),_u()),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-dark-border rounded-lg bg-white dark:bg-dark-elevated text-gray-900 dark:text-dark-text-primary focus:ring-2 focus:ring-blue-500",placeholder:"e.g., gclid, fbclid, utm_source"}),a.jsx("button",{type:"button",onClick:_u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:a.jsx(jr,{size:18})})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[v.map(b=>a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-dark-elevated text-gray-700 dark:text-dark-text-primary rounded-lg border border-gray-300 dark:border-dark-border",children:[a.jsx("span",{className:"text-sm font-medium",children:b}),a.jsx("button",{type:"button",onClick:()=>R0(b),className:"text-gray-500 dark:text-dark-text-secondary hover:text-red-600 dark:hover:text-red-400",children:a.jsx(Cr,{size:14})})]},b)),v.length===0&&a.jsxs("p",{className:"text-sm text-gray-500 dark:text-dark-text-muted py-2",children:["No parameters in ",i.param_filter_mode," yet. Add parameter names above."]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),a.jsxs("button",{type:"button",onClick:xi,disabled:o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2",children:[a.jsx(Nr,{size:18}),o?"Saving...":"Save Parameter Config"]})]})]}):a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:a.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-300",children:"Test your tracking template and configure which redirect step to extract parameters from. Global proxy settings from the Settings page will be used automatically. Make sure to save the offer after configuring the redirect chain step."})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-dark-text-secondary",children:"Tracer Method"}),a.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[a.jsx("button",{type:"button",onClick:()=>B("http_only"),className:`px-3 py-2.5 rounded-lg font-medium transition-all border-2 text-sm ${U==="http_only"?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-dark-surface text-gray-700 dark:text-dark-text-primary border-gray-300 dark:border-dark-border hover:border-blue-400"}`,children:"HTTP-Only"}),a.jsx("button",{type:"button",onClick:()=>B("browser"),className:`px-3 py-2.5 rounded-lg font-medium transition-all border-2 text-sm ${U==="browser"?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-dark-surface text-gray-700 dark:text-dark-text-primary border-gray-300 dark:border-dark-border hover:border-blue-400"}`,children:"Browser"}),a.jsx("button",{type:"button",onClick:()=>B("anti_cloaking"),className:`px-3 py-2.5 rounded-lg font-medium transition-all border-2 text-sm ${U==="anti_cloaking"?"bg-orange-600 text-white border-orange-600":"bg-white dark:bg-dark-surface text-gray-700 dark:text-dark-text-primary border-gray-300 dark:border-dark-border hover:border-orange-400"}`,children:" Anti-Cloak"}),a.jsx("button",{type:"button",onClick:()=>B("interactive"),className:`px-3 py-2.5 rounded-lg font-medium transition-all border-2 text-sm ${U==="interactive"?"bg-purple-600 text-white border-purple-600":"bg-white dark:bg-dark-surface text-gray-700 dark:text-dark-text-primary border-gray-300 dark:border-dark-border hover:border-purple-400"}`,children:" Interactive"}),a.jsx("button",{type:"button",onClick:()=>B("brightdata_browser"),className:`px-3 py-2.5 rounded-lg font-medium transition-all border-2 text-sm ${U==="brightdata_browser"?"bg-indigo-600 text-white border-indigo-600":"bg-white dark:bg-dark-surface text-gray-700 dark:text-dark-text-primary border-gray-300 dark:border-dark-border hover:border-indigo-400"}`,children:" Bright Data"})]}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-dark-text-muted mt-2",children:[U==="http_only"&&" Fast HTTP requests only - No JS execution",U==="browser"&&" Full browser rendering with JS execution & popup tracking",U==="anti_cloaking"&&" Multi-engine: HTTP + Meta + JS + Form detection with proper headers",U==="interactive"&&" Anti-cloaking + realistic session engagement (scrolls, mouse, waits)",U==="brightdata_browser"&&" Premium residential proxy with browser automation - minimal bandwidth"]})]}),a.jsxs("button",{type:"button",onClick:()=>v0(!mi),className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900",children:[mi?a.jsx(Va,{size:16}):a.jsx(Ns,{size:16}),"Advanced Settings"]}),mi&&a.jsxs("div",{className:"space-y-4 pt-2",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Redirects"}),a.jsx("input",{type:"number",value:ce,onChange:b=>Pe(parseInt(b.target.value)),min:"1",max:"50",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timeout (ms)"}),a.jsx("input",{type:"number",value:kt,onChange:b=>_t(parseInt(b.target.value)),min:"5000",max:"60000",step:"1000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"User Agent (Optional)"}),a.jsx("input",{type:"text",value:q,onChange:b=>T(b.target.value),placeholder:"Default Chrome UA",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",id:"use_proxy",checked:E,onChange:b=>P(b.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),a.jsx("label",{htmlFor:"use_proxy",className:"text-sm font-medium text-gray-700",children:"Use Proxy Settings (from Settings page)"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"button",onClick:A0,disabled:D,className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed font-medium",children:D?a.jsxs(a.Fragment,{children:[a.jsx(vu,{size:18,className:"animate-spin"}),"Tracing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(co,{size:18}),"Execute Trace"]})}),K&&a.jsxs("button",{type:"button",onClick:P0,disabled:Be===null,className:"flex items-center gap-2 px-6 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:bg-gray-400 disabled:cursor-not-allowed",children:[a.jsx(Nr,{size:18}),Be!==null?`Use Step ${Be+1}`:"Select a Step First"]})]})]}),jt&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[a.jsx(Ut,{className:"text-red-600 flex-shrink-0",size:20}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-red-900",children:"Trace Error"}),a.jsx("p",{className:"text-red-700 text-sm mt-1",children:jt})]})]}),K&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h4",{className:"font-semibold text-gray-900",children:"Trace Results"}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fi,{size:16,className:"text-gray-400"}),a.jsxs("span",{className:"text-gray-600",children:[K.total_timing_ms,"ms"]})]}),a.jsxs("span",{className:"text-gray-600",children:[K.total_steps," steps"]}),K.bandwidth_bytes&&a.jsxs("span",{className:"text-gray-600 text-xs font-medium",children:[" ",K.bandwidth_bytes.toLocaleString()," B"]}),K.selected_geo&&a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-semibold",children:[" ",K.selected_geo.toUpperCase()]}),K.total_popups>0&&a.jsxs("span",{className:"text-green-600 font-semibold",children:[K.total_popups," popups"]})]})]}),K.user_agent&&a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3",children:[a.jsx("div",{className:"text-xs font-semibold text-gray-600 mb-2",children:"User Agent (full)"}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("code",{className:"flex-1 bg-gray-50 rounded px-3 py-2 text-xs font-mono text-gray-900 break-all",children:K.user_agent}),a.jsx("button",{type:"button",onClick:()=>ju(K.user_agent||""),className:"p-2 text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:14})})]})]}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:K.chain.map((b,A)=>{const V=bu.has(A),Y=i.redirect_chain_step===A;return a.jsxs("div",{className:`border-2 rounded-lg transition-all ${Be===A?"border-green-500 bg-green-50":Y?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"}`,children:[a.jsx("button",{type:"button",onClick:()=>O0(A),className:"w-full p-4 text-left",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsxs("span",{className:"font-semibold text-gray-900",children:["Step ",A+1]}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${I0(b.status)}`,children:b.status||"N/A"}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${L0(b.redirect_type)}`,children:b.redirect_type}),Be===A&&a.jsx("span",{className:"px-2 py-1 bg-green-600 text-white text-xs font-medium rounded",children:"SELECTED"}),Y&&a.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs font-medium rounded",children:"SAVED"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx(c0,{size:14,className:"text-gray-400 flex-shrink-0"}),a.jsx("span",{className:"text-gray-700 truncate font-mono text-xs",children:b.url}),a.jsx("button",{type:"button",onClick:qe=>{qe.stopPropagation(),ju(b.url)},className:"p-1 text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:12})})]}),b.error&&a.jsxs("div",{className:"mt-2 text-xs text-red-600 flex items-start gap-1",children:[a.jsx(Ut,{size:12,className:"mt-0.5 flex-shrink-0"}),a.jsx("span",{children:b.error})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:qe=>{qe.stopPropagation(),gi(Be===A?null:A)},className:`px-3 py-1.5 text-xs font-medium rounded transition-colors ${Be===A?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:Be===A?"Selected":"Select"}),V?a.jsx(Va,{size:20,className:"text-gray-400"}):a.jsx(Ns,{size:20,className:"text-gray-400"})]})]})}),V&&a.jsxs("div",{className:"px-4 pb-4 space-y-3 border-t border-gray-200",children:[b.error&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3",children:[a.jsx("p",{className:"text-sm font-semibold text-red-900 mb-1",children:"Error"}),a.jsx("p",{className:"text-sm text-red-700",children:b.error})]}),b.params&&Object.keys(b.params).length>0&&a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:["Parameters (",Object.keys(b.params).length,")"]}),a.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-1 max-h-40 overflow-y-auto",children:Object.entries(b.params).map(([qe,Ee])=>a.jsxs("div",{className:"flex gap-3 text-xs font-mono",children:[a.jsxs("span",{className:"font-semibold text-gray-700 min-w-[120px]",children:[qe,":"]}),a.jsx("span",{className:"text-gray-900 break-all",children:Ee})]},qe))})]}),b.headers&&Object.keys(b.headers).length>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Headers"}),a.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-1 max-h-40 overflow-y-auto",children:Object.entries(b.headers).slice(0,5).map(([qe,Ee])=>a.jsxs("div",{className:"flex gap-3 text-xs font-mono",children:[a.jsxs("span",{className:"font-semibold text-gray-700 min-w-[120px]",children:[qe,":"]}),a.jsx("span",{className:"text-gray-900 break-all truncate",children:Ee})]},qe))})]})]}),A<K.chain.length-1&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(u0,{size:20,className:"text-blue-500 transform rotate-90"})})]},A)})}),K.popup_chains&&K.popup_chains.length>0&&a.jsxs("div",{className:"p-4 bg-green-50 border-2 border-green-200 rounded-lg",children:[a.jsx("h5",{className:"font-semibold text-green-800 mb-3 flex items-center gap-2",children:a.jsxs("span",{children:[" Popup Windows Detected (",K.popup_chains.length,")"]})}),a.jsx("div",{className:"space-y-3",children:K.popup_chains.map((b,A)=>a.jsx("div",{className:"bg-white p-3 rounded border border-green-300",children:a.jsxs("div",{className:"text-sm space-y-1",children:[a.jsxs("div",{className:"font-medium text-gray-900",children:["Popup #",b.popup_index]}),a.jsxs("div",{className:"text-xs text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Opened from:"}),a.jsx("p",{className:"font-mono mt-1 break-all",children:b.opener_url})]}),a.jsxs("div",{className:"text-xs text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Popup URL:"}),a.jsx("p",{className:"font-mono mt-1 break-all text-green-700",children:b.final_url})]})]})},A))})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[K.chain[K.chain.length-1].redirect_type==="final"?a.jsx(He,{className:"text-green-600",size:20}):a.jsx(ho,{className:"text-red-600",size:20}),a.jsx("span",{className:"font-semibold text-gray-900",children:"Final Destination:"})]}),a.jsx("code",{className:"block bg-white px-3 py-2 rounded text-sm font-mono text-gray-900 break-all",children:K.final_url})]})]})]})})]})})}function x0({value:e,onChange:t,placeholder:r="Search...",className:n=""}){return a.jsxs("div",{className:`relative group ${n}`,children:[a.jsx(f0,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400 dark:text-neutral-500 transition-colors group-focus-within:text-brand-500 dark:group-focus-within:text-brand-400",size:16}),a.jsx("input",{type:"text",value:e,onChange:s=>t(s.target.value),className:"w-full pl-9 pr-9 py-2 border border-neutral-200 dark:border-neutral-800 rounded-lg bg-white dark:bg-neutral-900 text-neutral-900 dark:text-neutral-50 placeholder-neutral-400 dark:placeholder-neutral-500 text-sm focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth hover:border-neutral-300 dark:hover:border-neutral-700",placeholder:r}),e&&a.jsx("button",{onClick:()=>t(""),className:"absolute right-2.5 top-1/2 -translate-y-1/2 p-0.5 text-neutral-400 dark:text-neutral-500 hover:text-neutral-600 dark:hover:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded transition-smooth","aria-label":"Clear search",children:a.jsx(Cr,{size:14})})]})}function fo({label:e,options:t,value:r,onChange:n}){const[s,i]=w.useState(!1),l=w.useRef(null);w.useEffect(()=>{function u(c){l.current&&!l.current.contains(c.target)&&i(!1)}return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]);const o=t.find(u=>u.value===r);return a.jsxs("div",{className:"relative",ref:l,children:[a.jsxs("button",{onClick:()=>i(!s),className:"flex items-center gap-2 px-3 py-2 border border-neutral-200 dark:border-neutral-800 rounded-lg bg-white dark:bg-neutral-900 text-neutral-700 dark:text-neutral-300 hover:bg-neutral-50 dark:hover:bg-neutral-850 hover:border-neutral-300 dark:hover:border-neutral-700 transition-smooth text-sm",children:[a.jsxs("span",{className:"font-medium text-xs",children:[e,":"]}),a.jsx("span",{className:"text-xs",children:(o==null?void 0:o.label)||"All"}),a.jsx(Ns,{size:14,className:`transition-smooth ml-auto ${s?"rotate-180":""}`})]}),s&&a.jsx("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white/95 dark:bg-neutral-900/95 backdrop-blur-xl border border-neutral-200 dark:border-neutral-800 rounded-lg shadow-lg z-50 max-h-64 overflow-y-auto animate-slide-down",children:t.map((u,c)=>a.jsxs("button",{onClick:()=>{n(u.value),i(!1)},style:{animationDelay:`${c*30}ms`},className:"w-full flex items-center justify-between px-3 py-2 text-left text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-smooth first:rounded-t-lg last:rounded-b-lg",children:[a.jsx("span",{className:"text-xs",children:u.label}),r===u.value&&a.jsx(Qv,{size:14,className:"text-brand-600 dark:text-brand-400"})]},u.value))})]})}function y0({currentPage:e,totalPages:t,onPageChange:r,itemsPerPage:n,onItemsPerPageChange:s,totalItems:i}){const l=(e-1)*n+1,o=Math.min(e*n,i),u=()=>{const c=[];if(t>7)if(e<=4){for(let d=1;d<=5;d++)c.push(d);c.push("..."),c.push(t)}else if(e>=t-3){c.push(1),c.push("...");for(let d=t-4;d<=t;d++)c.push(d)}else{c.push(1),c.push("...");for(let d=e-1;d<=e+1;d++)c.push(d);c.push("..."),c.push(t)}else for(let d=1;d<=t;d++)c.push(d);return c};return a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 bg-white dark:bg-dark-surface border-t border-gray-200 dark:border-dark-border rounded-b-lg",children:[a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-dark-text-secondary",children:[a.jsxs("div",{children:["Showing ",l," to ",o," of ",i," results"]}),a.jsxs("select",{value:n,onChange:c=>s(Number(c.target.value)),className:"px-2 py-1 border border-gray-300 dark:border-dark-border rounded bg-white dark:bg-dark-elevated text-gray-900 dark:text-dark-text-primary text-sm outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:10,children:"10 per page"}),a.jsx("option",{value:25,children:"25 per page"}),a.jsx("option",{value:50,children:"50 per page"}),a.jsx("option",{value:100,children:"100 per page"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>r(e-1),disabled:e===1,className:"p-2 rounded-lg border border-gray-300 dark:border-dark-border bg-white dark:bg-dark-elevated text-gray-600 dark:text-dark-text-secondary hover:bg-gray-50 dark:hover:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a.jsx(Xv,{size:18})}),a.jsx("div",{className:"flex gap-1",children:u().map((c,h)=>a.jsx("button",{onClick:()=>typeof c=="number"&&r(c),disabled:c==="...",className:`min-w-[40px] px-3 py-2 rounded-lg text-sm font-medium transition-colors ${c===e?"bg-blue-600 text-white":c==="..."?"text-gray-400 dark:text-gray-500 cursor-default":"border border-gray-300 dark:border-dark-border bg-white dark:bg-dark-elevated text-gray-600 dark:text-dark-text-secondary hover:bg-gray-50 dark:hover:bg-dark-border"}`,children:c},h))}),a.jsx("button",{onClick:()=>r(e+1),disabled:e===t,className:"p-2 rounded-lg border border-gray-300 dark:border-dark-border bg-white dark:bg-dark-elevated text-gray-600 dark:text-dark-text-secondary hover:bg-gray-50 dark:hover:bg-dark-border disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a.jsx(Zv,{size:18})})]})]})}function vb(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(!1),[l,o]=w.useState(),[u,c]=w.useState(null),[h,d]=w.useState(new Set),[f,y]=w.useState(""),[x,v]=w.useState("all"),[j,g]=w.useState(1),[m,p]=w.useState(25);w.useEffect(()=>{_()},[]);const _=async()=>{n(!0);const{data:E,error:P}=await H.from("offers").select("*").order("created_at",{ascending:!1});!P&&E&&t(E),n(!1)},C=async E=>{if(!confirm("Are you sure you want to delete this offer?"))return;const{error:P}=await H.from("offers").delete().eq("id",E);P||_()},S=E=>{o(E),i(!0)},N=()=>{i(!1),o(void 0)},k=()=>{_(),N()},O=E=>`https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/get-suffix?offer_name=${encodeURIComponent(E)}`,L=async(E,P)=>{await navigator.clipboard.writeText(P),c(E),setTimeout(()=>c(null),2e3)},W=E=>{const P=new Set(h);P.has(E)?P.delete(E):P.add(E),d(P)},le=E=>E?new Date(E).toLocaleString():"Never",ce=e.filter(E=>{const P=f.toLowerCase(),U=E.offer_name.toLowerCase().includes(P)||E.final_url.toLowerCase().includes(P)||(E.campaign_name||"").toLowerCase().includes(P),B=x==="all"||x==="active"&&E.is_active||x==="inactive"&&!E.is_active;return U&&B}),Pe=Math.ceil(ce.length/m),kt=(j-1)*m,_t=kt+m,q=ce.slice(kt,_t);w.useEffect(()=>{g(1)},[f,x]);const T=[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}];return r?a.jsx("div",{className:"text-center py-12 text-neutral-500 dark:text-neutral-400",children:"Loading offers..."}):a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-neutral-900 dark:text-neutral-50",children:"Your Offers"}),a.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400 mt-0.5",children:"Manage your URL tracking offers"})]}),a.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-md hover:bg-brand-700 transition-smooth font-medium text-sm h-9",children:[a.jsx(jr,{size:18}),"New Offer"]})]}),e.length>0&&a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx(x0,{value:f,onChange:y,placeholder:"Search offers by name or URL...",className:"flex-1"}),a.jsx(fo,{label:"Status",options:T,value:x,onChange:v})]}),e.length>0&&a.jsxs("div",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:["Showing ",a.jsx("span",{className:"font-medium text-neutral-900 dark:text-neutral-50",children:ce.length})," of"," ",a.jsx("span",{className:"font-medium text-neutral-900 dark:text-neutral-50",children:e.length})," offers"]}),e.length===0?a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-800 p-12 text-center",children:[a.jsx(ar,{className:"mx-auto text-neutral-400 dark:text-neutral-600 mb-4",size:40}),a.jsx("h3",{className:"text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-1.5",children:"No offers yet"}),a.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400 mb-5",children:"Create your first offer to start tracking URLs"}),a.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-md hover:bg-brand-700 transition-smooth font-medium text-sm h-9",children:[a.jsx(jr,{size:18}),"Create First Offer"]})]}):ce.length===0?a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-800 p-12 text-center",children:[a.jsx(ar,{className:"mx-auto text-neutral-400 dark:text-neutral-600 mb-4",size:40}),a.jsx("h3",{className:"text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-1.5",children:"No offers found"}),a.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400 mb-5",children:"No offers match your current filters. Try adjusting your search or filters."}),a.jsx("button",{onClick:()=>{y(""),v("all")},className:"inline-flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-md hover:bg-brand-700 transition-smooth font-medium text-sm h-9",children:"Clear Filters"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid gap-4",children:q.map(E=>{const P=O(E.offer_name);return a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-800 p-5 hover:border-neutral-300 dark:hover:border-neutral-700 transition-smooth shadow-xs dark:shadow-none",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2.5 mb-1.5",children:[a.jsx("h3",{className:"text-base font-semibold text-neutral-900 dark:text-neutral-50 truncate",children:E.offer_name}),E.is_active?a.jsx("span",{className:"px-2 py-0.5 bg-success-100 text-success-700 dark:bg-success-500/20 dark:text-success-400 text-xs font-medium rounded-md flex-shrink-0",children:"Active"}):a.jsx("span",{className:"px-2 py-0.5 bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 text-xs font-medium rounded-md flex-shrink-0",children:"Inactive"})]}),E.campaign_name&&a.jsx("div",{className:"mb-2",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 border border-purple-200 dark:border-purple-800/50",children:[" ",E.campaign_name]})}),a.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-neutral-500 dark:text-neutral-400",children:[a.jsx(c0,{size:12}),a.jsx("a",{href:E.final_url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-brand-600 dark:hover:text-brand-400 truncate transition-colors",children:E.final_url})]})]}),a.jsxs("div",{className:"flex gap-1 flex-shrink-0 ml-3",children:[a.jsx("button",{onClick:()=>S(E),className:"p-1.5 text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-md transition-smooth",children:a.jsx(cb,{size:16})}),a.jsx("button",{onClick:()=>C(E.id),className:"p-1.5 text-neutral-500 hover:text-error-600 dark:text-neutral-400 dark:hover:text-error-400 hover:bg-error-50 dark:hover:bg-error-500/10 rounded-md transition-smooth",children:a.jsx(Ss,{size:16})})]})]}),a.jsxs("div",{className:"space-y-2 text-xs",children:[E.tracking_template&&a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-neutral-500 dark:text-neutral-400 font-medium min-w-[120px] flex-shrink-0",children:"Tracking Template:"}),a.jsx("span",{className:"text-neutral-700 dark:text-neutral-300 truncate text-xs",children:E.tracking_template})]}),E.target_geo&&a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-neutral-500 dark:text-neutral-400 font-medium min-w-[120px] flex-shrink-0",children:"Target Geo:"}),a.jsx("span",{className:"text-neutral-700 dark:text-neutral-300 text-xs",children:E.target_geo})]}),a.jsxs("div",{className:"flex items-start gap-2 pt-2.5 border-t border-neutral-200 dark:border-neutral-800",children:[a.jsx("span",{className:"text-neutral-500 dark:text-neutral-400 font-medium min-w-[120px] flex-shrink-0",children:"API Endpoint:"}),a.jsxs("div",{className:"flex-1 flex items-center gap-2 min-w-0",children:[a.jsx("code",{className:"flex-1 bg-brand-50 dark:bg-brand-500/10 px-2 py-1 rounded text-brand-700 dark:text-brand-400 font-mono text-xs truncate",children:P}),a.jsx("button",{onClick:()=>L(E.id,P),className:"p-1 text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded transition-smooth flex-shrink-0",title:"Copy to clipboard",children:u===E.id?a.jsx(He,{size:14,className:"text-success-600 dark:text-success-400"}):a.jsx(yt,{size:14})})]})]}),E.tracking_template&&a.jsxs("div",{className:"mt-2.5 pt-2.5 border-t border-neutral-200 dark:border-neutral-800",children:[a.jsxs("button",{onClick:()=>W(E.id),className:"w-full flex items-center justify-between p-2 hover:bg-neutral-50 dark:hover:bg-neutral-850 rounded-md transition-smooth",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-neutral-600 dark:text-neutral-300 font-medium text-xs",children:"Redirect Chain Trace"}),E.last_trace_date&&a.jsxs("span",{className:"text-xs text-neutral-400 dark:text-neutral-500",children:["(Last traced: ",le(E.last_trace_date),")"]})]}),h.has(E.id)?a.jsx(Va,{size:14,className:"text-neutral-400 dark:text-neutral-500"}):a.jsx(Ns,{size:14,className:"text-neutral-400 dark:text-neutral-500"})]}),h.has(E.id)&&a.jsx("div",{className:"mt-2 bg-neutral-50 dark:bg-neutral-925 rounded-md p-3 animate-slide-down",children:!E.last_traced_chain||E.last_traced_chain.length===0?a.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 italic",children:"No trace data yet. Call the get-suffix API to trace the redirect chain."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-xs font-semibold text-neutral-700 dark:text-neutral-300",children:"Redirect Chain Steps:"}),a.jsxs("span",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:["(",E.last_traced_chain.length," ",E.last_traced_chain.length===1?"step":"steps",")"]})]}),E.last_traced_chain.map((U,B)=>a.jsxs("div",{className:`relative pl-5 pb-2 ${B<E.last_traced_chain.length-1?"border-l-2 border-brand-300 dark:border-brand-500/30":""}`,children:[a.jsx("div",{className:"absolute left-0 top-0 -ml-1 w-2 h-2 rounded-full bg-brand-500 dark:bg-brand-400"}),a.jsxs("div",{className:"bg-white dark:bg-neutral-850 rounded-md p-2.5 border border-neutral-200 dark:border-neutral-800",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsxs("span",{className:"text-xs font-semibold text-neutral-700 dark:text-neutral-300",children:["Step ",B+1]}),B===E.redirect_chain_step&&a.jsx("span",{className:"px-1.5 py-0.5 bg-success-100 text-success-700 dark:bg-success-500/20 dark:text-success-400 text-xs font-medium rounded-md",children:"Params Extracted"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[a.jsx("span",{className:`px-1.5 py-0.5 text-xs font-medium rounded-md ${U.status>=200&&U.status<300?"bg-success-100 text-success-700 dark:bg-success-500/20 dark:text-success-400":U.status>=300&&U.status<400?"bg-brand-100 text-brand-700 dark:bg-brand-500/20 dark:text-brand-400":"bg-error-100 text-error-700 dark:bg-error-500/20 dark:text-error-400"}`,children:U.status}),a.jsx("span",{className:"px-1.5 py-0.5 bg-neutral-100 text-neutral-700 dark:bg-neutral-800 dark:text-neutral-300 text-xs font-medium rounded-md",children:U.redirect_type})]})]}),a.jsx("div",{className:"text-xs text-neutral-600 dark:text-neutral-400 break-all mb-1",children:U.url}),U.params&&Object.keys(U.params).length>0&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-neutral-200 dark:border-neutral-800",children:[a.jsx("span",{className:"text-xs font-semibold text-neutral-700 dark:text-neutral-300",children:"Parameters:"}),a.jsx("div",{className:"mt-1 space-y-0.5",children:Object.entries(U.params).map(([D,me])=>a.jsxs("div",{className:"flex gap-2 text-xs",children:[a.jsxs("span",{className:"font-medium text-neutral-500 dark:text-neutral-400",children:[D,":"]}),a.jsx("span",{className:"text-neutral-700 dark:text-neutral-300",children:me})]},D))})]})]}),B<E.last_traced_chain.length-1&&a.jsx("div",{className:"absolute left-0 bottom-0 -ml-1",children:a.jsx(u0,{size:12,className:"text-brand-500 dark:text-brand-400 transform rotate-90"})})]},B))]})})]})]})]},E.id)})}),ce.length>0&&a.jsx(y0,{currentPage:j,totalPages:Pe,onPageChange:g,itemsPerPage:m,onItemsPerPageChange:p,totalItems:ce.length})]}),s&&a.jsx(yb,{offer:l,onClose:N,onSave:k})]})}const bb={brightdata:{name:"Bright Data",host:"brd.superproxy.io",port:22225,username:"brd-customer-YOUR_ID-zone-ZONE_NAME",api_endpoint_example:"https://brightdata.com/api/v2/zone/ips",curl_example:'curl -x brd.superproxy.io:22225 -U "brd-customer-{id}-zone-{zone}-country-{country}:{pass}" https://lumtest.com/myip.json'},brightdata_browser:{name:"Bright Data Browser API",host:"api.brightdata.com",port:443,username:"",api_endpoint_example:"https://api.brightdata.com/v2/scrape",curl_example:`curl -H "Authorization: Bearer YOUR_API_KEY" -H "Content-Type: application/json" -d '{"url":"https://example.com","format":"raw","country":"us"}' https://api.brightdata.com/v2/scrape`},oxylabs:{name:"Oxylabs",host:"pr.oxylabs.io",port:7777,username:"customer-USERNAME-cc-COUNTRY",api_endpoint_example:"https://api.oxylabs.io/v1/queries",curl_example:'curl -x pr.oxylabs.io:7777 -U "customer-{username}-cc-{country}:{pass}" https://ip.oxylabs.io/location'},smartproxy:{name:"Smartproxy",host:"gate.smartproxy.com",port:7e3,username:"user-USERNAME-country-COUNTRY",api_endpoint_example:"https://api.smartproxy.com/v2/stats",curl_example:'curl -x gate.smartproxy.com:7000 -U "user-{username}-country-{country}:{pass}" https://ip.smartproxy.com/json'},luna:{name:"Luna Proxy",host:"customer-USERNAME.proxy.lunaproxy.com",port:12233,username:"username",api_endpoint_example:"",curl_example:""},custom:{name:"Custom Provider",host:"",port:8080,username:"",api_endpoint_example:"https://api.example.com/endpoint",curl_example:'curl -x proxy.example.com:port -U "user-{customer_id}-country-{country}:pass" https://ipapi.co/json/'}};function wb({provider:e,onClose:t,onSuccess:r}){const[n,s]=w.useState({name:"",provider_type:"custom",host:"",port:8080,username:"",password:"",api_key:"",api_endpoint_example:"",curl_example:"",priority:50,enabled:!0}),[i,l]=w.useState(!1),[o,u]=w.useState(null);w.useEffect(()=>{e&&s({...e,api_key:e.api_key||"",api_endpoint_example:e.api_endpoint_example||"",curl_example:e.curl_example||""})},[e]);const c=d=>{const f=bb[d];f&&s({...n,provider_type:d,name:n.name||f.name,host:f.host,port:f.port,username:f.username,api_endpoint_example:f.api_endpoint_example,curl_example:f.curl_example})},h=async d=>{d.preventDefault(),u(null),l(!0);try{const{data:{session:f}}=await H.auth.getSession();if(!f)throw new Error("Not authenticated");const y="https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/proxy-providers",x=e?"PUT":"POST",v=e?{id:e.id,...n}:n,j=await fetch(y,{method:x,headers:{Authorization:`Bearer ${f.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(v)}),g=await j.json();if(!j.ok)throw new Error(g.error||"Failed to save provider");r()}catch(f){u(f.message||"Failed to save provider")}finally{l(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:e?"Edit Provider":"Add Proxy Provider"}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Cr,{size:20})})]}),a.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[o&&a.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[a.jsx(Ut,{size:18}),a.jsx("span",{children:o})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider Type"}),a.jsxs("select",{value:n.provider_type,onChange:d=>{s({...n,provider_type:d.target.value}),c(d.target.value)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",required:!0,children:[a.jsx("option",{value:"custom",children:"Custom"}),a.jsx("option",{value:"brightdata",children:"Bright Data (Residential Proxy)"}),a.jsx("option",{value:"brightdata_browser",children:"Bright Data Browser API"}),a.jsx("option",{value:"oxylabs",children:"Oxylabs"}),a.jsx("option",{value:"smartproxy",children:"Smartproxy"}),a.jsx("option",{value:"luna",children:"Luna Proxy"})]}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select a provider type to auto-fill common configurations"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Provider Name"}),a.jsx("input",{type:"text",value:n.name,onChange:d=>s({...n,name:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"My Proxy Provider",required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proxy Host"}),a.jsx("input",{type:"text",value:n.host,onChange:d=>s({...n,host:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none font-mono text-sm",placeholder:"proxy.example.com",required:n.provider_type!=="brightdata_browser"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Port"}),a.jsx("input",{type:"number",value:n.port,onChange:d=>s({...n,port:parseInt(d.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"8080",required:n.provider_type!=="brightdata_browser"})]})]}),n.provider_type==="brightdata_browser"&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bright Data Browser API Key"}),a.jsx("input",{type:"password",value:n.api_key||"",onChange:d=>s({...n,api_key:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none font-mono text-sm",placeholder:"Your Browser API Key",required:!0}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:" Browser API uses REST API instead of proxy. Get your API key from Bright Data dashboard."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username ",n.provider_type==="brightdata_browser"&&a.jsx("span",{className:"text-gray-500",children:"(not required for Browser API)"})]}),a.jsx("input",{type:"text",value:n.username,onChange:d=>s({...n,username:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none font-mono text-sm",placeholder:"username",required:n.provider_type!=="brightdata_browser"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",n.provider_type==="brightdata_browser"&&a.jsx("span",{className:"text-gray-500",children:"(not required for Browser API)"})]}),a.jsx("input",{type:"password",value:n.password,onChange:d=>s({...n,password:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none font-mono text-sm",placeholder:"password",required:n.provider_type!=="brightdata_browser"})]})]}),a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[a.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Documentation References (Optional)"}),a.jsx("p",{className:"text-xs text-blue-800 mb-3",children:"These fields are for your reference only and help document the provider's API format. They are not used in actual requests."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Endpoint Example"}),a.jsx("input",{type:"text",value:n.api_endpoint_example,onChange:d=>s({...n,api_endpoint_example:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none font-mono text-xs",placeholder:"https://api.provider.com/endpoint"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Example API endpoint to understand provider's API format"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"cURL Example"}),a.jsx("textarea",{value:n.curl_example,onChange:d=>s({...n,curl_example:d.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none font-mono text-xs",placeholder:'curl -x proxy:port -U "user-{country}:pass" https://ipapi.co/json/'}),a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Example cURL command showing format with placeholders like ","{country}",", ","{session}"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority (1-100)"}),a.jsx("input",{type:"number",min:"1",max:"100",value:n.priority,onChange:d=>s({...n,priority:parseInt(d.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",required:!0}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Higher priority providers are preferred in rotation"})]}),a.jsxs("div",{className:"flex items-center pt-6",children:[a.jsx("input",{type:"checkbox",id:"enabled",checked:n.enabled,onChange:d=>s({...n,enabled:d.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"enabled",className:"ml-2 text-sm font-medium text-gray-700",children:"Enable provider"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:i,className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2",children:[a.jsx(Nr,{size:18}),i?"Saving...":"Save Provider"]})]})]})]})})}function kb({provider:e,onClose:t}){const[r,n]=w.useState(!1),[s,i]=w.useState(!1),[l,o]=w.useState(null),[u,c]=w.useState(null),[h,d]=w.useState("US"),[f,y]=w.useState(3),x=[{code:"US",name:"United States"},{code:"GB",name:"United Kingdom"},{code:"CA",name:"Canada"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"ES",name:"Spain"},{code:"IT",name:"Italy"},{code:"AU",name:"Australia"},{code:"JP",name:"Japan"},{code:"BR",name:"Brazil"}],v=async()=>{n(!0),o(null);try{const{data:{session:p}}=await H.auth.getSession();if(!p)throw new Error("Not authenticated");const S=await(await fetch("https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/proxy-providers/test",{method:"POST",headers:{Authorization:`Bearer ${p.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({host:e.host,port:e.port,username:e.username,password:e.password,provider_type:e.provider_type,test_type:"basic"})})).json();o(S),i(S.success)}catch(p){o({success:!1,status:"failed",response_time_ms:0,error:p.message})}finally{n(!1)}},j=async()=>{if(!s){alert("Please run and pass the basic test first");return}n(!0),c(null);try{const{data:{session:p}}=await H.auth.getSession();if(!p)throw new Error("Not authenticated");const S=await(await fetch("https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/proxy-providers/test",{method:"POST",headers:{Authorization:`Bearer ${p.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({host:e.host,port:e.port,username:e.username,password:e.password,provider_type:e.provider_type,test_type:"geo",target_country:h,num_requests:f})})).json();c(S)}catch(p){alert(`Test failed: ${p.message}`)}finally{n(!1)}},g=p=>p==="match"||p==="connected"?a.jsx(He,{className:"text-green-600",size:18}):p==="mismatch"?a.jsx(Ut,{className:"text-yellow-600",size:18}):a.jsx(ho,{className:"text-red-600",size:18}),m=p=>p==="match"||p==="connected"?"bg-green-50 border-green-200 text-green-700":p==="mismatch"?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-red-50 border-red-200 text-red-700";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Test Provider Connection"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.name})]}),a.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Cr,{size:20})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Basic Connectivity Test"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Verify that the proxy is reachable and credentials are valid"})]}),a.jsx("button",{onClick:v,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center gap-2",children:r&&!l?a.jsxs(a.Fragment,{children:[a.jsx(Wa,{className:"animate-spin",size:18}),"Testing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ha,{size:18}),"Run Basic Test"]})})]}),l&&a.jsxs("div",{className:`p-4 rounded-lg border ${m(l.status)}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[g(l.status),a.jsx("span",{className:"font-semibold",children:l.success?"Connection Successful":"Connection Failed"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Status:"}),a.jsx("span",{className:"font-medium",children:l.status})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Response Time:"}),a.jsxs("span",{className:"font-medium",children:[l.response_time_ms,"ms"]})]}),l.ip_address&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"IP Address:"}),a.jsx("span",{className:"font-mono font-medium",children:l.ip_address})]}),l.error&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-current",children:[a.jsx("span",{className:"font-medium",children:"Error:"})," ",l.error]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Geo-Targeting Validation Test"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Verify that the proxy correctly targets the specified country"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Country"}),a.jsx("select",{value:h,onChange:p=>d(p.target.value),disabled:r||!s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none disabled:opacity-50",children:x.map(p=>a.jsxs("option",{value:p.code,children:[p.name," (",p.code,")"]},p.code))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Requests"}),a.jsxs("select",{value:f,onChange:p=>y(parseInt(p.target.value)),disabled:r||!s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none disabled:opacity-50",children:[a.jsx("option",{value:1,children:"1 request"}),a.jsx("option",{value:3,children:"3 requests"}),a.jsx("option",{value:5,children:"5 requests"})]})]})]}),a.jsx("button",{onClick:j,disabled:r||!s,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2",children:r&&s?a.jsxs(a.Fragment,{children:[a.jsx(Wa,{className:"animate-spin",size:18}),"Running Test..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ha,{size:18}),"Run Geo-Targeting Test"]})}),!s&&a.jsx("p",{className:"mt-2 text-sm text-gray-500 text-center",children:"Complete the basic test first to enable geo-targeting test"}),u&&a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:`p-4 rounded-lg border ${u.success_rate===100?"bg-green-50 border-green-200":u.success_rate>=80?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.success_rate===100?a.jsx(He,{className:"text-green-600",size:20}):u.success_rate>=80?a.jsx(Ut,{className:"text-yellow-600",size:20}):a.jsx(ho,{className:"text-red-600",size:20}),a.jsxs("span",{className:"font-semibold",children:[u.successful_requests,"/",u.total_requests," requests successful (",u.success_rate,"%)"]})]}),a.jsx("p",{className:"text-sm",children:u.summary})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"#"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Requested"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Actual"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"IP"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Time"}),a.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:u.results.map(p=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2",children:p.request_number}),a.jsx("td",{className:"px-4 py-2 font-medium",children:p.requested_country}),a.jsx("td",{className:"px-4 py-2 font-medium",children:p.actual_country}),a.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:p.ip_address}),a.jsxs("td",{className:"px-4 py-2",children:[p.response_time_ms,"ms"]}),a.jsx("td",{className:"px-4 py-2",children:a.jsxs("span",{className:`inline-flex items-center gap-1 text-xs px-2 py-1 rounded ${p.status==="match"?"bg-green-100 text-green-700":p.status==="mismatch"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[g(p.status),p.status]})})]},p.request_number))})]})})]})]})]}),a.jsx("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4",children:a.jsx("button",{onClick:t,className:"w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium",children:"Close"})})]})})}function _b({rotationMode:e,failoverEnabled:t,onRotationModeChange:r,onFailoverEnabledChange:n}){const[s,i]=w.useState([]),[l,o]=w.useState(!0),[u,c]=w.useState(!1),[h,d]=w.useState(!1),[f,y]=w.useState(null),[x,v]=w.useState(null),[j,g]=w.useState(null);w.useEffect(()=>{m()},[]);const m=async()=>{o(!0);try{const{data:{session:N}}=await H.auth.getSession();if(!N)return;const L=await(await fetch("https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/proxy-providers",{headers:{Authorization:`Bearer ${N.access_token}`,"Content-Type":"application/json"}})).json();L.providers&&i(L.providers)}catch(N){g({type:"error",text:N.message||"Failed to fetch providers"})}finally{o(!1)}},p=async N=>{try{const{data:{session:k}}=await H.auth.getSession();if(!k)return;if((await fetch("https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/proxy-providers",{method:"PUT",headers:{Authorization:`Bearer ${k.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({id:N.id,enabled:!N.enabled})})).ok)g({type:"success",text:`Provider ${N.enabled?"disabled":"enabled"} successfully`}),m();else throw new Error("Failed to toggle provider")}catch(k){g({type:"error",text:k.message||"Failed to toggle provider"})}},_=async N=>{if(confirm("Are you sure you want to delete this provider?"))try{const{data:{session:k}}=await H.auth.getSession();if(!k)return;if((await fetch("https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/proxy-providers",{method:"DELETE",headers:{Authorization:`Bearer ${k.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({id:N})})).ok)g({type:"success",text:"Provider deleted successfully"}),m();else throw new Error("Failed to delete provider")}catch(k){g({type:"error",text:k.message||"Failed to delete provider"})}},C=N=>{const k=N.success_count+N.failure_count;return k===0?0:Math.round(N.success_count/k*100)},S=N=>N>=90?"text-success-600 dark:text-success-400 bg-success-50 dark:bg-success-900/30":N>=70?"text-warning-600 dark:text-warning-400 bg-warning-50 dark:bg-warning-900/30":"text-error-600 dark:text-error-400 bg-error-50 dark:bg-error-900/30";return a.jsxs("div",{className:"space-y-5",children:[j&&a.jsxs("div",{className:`p-4 rounded-lg flex items-center gap-2 ${j.type==="success"?"bg-success-50 dark:bg-success-900/20 border border-success-200 dark:border-success-800 text-success-700 dark:text-success-300":"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 text-error-700 dark:text-error-300"}`,children:[a.jsx(Ut,{size:18}),a.jsx("span",{className:"text-sm",children:j.text})]}),a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-base font-semibold text-neutral-900 dark:text-neutral-50",children:"Additional Proxy Providers"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:"Add multiple providers for rotation and redundancy. Luna proxy is always used as fallback."})]}),a.jsxs("button",{onClick:()=>{y(null),c(!0)},className:"px-4 py-2 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 transition-smooth font-medium flex items-center gap-2 text-sm",children:[a.jsx(jr,{size:18}),"Add Provider"]})]}),l?a.jsx("div",{className:"text-center py-8 text-neutral-500 dark:text-neutral-400",children:"Loading providers..."}):s.length===0?a.jsx("div",{className:"text-center py-8 text-neutral-500 dark:text-neutral-400 text-sm",children:"No additional providers configured. Luna proxy will be used as the only provider."}):a.jsx("div",{className:"space-y-4",children:s.map(N=>{const k=C(N);return a.jsx("div",{className:"border border-neutral-200 dark:border-neutral-800 rounded-lg p-4 hover:bg-neutral-50 dark:hover:bg-neutral-850 transition-smooth",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-50",children:N.name}),a.jsx("span",{className:"text-xs px-2 py-1 bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300 rounded",children:N.provider_type}),a.jsxs("span",{className:`text-xs px-2 py-1 rounded ${S(k)}`,children:[k,"% success"]}),N.enabled?a.jsx("span",{className:"text-xs px-2 py-1 bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400 rounded",children:"Enabled"}):a.jsx("span",{className:"text-xs px-2 py-1 bg-neutral-100 dark:bg-neutral-800 text-neutral-500 dark:text-neutral-400 rounded",children:"Disabled"})]}),a.jsxs("div",{className:"mt-2 text-sm text-neutral-600 dark:text-neutral-400 space-y-1",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Host:"})," ",N.host,":",N.port]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Priority:"})," ",N.priority]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Stats:"})," ",N.success_count," success,"," ",N.failure_count," failures"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{v(N),d(!0)},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Test connection",children:a.jsx(Ha,{size:18})}),a.jsx("button",{onClick:()=>p(N),className:`p-2 rounded-lg transition-colors ${N.enabled?"text-yellow-600 hover:bg-yellow-50":"text-gray-600 hover:bg-gray-100"}`,title:N.enabled?"Disable":"Enable",children:N.enabled?a.jsx(ib,{size:18}):a.jsx(lb,{size:18})}),a.jsx("button",{onClick:()=>{y(N),c(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(h0,{size:18})}),a.jsx("button",{onClick:()=>_(N.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:a.jsx(Ss,{size:18})})]})]})},N.id)})})]}),s.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Proxy Rotation Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rotation Mode"}),a.jsxs("select",{value:e||"sequential",onChange:N=>r(N.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[a.jsx("option",{value:"sequential",children:"Sequential (priority order)"}),a.jsx("option",{value:"random",children:"Random (pick randomly)"}),a.jsx("option",{value:"weighted",children:"Weighted (probability by priority)"}),a.jsx("option",{value:"failover",children:"Failover (primary until failure)"})]}),a.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:[e==="sequential"&&"Providers are used in priority order, highest first",e==="random"&&"A random provider is selected for each request",e==="weighted"&&"Higher priority providers are more likely to be selected",e==="failover"&&"Primary provider used until failure, then next"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"failoverEnabled",checked:t??!0,onChange:N=>n(N.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"failoverEnabled",className:"text-sm font-medium text-gray-700",children:"Enable automatic failover to next provider on error"})]})]})]}),u&&a.jsx(wb,{provider:f,onClose:()=>{c(!1),y(null)},onSuccess:()=>{c(!1),y(null),m(),g({type:"success",text:f?"Provider updated successfully":"Provider added successfully"})}}),h&&x&&a.jsx(kb,{provider:x,onClose:()=>{d(!1),v(null)}})]})}function jb(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState(""),[l,o]=w.useState("viewer"),[u,c]=w.useState(!1),[h,d]=w.useState(null);w.useEffect(()=>{f()},[]);const f=async()=>{n(!0);const{data:g,error:m}=await H.from("user_profiles").select("*").order("created_at",{ascending:!1});!m&&g&&t(g),n(!1)},y=async g=>{g.preventDefault(),c(!0),d(null);try{const{error:m}=await H.rpc("admin_create_user_invite",{user_email:s,user_role:l});if(m)throw m;d({type:"success",text:`Invitation created! The user can now sign up with email: ${s}`}),i(""),o("viewer")}catch(m){d({type:"error",text:m.message||"Failed to create invitation"})}finally{c(!1)}},x=async(g,m)=>{try{const{error:p}=await H.from("user_profiles").update({role:m,updated_at:new Date().toISOString()}).eq("id",g);if(p)throw p;d({type:"success",text:"User role updated successfully!"}),f()}catch(p){d({type:"error",text:p.message||"Failed to update role"})}},v=e.filter(g=>g.role==="admin").length,j=e.filter(g=>g.role==="viewer").length;return a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(ma,{className:"text-brand-600 dark:text-brand-400",size:24}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-neutral-900 dark:text-neutral-50",children:"User Management"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:"Manage user accounts and roles"})]})]}),h&&a.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center gap-2 ${h.type==="success"?"bg-success-50 dark:bg-success-900/20 border border-success-200 dark:border-success-800 text-success-700 dark:text-success-300":"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 text-error-700 dark:text-error-300"}`,children:[h.type==="success"?a.jsx(He,{size:18}):a.jsx(Ut,{size:18}),a.jsx("span",{className:"text-sm",children:h.text})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-brand-50 to-brand-100 dark:from-brand-900/20 dark:to-brand-800/20 rounded-lg p-4 border border-brand-200 dark:border-brand-800",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ma,{className:"text-brand-600 dark:text-brand-400",size:20}),a.jsx("h3",{className:"text-sm font-semibold text-brand-900 dark:text-brand-300",children:"Total Admins"})]}),a.jsx("p",{className:"text-3xl font-bold text-brand-700 dark:text-brand-400",children:v})]}),a.jsxs("div",{className:"bg-gradient-to-br from-success-50 to-success-100 dark:from-success-900/20 dark:to-success-800/20 rounded-lg p-4 border border-success-200 dark:border-success-800",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(uo,{className:"text-success-600 dark:text-success-400",size:20}),a.jsx("h3",{className:"text-sm font-semibold text-success-900 dark:text-success-300",children:"Total Viewers"})]}),a.jsx("p",{className:"text-3xl font-bold text-success-700 dark:text-success-400",children:j})]})]}),a.jsxs("form",{onSubmit:y,className:"mb-6 p-4 bg-neutral-50 dark:bg-neutral-850 rounded-lg border border-neutral-200 dark:border-neutral-800",children:[a.jsx("h3",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-50 mb-4",children:"Create New User"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Email Address"}),a.jsx("input",{type:"email",value:s,onChange:g=>i(g.target.value),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth placeholder-neutral-400 dark:placeholder-neutral-500",placeholder:"user@example.com",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Role"}),a.jsxs("select",{value:l,onChange:g=>o(g.target.value),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",children:[a.jsx("option",{value:"viewer",children:"Viewer"}),a.jsx("option",{value:"admin",children:"Admin"})]})]})]}),a.jsx("button",{type:"submit",disabled:u,className:"mt-4 w-full flex items-center justify-center gap-2 px-4 py-2 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed transition-smooth font-medium",children:u?a.jsxs(a.Fragment,{children:[a.jsx(Wa,{size:18,className:"animate-spin"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(pb,{size:18}),"Create User Account"]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-50 mb-4",children:"All Users"}),r?a.jsxs("div",{className:"text-center py-8 text-neutral-500 dark:text-neutral-400",children:[a.jsx(Wa,{size:24,className:"animate-spin mx-auto mb-2"}),"Loading users..."]}):a.jsx("div",{className:"space-y-2",children:e.map(g=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-neutral-50 dark:bg-neutral-850 rounded-lg border border-neutral-200 dark:border-neutral-800",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[a.jsx("div",{className:`p-2 rounded-lg ${g.role==="admin"?"bg-brand-100 dark:bg-brand-900/30 text-brand-600 dark:text-brand-400":"bg-success-100 dark:bg-success-900/30 text-success-600 dark:text-success-400"}`,children:g.role==="admin"?a.jsx(ma,{size:20}):a.jsx(uo,{size:20})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(d0,{size:14,className:"text-neutral-400 dark:text-neutral-500"}),a.jsx("span",{className:"font-medium text-neutral-900 dark:text-neutral-50",children:g.email})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-neutral-500 dark:text-neutral-400",children:[a.jsx(yu,{size:12}),a.jsxs("span",{children:["Joined ",new Date(g.created_at).toLocaleDateString()]})]})]})]}),a.jsx("div",{children:a.jsxs("select",{value:g.role,onChange:m=>x(g.id,m.target.value),className:"px-3 py-1.5 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 text-sm outline-none focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 transition-smooth",children:[a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"viewer",children:"Viewer"})]})})]},g.id))})]})]})})}function Nb(){const{isAdmin:e}=g0(),[t,r]=w.useState({aws_proxy_url:"",luna_proxy_host:"",luna_proxy_port:"",luna_proxy_username:"",luna_proxy_password:"",ip_cooldown_seconds:60,proxy_rotation_mode:"sequential",proxy_failover_enabled:!0}),[n,s]=w.useState(!0),[i,l]=w.useState(!1),[o,u]=w.useState(!1),[c,h]=w.useState(null);w.useEffect(()=>{e?d():s(!1)},[e]);const d=async()=>{s(!0);const{data:{user:x}}=await H.auth.getUser();if(!x){s(!1);return}const{data:v,error:j}=await H.from("settings").select("*").eq("user_id",x.id).maybeSingle();!j&&v&&r({...v,luna_proxy_port:v.luna_proxy_port?String(v.luna_proxy_port):"",ip_cooldown_seconds:v.ip_cooldown_seconds??60,proxy_rotation_mode:v.proxy_rotation_mode??"sequential",proxy_failover_enabled:v.proxy_failover_enabled??!0}),s(!1)},f=async x=>{x.preventDefault(),l(!0),h(null);try{const{data:{user:v}}=await H.auth.getUser();if(!v)throw new Error("Not authenticated");const j={aws_proxy_url:t.aws_proxy_url||null,luna_proxy_host:t.luna_proxy_host,luna_proxy_port:t.luna_proxy_port?parseInt(t.luna_proxy_port):null,luna_proxy_username:t.luna_proxy_username,luna_proxy_password:t.luna_proxy_password,ip_cooldown_seconds:t.ip_cooldown_seconds,proxy_rotation_mode:t.proxy_rotation_mode,proxy_failover_enabled:t.proxy_failover_enabled};if(t.id){const{error:g}=await H.from("settings").update(j).eq("id",t.id);if(g)throw g}else{const{error:g}=await H.from("settings").insert([{user_id:v.id,...j}]);if(g)throw g}h({type:"success",text:"Proxy settings saved successfully!"}),await d()}catch(v){h({type:"error",text:v.message||"Failed to save settings"})}finally{l(!1)}},y=async()=>{u(!0),h(null);try{const{data:{session:x}}=await H.auth.getSession();if(!x)throw new Error("Not authenticated");const g=await(await fetch("https://rfhuqenntxiqurplenjn.supabase.co/functions/v1/test-proxy",{method:"GET",headers:{Authorization:`Bearer ${x.access_token}`,"Content-Type":"application/json"}})).json();g.success?g.proxy_working?h({type:"success",text:"Proxy is working correctly!"}):h({type:"error",text:"Proxy not working - IPs are the same!"}):h({type:"error",text:g.error||"Failed to test proxy"})}catch(x){h({type:"error",text:x.message||"Failed to test proxy"})}finally{u(!1)}};return n?a.jsx("div",{className:"text-center py-12 text-neutral-500 dark:text-neutral-400",children:"Loading settings..."}):e?a.jsxs("div",{className:"space-y-5",children:[a.jsx(jb,{}),a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(Kr,{className:"text-brand-600 dark:text-brand-400",size:24}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-neutral-900 dark:text-neutral-50",children:"Luna Proxy Settings"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:"Configure Luna Proxy API or Residential Proxy for all offers"})]})]}),c&&a.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center gap-2 ${c.type==="success"?"bg-success-50 dark:bg-success-900/20 border border-success-200 dark:border-success-800 text-success-700 dark:text-success-300":"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 text-error-700 dark:text-error-300"}`,children:[c.type==="success"?a.jsx(He,{size:18}):a.jsx(Ut,{size:18}),a.jsx("span",{className:"text-sm",children:c.text})]}),a.jsxs("form",{onSubmit:f,className:"space-y-6",children:[a.jsxs("div",{className:"bg-brand-50 dark:bg-brand-900/20 p-4 rounded-lg border border-brand-200 dark:border-brand-800/50",children:[a.jsx("h3",{className:"text-sm font-semibold text-brand-900 dark:text-brand-300 mb-3",children:"AWS Proxy Service (Recommended for Luna Residential)"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"AWS Proxy Service URL"}),a.jsx("input",{type:"text",value:t.aws_proxy_url,onChange:x=>r({...t,aws_proxy_url:x.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth font-mono text-sm placeholder-neutral-400 dark:placeholder-neutral-500",placeholder:"http://your-ec2-instance:3000"}),a.jsx("p",{className:"mt-2 text-sm text-neutral-600 dark:text-neutral-400",children:"Use your AWS EC2 proxy service that handles Luna residential proxy routing. If set, this will be used instead of direct Luna API calls."})]})]}),a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-850 p-4 rounded-lg border border-neutral-200 dark:border-neutral-800",children:[a.jsx("h3",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-50 mb-3",children:"Luna Residential Proxy Credentials"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Proxy Host"}),a.jsx("input",{type:"text",value:t.luna_proxy_host,onChange:x=>r({...t,luna_proxy_host:x.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth font-mono text-xs placeholder-neutral-400 dark:placeholder-neutral-500",placeholder:"customer-USERNAME.proxy.lunaproxy.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Port"}),a.jsx("input",{type:"text",value:t.luna_proxy_port,onChange:x=>r({...t,luna_proxy_port:x.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth font-mono text-sm placeholder-neutral-400 dark:placeholder-neutral-500",placeholder:"12233"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Username"}),a.jsx("input",{type:"text",value:t.luna_proxy_username,onChange:x=>r({...t,luna_proxy_username:x.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth font-mono text-sm placeholder-neutral-400 dark:placeholder-neutral-500",placeholder:"username"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Password"}),a.jsx("input",{type:"password",value:t.luna_proxy_password,onChange:x=>r({...t,luna_proxy_password:x.target.value}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth font-mono text-sm placeholder-neutral-400 dark:placeholder-neutral-500",placeholder:"password"})]})]}),a.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"Get residential proxy credentials from Luna Proxy dashboard  Residential Proxy section"}),a.jsx("div",{className:"mt-2 p-3 bg-brand-50 dark:bg-brand-900/20 border border-brand-200 dark:border-brand-800/50 rounded-lg",children:a.jsxs("p",{className:"text-xs text-brand-800 dark:text-brand-300",children:[a.jsx("strong",{children:"Setup:"})," Use these credentials with the AWS Proxy Service above for the best performance and cost savings. These credentials are charged per GB of traffic (much cheaper than per-request pricing)."]})})]})]}),a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-850 p-4 rounded-lg border border-neutral-200 dark:border-neutral-800",children:[a.jsx("h3",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-50 mb-3",children:"IP Pool Configuration"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"IP Cooldown Duration (seconds)"}),a.jsx("input",{type:"number",min:"10",max:"300",value:t.ip_cooldown_seconds??60,onChange:x=>r({...t,ip_cooldown_seconds:parseInt(x.target.value)||60}),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth placeholder-neutral-400 dark:placeholder-neutral-500",placeholder:"60"}),a.jsx("p",{className:"mt-2 text-sm text-neutral-600 dark:text-neutral-400",children:"Time before an IP can be reused from the pool (default: 60 seconds, range: 10-300)"})]})]}),a.jsxs("div",{className:"pt-4 flex gap-3",children:[a.jsxs("button",{type:"submit",disabled:i,className:"flex-1 px-4 py-2.5 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed transition-smooth font-medium flex items-center justify-center gap-2 text-sm",children:[a.jsx(Nr,{size:18}),i?"Saving...":"Save Settings"]}),a.jsxs("button",{type:"button",onClick:y,disabled:o||!t.luna_proxy_host,className:"px-4 py-2.5 bg-success-600 dark:bg-success-500 text-white rounded-lg hover:bg-success-700 dark:hover:bg-success-600 disabled:opacity-50 disabled:cursor-not-allowed transition-smooth font-medium flex items-center justify-center gap-2 text-sm",children:[a.jsx(Ha,{size:18}),o?"Testing...":"Test Proxy"]})]})]}),a.jsx("div",{className:"mt-6",children:a.jsx(_b,{rotationMode:t.proxy_rotation_mode,failoverEnabled:t.proxy_failover_enabled,onRotationModeChange:x=>{r({...t,proxy_rotation_mode:x}),f(new Event("submit"))},onFailoverEnabledChange:x=>{r({...t,proxy_failover_enabled:x}),f(new Event("submit"))}})})]})]}):a.jsx("div",{className:"text-center py-12 text-neutral-500 dark:text-neutral-400",children:"Only admins can access settings."})}function wd(){const[e,t]=w.useState([]),[r,n]=w.useState(new Set),[s,i]=w.useState({}),[l,o]=w.useState(!0),[u,c]=w.useState(""),[h,d]=w.useState("all"),[f,y]=w.useState("all"),[x,v]=w.useState(1),[j,g]=w.useState(10);w.useEffect(()=>{m()},[]);const m=async()=>{o(!0);try{const{data:q,error:T}=await H.from("offers").select("*").order("created_at",{ascending:!1});if(T)throw T;const E=await Promise.all((q||[]).map(async P=>{const{data:U}=await H.from("offer_statistics").select("*").eq("offer_id",P.id).maybeSingle(),{data:B}=await H.from("suffix_requests").select("*").eq("offer_id",P.id).order("requested_at",{ascending:!1}).limit(10),{data:D}=await H.from("url_traces").select("*").eq("offer_id",P.id).order("visited_at",{ascending:!1}).limit(100);return{offer:P,stats:U||null,recentRequests:B||[],urlTraces:D||[]}}));t(E)}catch(q){console.error("Error fetching data:",q)}finally{o(!1)}},p=q=>{const T=new Set(r);T.has(q)?T.delete(q):T.add(q),n(T)},_=q=>q.toLocaleString(),C=q=>new Date(q).toLocaleString(),S=q=>{if(!q)return"bg-gray-400";const T=new Date,E=new Date(q),U=(T.getTime()-E.getTime())/(1e3*60*60);return U<1?"bg-green-500":U<24?"bg-yellow-500":"bg-gray-400"},N=q=>{if(!q)return"Never";const T=new Date,E=new Date(q),P=T.getTime()-E.getTime(),U=Math.floor(P/(1e3*60)),B=Math.floor(P/(1e3*60*60)),D=Math.floor(P/(1e3*60*60*24));return U<1?"Just now":U<60?`${U}m ago`:B<24?`${B}h ago`:`${D}d ago`},k=e.filter(({offer:q,stats:T})=>{const E=u.toLowerCase(),P=q.offer_name.toLowerCase().includes(E)||(q.campaign_name||"").toLowerCase().includes(E),U=h==="all"||h==="active"&&q.is_active||h==="inactive"&&!q.is_active;let B=!0;if(f!=="all"&&(T!=null&&T.last_request_at)){const D=new Date,me=new Date(T.last_request_at),K=(D.getTime()-me.getTime())/(1e3*60*60);f==="active-1h"?B=K<1:f==="active-24h"?B=K<24:f==="idle"&&(B=K>=24)}else f==="idle"?B=!(T!=null&&T.last_request_at):f!=="all"&&(B=!1);return P&&U&&B}),O=[{value:"all",label:"All Status"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],L=[{value:"all",label:"All Activity"},{value:"active-1h",label:"Active (Last Hour)"},{value:"active-24h",label:"Active (Last 24h)"},{value:"idle",label:"Idle (24h+)"}],W=k.reduce((q,T)=>{var E;return q+(((E=T.stats)==null?void 0:E.total_suffix_requests)||0)},0),le=k.reduce((q,T)=>{var E;return q+(((E=T.stats)==null?void 0:E.total_tracking_hits)||0)},0),ce=Math.ceil(k.length/j),Pe=(x-1)*j,kt=Pe+j,_t=k.slice(Pe,kt);return w.useEffect(()=>{v(1)},[u,h,f]),l?a.jsx("div",{className:"space-y-5",children:a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Gr,{className:"text-brand-600 dark:text-brand-400",size:24}),a.jsx("h2",{className:"text-xl font-semibold text-neutral-900 dark:text-neutral-50",children:"Analytics Dashboard"})]}),a.jsx("div",{className:"text-center py-8 text-neutral-500 dark:text-neutral-400",children:"Loading analytics..."})]})}):a.jsx("div",{className:"space-y-5",children:a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Gr,{className:"text-brand-600 dark:text-brand-400",size:24}),a.jsx("h2",{className:"text-xl font-semibold text-neutral-900 dark:text-neutral-50",children:"Analytics Dashboard"})]}),a.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-3 py-2 text-sm text-brand-600 dark:text-brand-400 hover:bg-brand-50 dark:hover:bg-brand-900/20 rounded-lg transition-smooth font-medium",children:[a.jsx(vu,{size:16}),"Refresh"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gradient-to-br from-brand-50 to-brand-100 dark:from-brand-900/20 dark:to-brand-800/20 rounded-lg p-4 border border-brand-200 dark:border-brand-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(p0,{className:"text-brand-600 dark:text-brand-400",size:20}),a.jsx("h3",{className:"text-sm font-semibold text-brand-900 dark:text-brand-100",children:"Total Offers"})]}),a.jsx("p",{className:"text-3xl font-bold text-brand-700 dark:text-brand-300",children:_(k.length)})]}),a.jsxs("div",{className:"bg-gradient-to-br from-success-50 to-success-100 dark:from-success-900/20 dark:to-success-800/20 rounded-lg p-4 border border-success-200 dark:border-success-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ar,{className:"text-success-600 dark:text-success-400",size:20}),a.jsx("h3",{className:"text-sm font-semibold text-success-900 dark:text-success-100",children:"Total Suffix Requests"})]}),a.jsx("p",{className:"text-3xl font-bold text-success-700 dark:text-success-300",children:_(W)})]}),a.jsxs("div",{className:"bg-gradient-to-br from-warning-50 to-warning-100 dark:from-warning-900/20 dark:to-warning-800/20 rounded-lg p-4 border border-warning-200 dark:border-warning-800/50",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Gr,{className:"text-warning-600 dark:text-warning-400",size:20}),a.jsx("h3",{className:"text-sm font-semibold text-warning-900 dark:text-warning-100",children:"Total Tracking Hits"})]}),a.jsx("p",{className:"text-3xl font-bold text-warning-700 dark:text-warning-300",children:_(le)})]})]}),e.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[a.jsx(x0,{value:u,onChange:c,placeholder:"Search offers by name...",className:"flex-1"}),a.jsx(fo,{label:"Status",options:O,value:h,onChange:d}),a.jsx(fo,{label:"Activity",options:L,value:f,onChange:y})]}),a.jsxs("div",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:["Showing ",a.jsx("span",{className:"font-medium text-neutral-900 dark:text-neutral-50",children:k.length})," of"," ",a.jsx("span",{className:"font-medium text-neutral-900 dark:text-neutral-50",children:e.length})," offers"]})]}),e.length===0?a.jsx("div",{className:"text-center py-12 bg-neutral-50 dark:bg-neutral-925 rounded-lg border-2 border-dashed border-neutral-300 dark:border-neutral-800",children:a.jsx("p",{className:"text-neutral-500 dark:text-neutral-400 text-sm",children:"No offers yet. Create your first offer to start tracking analytics."})}):k.length===0?a.jsxs("div",{className:"text-center py-12 bg-neutral-50 dark:bg-neutral-925 rounded-lg border-2 border-dashed border-neutral-300 dark:border-neutral-800",children:[a.jsx(Gr,{className:"mx-auto text-neutral-400 dark:text-neutral-600 mb-4",size:48}),a.jsx("h3",{className:"text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-2",children:"No offers found"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mb-5",children:"No offers match your current filters. Try adjusting your search or filters."}),a.jsx("button",{onClick:()=>{c(""),d("all"),y("all")},className:"inline-flex items-center gap-2 px-4 py-2 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 transition-smooth font-medium text-sm",children:"Clear Filters"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-base font-semibold text-neutral-900 dark:text-neutral-50 mb-4",children:"Offers Overview"}),_t.map(({offer:q,stats:T,recentRequests:E,urlTraces:P})=>{const U=r.has(q.id),B=s[q.id]||"suffix";return a.jsxs("div",{className:"border border-neutral-200 dark:border-neutral-800 rounded-lg overflow-hidden hover:shadow-sm dark:hover:shadow-none transition-smooth shadow-xs dark:shadow-none",children:[a.jsx("button",{onClick:()=>p(q.id),className:"w-full bg-white dark:bg-neutral-900 hover:bg-neutral-50 dark:hover:bg-neutral-850 transition-smooth",children:a.jsxs("div",{className:"p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${S((T==null?void 0:T.last_request_at)||null)}`}),a.jsxs("div",{className:"text-left flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[a.jsx("h4",{className:"text-base font-semibold text-neutral-900 dark:text-neutral-50",children:q.offer_name}),q.is_active?a.jsx("span",{className:"px-2 py-0.5 bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-400 text-xs font-medium rounded",children:"Active"}):a.jsx("span",{className:"px-2 py-0.5 bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 text-xs font-medium rounded",children:"Inactive"})]}),q.campaign_name&&a.jsx("div",{className:"mb-2",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 border border-purple-200 dark:border-purple-800/50",children:[" ",q.campaign_name]})}),a.jsxs("div",{className:"flex items-center gap-6 mt-2 text-sm text-neutral-600 dark:text-neutral-400",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ar,{size:14}),a.jsx("span",{className:"font-medium text-neutral-900 dark:text-neutral-200",children:_((T==null?void 0:T.total_suffix_requests)||0)}),a.jsx("span",{className:"text-neutral-500 dark:text-neutral-500",children:"suffix requests"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Gr,{size:14}),a.jsx("span",{className:"font-medium text-neutral-900 dark:text-neutral-200",children:_((T==null?void 0:T.total_tracking_hits)||0)}),a.jsx("span",{className:"text-neutral-500 dark:text-neutral-500",children:"tracking hits"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(fi,{size:14}),a.jsxs("span",{className:"text-neutral-500 dark:text-neutral-500",children:["Last: ",N((T==null?void 0:T.last_request_at)||null)]})]})]})]})]}),a.jsx("div",{className:"text-neutral-400 dark:text-neutral-500",children:U?a.jsx(Va,{size:20}):a.jsx(Ns,{size:20})})]})}),U&&a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-925 border-t border-neutral-200 dark:border-neutral-800 p-4 animate-slide-down",children:[a.jsxs("div",{className:"flex gap-2 mb-4 border-b border-neutral-300 dark:border-neutral-700",children:[a.jsxs("button",{onClick:()=>i({...s,[q.id]:"suffix"}),className:`px-4 py-2 text-sm font-medium transition-smooth ${B==="suffix"?"border-b-2 border-brand-600 dark:border-brand-400 text-brand-600 dark:text-brand-400":"text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:["Suffix Requests (",E.length,")"]}),a.jsxs("button",{onClick:()=>i({...s,[q.id]:"traces"}),className:`px-4 py-2 text-sm font-medium transition-smooth ${B==="traces"?"border-b-2 border-brand-600 dark:border-brand-400 text-brand-600 dark:text-brand-400":"text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:["URL Traces (",P.length,")"]})]}),B==="suffix"&&a.jsxs(a.Fragment,{children:[a.jsx("h5",{className:"text-sm font-semibold text-neutral-700 dark:text-neutral-300 mb-3",children:"Last 10 Suffix Requests"}),E.length===0?a.jsx("div",{className:"text-center py-6 text-neutral-500 dark:text-neutral-400 text-sm",children:"No suffix requests yet for this offer"}):a.jsx("div",{className:"space-y-3",children:E.map(D=>a.jsxs("div",{className:"bg-white dark:bg-neutral-850 rounded-lg p-3 border border-neutral-200 dark:border-neutral-800",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-500 dark:text-neutral-400",children:[a.jsx(yu,{size:12}),C(D.requested_at)]}),a.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Kr,{size:12,className:D.proxy_ip?"text-brand-500 dark:text-brand-400":"text-neutral-400 dark:text-neutral-500"}),a.jsx("span",{className:D.proxy_ip?"text-brand-700 dark:text-brand-300 font-semibold":"text-neutral-500 dark:text-neutral-400",children:D.proxy_ip||D.ip_address||"N/A"})]}),D.bandwidth_bytes&&a.jsxs("span",{className:"text-neutral-600 dark:text-neutral-400 font-medium",children:[" ",D.bandwidth_bytes.toLocaleString()," B"]})]})]}),D.params&&Object.keys(D.params).length>0?a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-semibold text-neutral-600 dark:text-neutral-400 mb-1 block",children:"Parameters:"}),a.jsx("div",{className:"bg-neutral-50 dark:bg-neutral-900 rounded p-2 space-y-1 border border-neutral-200 dark:border-neutral-800",children:Object.entries(D.params).map(([me,K])=>a.jsxs("div",{className:"flex gap-2 text-xs",children:[a.jsxs("span",{className:"font-semibold text-neutral-700 dark:text-neutral-300 font-mono",children:[me,":"]}),a.jsx("span",{className:"text-neutral-900 dark:text-neutral-100 font-mono break-all",children:String(K)})]},me))})]}):a.jsxs("div",{children:[a.jsx("span",{className:"text-xs font-semibold text-neutral-600 dark:text-neutral-400 mb-1 block",children:"Suffix:"}),a.jsx("code",{className:"px-2 py-1 bg-neutral-50 dark:bg-neutral-900 text-neutral-800 dark:text-neutral-200 rounded text-xs font-mono border border-neutral-200 dark:border-neutral-800",children:D.suffix_returned||"(empty)"})]})]},D.id))})]}),B==="traces"&&a.jsxs(a.Fragment,{children:[a.jsx("h5",{className:"text-sm font-semibold text-neutral-700 dark:text-neutral-300 mb-3",children:"URL Tracking Hits (Last 100)"}),P.length===0?a.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400 text-center py-4",children:"No tracking hits recorded yet"}):a.jsx("div",{className:"space-y-3",children:P.map(D=>{const me=we=>{switch(we.toLowerCase()){case"mobile":return a.jsx(ub,{size:16});case"tablet":return a.jsx(hb,{size:16});case"bot":return a.jsx(Yv,{size:16});default:return a.jsx(yd,{size:16})}},K=we=>{switch(we.toLowerCase()){case"mobile":return"bg-brand-100 dark:bg-brand-900/30 text-brand-700 dark:text-brand-300";case"tablet":return"bg-warning-100 dark:bg-warning-900/30 text-warning-700 dark:text-warning-300";case"bot":return"bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300";default:return"bg-success-100 dark:bg-success-900/30 text-success-700 dark:text-success-300"}};return a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-850 rounded-lg p-4 border border-neutral-200 dark:border-neutral-800",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium flex items-center gap-1 ${K(D.device_type)}`,children:[me(D.device_type),D.device_type]}),a.jsx("span",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:new Date(D.visited_at).toLocaleString()})]})}),a.jsxs("div",{className:"space-y-2 text-sm",children:[D.proxy_ip&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Kr,{size:14,className:"text-brand-500 dark:text-brand-400"}),a.jsx("span",{className:"text-neutral-600 dark:text-neutral-400 font-semibold",children:"Proxy IP:"}),a.jsx("span",{className:"font-mono text-brand-700 dark:text-brand-300",children:D.proxy_ip})]}),D.user_agent&&a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(yd,{size:14,className:"text-neutral-400 dark:text-neutral-500 mt-0.5"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("span",{className:"text-neutral-600 dark:text-neutral-400 text-xs font-semibold",children:"User Agent:"}),a.jsx("p",{className:"font-mono text-xs text-neutral-900 dark:text-neutral-100 break-all mt-1",children:D.user_agent})]})]}),(D.geo_country||D.geo_city||D.geo_region)&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Kr,{size:14,className:"text-success-500 dark:text-success-400"}),a.jsx("span",{className:"text-neutral-600 dark:text-neutral-400 font-semibold",children:"Proxy Location:"}),a.jsx("span",{className:"text-neutral-900 dark:text-neutral-100",children:[D.geo_city,D.geo_region,D.geo_country].filter(Boolean).join(", ")})]}),!D.proxy_ip&&D.visitor_ip&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Kr,{size:14,className:"text-neutral-400 dark:text-neutral-500"}),a.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Visitor IP:"}),a.jsx("span",{className:"font-mono text-neutral-900 dark:text-neutral-100",children:D.visitor_ip})]}),!D.geo_country&&D.country&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Kr,{size:14,className:"text-neutral-400 dark:text-neutral-500"}),a.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Location:"}),a.jsxs("span",{className:"text-neutral-900 dark:text-neutral-100",children:[D.city?`${D.city}, `:"",D.country]})]}),D.referrer&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ar,{size:14,className:"text-neutral-400 dark:text-neutral-500"}),a.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:"Referrer:"}),a.jsx("span",{className:"font-mono text-neutral-900 dark:text-neutral-100 truncate",children:D.referrer})]}),D.query_params&&Object.keys(D.query_params).length>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-neutral-600 dark:text-neutral-400 text-xs font-semibold mb-1 block",children:"Query Parameters:"}),a.jsx("div",{className:"bg-white dark:bg-neutral-900 rounded p-2 space-y-1 border border-neutral-200 dark:border-neutral-800",children:Object.entries(D.query_params).map(([we,jt])=>a.jsxs("div",{className:"flex gap-2 text-xs font-mono",children:[a.jsxs("span",{className:"font-semibold text-neutral-700 dark:text-neutral-300",children:[we,":"]}),a.jsx("span",{className:"text-neutral-900 dark:text-neutral-100 break-all",children:String(jt)})]},we))})]})]})]},D.id)})})]})]})]},q.id)})]}),k.length>0&&a.jsx(y0,{currentPage:x,totalPages:ce,onPageChange:v,itemsPerPage:j,onItemsPerPageChange:g,totalItems:k.length})]})]})})}function Sb(){var _,C;const[e,t]=w.useState(null),r="https://rfhuqenntxiqurplenjn.supabase.co",[n,s]=w.useState("https://amzn.to/3BxQqXv"),[i,l]=w.useState("http_only"),[o,u]=w.useState(!1),[c,h]=w.useState(null),d=(S,N)=>{navigator.clipboard.writeText(S),t(N),setTimeout(()=>t(null),2e3)},f=async()=>{u(!0),h(null);try{const{data:{user:S}}=await H.auth.getUser(),{data:{session:N}}=await H.auth.getSession();if(!S||!N){alert("Please log in to test the tracer");return}let k=6e4;i==="anti_cloaking"?k=9e4:i==="interactive"?k=12e4:i==="brightdata_browser"&&(k=9e4);const O={url:n,max_redirects:20,timeout_ms:k,user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",tracer_mode:i};i==="brightdata_browser"&&(O.user_id=S.id);const W=await(await fetch(`${r}/functions/v1/trace-redirects`,{method:"POST",headers:{Authorization:`Bearer ${N.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(O)})).json();h(W)}catch(S){h({success:!1,error:S.message})}finally{u(!1)}},y=`// ============================================
// RATE CONTROL CONFIGURATION
// ============================================
// Adjust DELAY_MS to control API call speed:
// - 0 = No delay (fastest, use for testing)
// - 1000 = 1 second delay (60 calls/minute)
// - 2000 = 2 second delay (30 calls/minute)
// - 5000 = 5 second delay (12 calls/minute)
var DELAY_MS = 1000;

// Replace 'OFFER_NAME' with your actual offer name
var OFFER_NAME = 'OFFER_NAME';

// ============================================
// MAIN FUNCTION
// ============================================
function getTrackingUrl() {
  // Add delay to control API call rate
  if (DELAY_MS > 0) {
    Utilities.sleep(DELAY_MS);
  }

  var url = '${r}/functions/v1/get-suffix?offer_name=' + encodeURIComponent(OFFER_NAME);

  var options = {
    'method': 'get',
    'muteHttpExceptions': true
  };

  try {
    var response = UrlFetchApp.fetch(url, options);
    var json = JSON.parse(response.getContentText());

    if (json.success && json.suffix) {
      return json.final_url + '?' + json.suffix;
    }
  } catch (e) {
    Logger.log('Error fetching URL: ' + e.toString());
  }

  return '';
}

function main() {
  var trackingUrl = getTrackingUrl();
  Logger.log('Tracking URL: ' + trackingUrl);

  // Use this URL in your ad customizers
  return trackingUrl;
}`,x=`// ============================================
// ADAPTIVE INTERVAL CONFIGURATION (V2)
// ============================================
// Dynamic delay based on yesterday's landing page frequency
// Automatically fetched from API endpoint
// V2: Script collects and sends its own landing page data
var CURRENT_INTERVAL_MS = 5000; // Default fallback (will be overridden by API)
var ACCOUNT_ID = ''; // Will be set at startup

// Configuration for interval calculation
var SUPABASE_URL = '${r}';
var OFFER_NAME = 'OFFER_NAME';
var DEFAULT_INTERVAL_MS = 5000;
var MIN_INTERVAL_MS = 1000;     // Minimum speed (never go below)
var MAX_INTERVAL_MS = 30000;    // Maximum speed (never go above)

// ============================================
// ACCOUNT ID HELPER
// ============================================
function getAccountId() {
  try {
    return AdsApp.currentAccount().getCustomerId();
  } catch (error) {
    Logger.log(' [ACCOUNT] Failed to get account ID: ' + error);
    return 'unknown';
  }
}

// ============================================
// GET YESTERDAY'S LANDING PAGES WITH CLICKS (NO REPORTS)
// ============================================
// Collects yesterday's landing page data using FINAL_URL_REPORT (working approach)
// Returns {url: clicks} for API calculation
function getYesterdayLandingPages() {
  try {
    Logger.log('[GOOGLE ADS] Collecting yesterday landing pages via FINAL_URL_REPORT...');
    
    var query = 'SELECT EffectiveFinalUrl, Clicks ' +
                'FROM FINAL_URL_REPORT ' +
                'DURING YESTERDAY';
    
    var report = AdsApp.report(query);
    var rows = report.rows();
    
    var landingPages = {};
    var totalClicks = 0;
    var processedRows = 0;
    
    while (rows.hasNext()) {
      var row = rows.next();
      var url = row['EffectiveFinalUrl'] || '';
      var clicks = parseInt(row['Clicks'], 10) || 0;
      
      if (url && clicks > 0) {
        landingPages[url] = (landingPages[url] || 0) + clicks;
        totalClicks += clicks;
        processedRows++;
      }
    }
    
    var uniquePages = Object.keys(landingPages).length;
    Logger.log('[REPORT] Yesterday results:');
    Logger.log('  Rows processed: ' + processedRows);
    Logger.log('  Unique landing pages: ' + uniquePages);
    Logger.log('  Total clicks: ' + totalClicks);
    
    // Log each landing page and its click count
    for (var url in landingPages) {
      Logger.log('  [LP] URL: ' + url + ' -> ' + landingPages[url] + ' clicks');
    }

    if (uniquePages > 0 && totalClicks > 0) {
      Logger.log('  Sending landing_page_counts to API');
      return landingPages;
    }
    return null;
  } catch (error) {
    Logger.log(' [REPORT] Failed to collect yesterday data: ' + error);
    return null;
  }
}

// ============================================
// FETCH RECOMMENDED INTERVAL (STARTUP)
// ============================================
function fetchRecommendedInterval() {
  Logger.log('[ADAPTIVE] Fetching recommended interval for offer: ' + OFFER_NAME);
  Logger.log('[ADAPTIVE] Account ID: ' + ACCOUNT_ID);
  
  try {
    // Get yesterday's landing page data (for click count)
    var yesterdayData = getYesterdayLandingPages();
    
    // Get account timezone for proper yesterday calculation
    var accountTimezone = '';
    try {
      accountTimezone = AdsApp.currentAccount().getTimeZone();
      Logger.log('[ADAPTIVE] Account Timezone: ' + accountTimezone);
    } catch (e) {
      Logger.log(' [ADAPTIVE] Could not get timezone, API will use UTC');
    }
    
    var url = SUPABASE_URL + '/functions/v1/get-recommended-interval?offer_name=' + encodeURIComponent(OFFER_NAME);
    url += '&account_id=' + encodeURIComponent(ACCOUNT_ID);
    
    var options = { 
      muteHttpExceptions: true,
      method: 'post',
      contentType: 'application/json'
    };
    
    // If we have yesterday's data, send click count and timezone
    if (yesterdayData && Object.keys(yesterdayData).length > 0) {
      var totalClicks = 0;
      for (var url_key in yesterdayData) {
        totalClicks += yesterdayData[url_key];
      }
      var uniqueLandingPages = Object.keys(yesterdayData).length;
      
      Logger.log('[ADAPTIVE] Sending: ' + totalClicks + ' clicks, ' + uniqueLandingPages + ' unique landing pages + timezone to API');
      options.payload = JSON.stringify({
        yesterday_total_clicks: totalClicks,
        yesterday_unique_landing_pages: uniqueLandingPages,
        account_timezone: accountTimezone
      });
    } else {
      Logger.log('[ADAPTIVE] No yesterday data available, using database fallback');
      options.payload = JSON.stringify({
        yesterday_total_clicks: 0,
        yesterday_unique_landing_pages: 0,
        account_timezone: accountTimezone
      });
    }
    
    var response = UrlFetchApp.fetch(url, options);
    var responseCode = response.getResponseCode();
    var responseText = response.getContentText();
    
    Logger.log('[DEBUG] API Response Code: ' + responseCode);
    Logger.log('[DEBUG] API Response: ' + responseText.substring(0, 500));
    
    if (responseCode === 200) {
      var data = JSON.parse(responseText);
      Logger.log('[DEBUG] Parsed data - interval: ' + data.recommended_interval_ms);
      if (data.recommended_interval_ms) {
        CURRENT_INTERVAL_MS = data.recommended_interval_ms;
        Logger.log(' [ADAPTIVE] Using interval: ' + CURRENT_INTERVAL_MS + 'ms');
        Logger.log('   Data source: ' + (data.data_source || 'database'));
        Logger.log('   Yesterday interval: ' + (data.yesterday_interval_ms || 'none') + 'ms');
        Logger.log('   Yesterday clicks: ' + data.yesterday_clicks);
        Logger.log('   Yesterday landing pages: ' + data.yesterday_landing_pages);
        Logger.log('   Average repeats per page: ' + data.average_repeats);
        Logger.log('   Used fallback: ' + data.used_default_fallback);
        return true;
      } else {
        Logger.log(' [ADAPTIVE] API returned 200 but no recommended_interval_ms in response');
        Logger.log('[DEBUG] Full response: ' + responseText);
      }
    } else {
      Logger.log(' [ADAPTIVE] Failed to fetch interval (status ' + responseCode + '), using default');
      Logger.log('[DEBUG] Response: ' + responseText);
    }
  } catch (error) {
    Logger.log(' [ADAPTIVE] Error fetching interval: ' + error + ', using default');
  }
  
  CURRENT_INTERVAL_MS = DEFAULT_INTERVAL_MS;
  return false;
}

// ============================================
// CONTINUOUS CAMPAIGN UPDATE CONFIGURATION
// ============================================

// How often to call API and update campaigns (in milliseconds)
// Examples:
// - 300000 = 5 minutes (recommended)
// - 600000 = 10 minutes
// - 900000 = 15 minutes
// - 60000 = 1 minute (for testing)
var RUN_INTERVAL_MS = 300000;

// Maximum script runtime before timeout (in milliseconds)
// Google Ads limit is 30 minutes (1800000ms)
// Examples:
// - 1500000 = 25 minutes (recommended - safe buffer)
// - 1680000 = 28 minutes (aggressive - tight buffer)
// - 300000 = 5 minutes (for testing)
var MAX_RUNTIME_MS = 1500000;

// NOTE: Delay between individual campaign updates is now fetched dynamically
// from the endpoint via getCurrentIntervalFromAPI() - no hardcoded delay

// Update mode: "always" or "on_change"
// - "always": Update campaigns every cycle regardless of suffix changes
// - "on_change": Only update campaigns when suffix changes
var UPDATE_MODE = 'on_change';

// ============================================
// CAMPAIGN FILTERING OPTIONS (Choose ONE)
// ============================================

// Option 1: Filter by Campaign IDs (recommended - most precise)
// Array of campaign IDs to update. Leave empty [] to disable.
// Example: ['12345678', '87654321', '11223344']
// To find campaign IDs: Go to Campaigns tab, click on campaign, check URL for campaignId=XXXXXXXXXX
var CAMPAIGN_IDS = [];

// Option 2: Filter by Label (fallback if no IDs specified)
// Empty string = all enabled campaigns
// Example: 'auto-update' or 'offer-campaigns'
var CAMPAIGN_LABEL_FILTER = '';

// Dry run mode: Set to true to test without actually updating campaigns
var DRY_RUN_MODE = false;

// ============================================
// STATE TRACKING
// ============================================
var executionState = {
  startTime: new Date().getTime(),
  lastApiCall: 0,
  lastSuffix: '',
  totalApiCalls: 0,
  totalCampaignsUpdated: 0,
  cycleNumber: 0,
  errors: []
};

// Yesterday's data - calculated ONCE at startup, reused for all API calls
var YESTERDAY_DATA_CACHE = null;
var YESTERDAY_TOTAL_CLICKS = 0;
var YESTERDAY_UNIQUE_PAGES = 0;

// ============================================
// DYNAMIC INTERVAL FETCHING
// ============================================
function getCurrentIntervalFromAPI() {
  try {
    // Use cached yesterday data (already calculated at startup)
    var totalClicks = YESTERDAY_TOTAL_CLICKS;
    var uniqueLandingPages = YESTERDAY_UNIQUE_PAGES;
    
    Logger.log('[INTERVAL] Using cached yesterday data: ' + totalClicks + ' clicks, ' + uniqueLandingPages + ' pages (no recalculation)');
    
    if (uniqueLandingPages === 0) {
      Logger.log('[INTERVAL] No landing page data, using default: ' + DEFAULT_INTERVAL_MS + 'ms');
      return DEFAULT_INTERVAL_MS;
    }
    
    var accountTimezone = AdsApp.currentAccount().getTimeZone();
    
    // Build URL with offer_name and account_id as query parameters (required by endpoint)
    var url = SUPABASE_URL + '/functions/v1/get-recommended-interval?offer_name=' + encodeURIComponent(OFFER_NAME);
    url += '&account_id=' + encodeURIComponent(ACCOUNT_ID);
    
    var payload = {
      yesterday_total_clicks: totalClicks,
      yesterday_unique_landing_pages: uniqueLandingPages,
      account_timezone: accountTimezone
    };
    
    var options = {
      method: 'post',
      contentType: 'application/json',
      payload: JSON.stringify(payload),
      muteHttpExceptions: true
    };
    
    var response = UrlFetchApp.fetch(url, options);
    var responseCode = response.getResponseCode();
    var responseText = response.getContentText();
    
    if (responseCode === 200) {
      var result = JSON.parse(responseText);
      if (result.recommended_interval_ms) {
        var cacheInfo = result.data_source === 'cache' ? ' (from API daily cache)' : ' (newly calculated)';
        Logger.log('[INTERVAL] Fetched: ' + result.recommended_interval_ms + 'ms' + cacheInfo);
        return result.recommended_interval_ms;
      }
    }
    
    Logger.log('[INTERVAL] API call failed, using default: ' + DEFAULT_INTERVAL_MS + 'ms');
    return DEFAULT_INTERVAL_MS;
  } catch (error) {
    Logger.log('[INTERVAL] Error fetching: ' + error + ', using default: ' + DEFAULT_INTERVAL_MS + 'ms');
    return DEFAULT_INTERVAL_MS;
  }
}

// ============================================
// API CALL FUNCTION
// ============================================
function callGetSuffixAPI(campaignCount, intervalToUse) {
  executionState.totalApiCalls++;
  
  campaignCount = campaignCount || 1;
  intervalToUse = intervalToUse || DEFAULT_INTERVAL_MS;
  
  var url = SUPABASE_URL + '/functions/v1/get-suffix?offer_name=' + encodeURIComponent(OFFER_NAME);
  
  // Add account_id parameter for multi-account support
  url += '&account_id=' + encodeURIComponent(ACCOUNT_ID);
  
  // Add campaign_count parameter for batch requests
  if (campaignCount > 1) {
    url += '&campaign_count=' + campaignCount;
    Logger.log('[API] Requesting ' + campaignCount + ' unique suffixes');
  }
  
  // Pass the interval to track actual speed used
  if (intervalToUse > 0) {
    url += '&interval_used=' + intervalToUse;
  }

  var options = {
    'method': 'get',
    'muteHttpExceptions': true
  };

  var maxRetries = 3;
  var retryCount = 0;

  while (retryCount < maxRetries) {
    try {
      var callStart = new Date().getTime();
      var response = UrlFetchApp.fetch(url, options);
      var callEnd = new Date().getTime();
      var json = JSON.parse(response.getContentText());

      if (json.success) {
        Logger.log('[API SUCCESS] Response time: ' + (callEnd - callStart) + 'ms');
        
        return {
          success: true,
          suffix: json.suffix || '',
          suffixes: json.suffixes || [],
          finalUrl: json.final_url,
          changed: json.suffix !== executionState.lastSuffix,
          timestamp: new Date()
        };
      } else {
        Logger.log('[API ERROR] Invalid response: ' + JSON.stringify(json));
      }
    } catch (e) {
      retryCount++;
      Logger.log('[API ERROR] Attempt ' + retryCount + '/' + maxRetries + ': ' + e.toString());

      if (retryCount < maxRetries) {
        Utilities.sleep(2000 * retryCount);
      } else {
        executionState.errors.push({
          type: 'api_error',
          message: e.toString(),
          timestamp: new Date()
        });
      }
    }
  }

  return {
    success: false,
    error: 'Failed after ' + maxRetries + ' attempts'
  };
}

// ============================================
// CAMPAIGN UPDATE FUNCTION
// ============================================
function updateCampaigns(currentInterval) {
  var campaignSelector;

  // Priority 1: Filter by Campaign IDs if provided
  if (CAMPAIGN_IDS && CAMPAIGN_IDS.length > 0) {
    Logger.log('[FILTER] Using Campaign IDs: ' + CAMPAIGN_IDS.join(', '));
    
    // Build ID filter condition
    var idConditions = [];
    for (var i = 0; i < CAMPAIGN_IDS.length; i++) {
      idConditions.push('Id = ' + CAMPAIGN_IDS[i]);
    }
    var idFilter = '(' + idConditions.join(' OR ') + ')';
    
    campaignSelector = AdsApp.campaigns()
      .withCondition('Status = ENABLED')
      .withCondition(idFilter);
  }
  // Priority 2: Filter by Label if no IDs specified
  else if (CAMPAIGN_LABEL_FILTER && CAMPAIGN_LABEL_FILTER !== '') {
    Logger.log('[FILTER] Using Label: ' + CAMPAIGN_LABEL_FILTER);
    campaignSelector = AdsApp.campaigns()
      .withCondition('Status = ENABLED')
      .withCondition('LabelNames CONTAINS_ANY ["' + CAMPAIGN_LABEL_FILTER + '"]');
  }
  // Priority 3: All enabled campaigns
  else {
    Logger.log('[FILTER] Using all enabled campaigns');
    campaignSelector = AdsApp.campaigns()
      .withCondition('Status = ENABLED');
  }

  // First, count campaigns
  var campaigns = campaignSelector.get();
  var campaignList = [];
  while (campaigns.hasNext()) {
    campaignList.push(campaigns.next());
  }
  
  var campaignCount = campaignList.length;
  Logger.log('[INFO] Found ' + campaignCount + ' campaigns to update');
  
  if (campaignCount === 0) {
    return {
      updated: 0,
      failed: 0,
      skipped: 0,
      apiCalls: 0
    };
  }

  var updatedCount = 0;
  var failedCount = 0;
  var skippedCount = 0;

  // Use the interval passed from main loop (already fetched once per cycle)
  Logger.log('[INTERVAL] Using pre-fetched interval: ' + currentInterval + 'ms');

  if (DRY_RUN_MODE) {
    Logger.log('[DRY RUN] Would call API once for ' + campaignCount + ' campaigns');
    for (var i = 0; i < campaignList.length; i++) {
      Logger.log('[DRY RUN] Would update: ' + campaignList[i].getName() + ' (ID: ' + campaignList[i].getId() + ')');
      skippedCount++;
    }
    return {
      updated: 0,
      failed: 0,
      skipped: skippedCount,
      apiCalls: 0
    };
  }

  // Make SINGLE API call requesting multiple unique suffixes
  Logger.log('[API] Calling API once with campaign_count=' + campaignCount);
  var apiResult = callGetSuffixAPI(campaignCount, currentInterval);
  
  if (!apiResult.success) {
    Logger.log('[API ERROR] Failed to get suffixes: ' + (apiResult.error || 'Unknown error'));
    executionState.errors.push({
      type: 'api_error',
      message: apiResult.error || 'Failed to get suffixes from API',
      timestamp: new Date()
    });
    return {
      updated: 0,
      failed: campaignCount,
      skipped: 0,
      apiCalls: 1
    };
  }
  
  // Get suffixes array (or single suffix for backward compatibility)
  var suffixes = [];
  if (apiResult.suffixes && apiResult.suffixes.length > 0) {
    suffixes = apiResult.suffixes;
    Logger.log('[API] Received ' + suffixes.length + ' unique suffixes');
  } else if (apiResult.suffix) {
    // Backward compatibility: single suffix
    suffixes = [{ suffix: apiResult.suffix }];
    Logger.log('[API] Received single suffix (backward compatibility mode)');
  }
  
  if (suffixes.length === 0) {
    Logger.log('[ERROR] No suffixes received from API');
    return {
      updated: 0,
      failed: campaignCount,
      skipped: 0,
      apiCalls: 1
    };
  }

  // Distribute unique suffixes to campaigns
  for (var i = 0; i < campaignList.length; i++) {
    var campaign = campaignList[i];
    
    // Use suffix from array, or reuse last if we run out
    var suffixIndex = Math.min(i, suffixes.length - 1);
    var suffixData = suffixes[suffixIndex];
    var suffix = suffixData.suffix || suffixData;
    
    try {
      campaign.urls().setFinalUrlSuffix(suffix);
      Logger.log('[UPDATED] ' + campaign.getName() + ' (ID: ' + campaign.getId() + ') with unique suffix #' + (suffixIndex + 1));
      updatedCount++;
      
      // Use pre-fetched interval for delay between campaigns
      if (i < campaignList.length - 1 && currentInterval > 0) {
        Logger.log('[DELAY] Waiting ' + currentInterval + 'ms before next update');
        Utilities.sleep(currentInterval);
      }
    } catch (e) {
      failedCount++;
      Logger.log('[CAMPAIGN ERROR] Failed to update ' + campaign.getName() + ' (ID: ' + campaign.getId() + '): ' + e.toString());
      executionState.errors.push({
        type: 'campaign_update_error',
        campaign: campaign.getName(),
        campaignId: campaign.getId(),
        message: e.toString(),
        timestamp: new Date()
      });
    }
  }

  executionState.totalCampaignsUpdated += updatedCount;

  return {
    updated: updatedCount,
    failed: failedCount,
    skipped: skippedCount,
    apiCalls: 1
  };
}

// ============================================
// TIME CALCULATION HELPERS
// ============================================
function getElapsedMs() {
  return new Date().getTime() - executionState.startTime;
}

function getRemainingMs() {
  return MAX_RUNTIME_MS - getElapsedMs();
}

function hasEnoughTime() {
  // Check if we have enough time for another cycle (max interval + 2min buffer)
  // Using MAX_INTERVAL_MS (30000) + 120000 buffer = 150000ms = 2.5 minutes
  return getRemainingMs() > (MAX_INTERVAL_MS + 120000);
}

function formatMs(ms) {
  var seconds = Math.floor(ms / 1000);
  var minutes = Math.floor(seconds / 60);
  seconds = seconds % 60;
  return minutes + 'm ' + seconds + 's';
}

// ============================================
// LOGGING FUNCTIONS
// ============================================
function logScriptStart() {
  Logger.log('====================================');
  Logger.log('CONTINUOUS CAMPAIGN UPDATER STARTED');
  Logger.log('====================================');
  Logger.log('Configuration:');
  Logger.log('  Offer Name: ' + OFFER_NAME);
  Logger.log('  Run Interval: ' + formatMs(RUN_INTERVAL_MS));
  Logger.log('  Max Runtime: ' + formatMs(MAX_RUNTIME_MS));
  Logger.log('  Update Mode: ' + UPDATE_MODE);
  
  // Show filter method
  if (CAMPAIGN_IDS && CAMPAIGN_IDS.length > 0) {
    Logger.log('  Filter Method: Campaign IDs');
    Logger.log('  Campaign IDs: ' + CAMPAIGN_IDS.join(', '));
  } else if (CAMPAIGN_LABEL_FILTER && CAMPAIGN_LABEL_FILTER !== '') {
    Logger.log('  Filter Method: Campaign Label');
    Logger.log('  Campaign Label: ' + CAMPAIGN_LABEL_FILTER);
  } else {
    Logger.log('  Filter Method: All enabled campaigns');
  }
  
  Logger.log('  Dry Run: ' + (DRY_RUN_MODE ? 'YES' : 'NO'));
  Logger.log('  Note: Interval fetched dynamically from endpoint before each delay');
  Logger.log('====================================');
}

function logCycleStart() {
  executionState.cycleNumber++;
  Logger.log('');
  Logger.log('--- CYCLE #' + executionState.cycleNumber + ' ---');
  Logger.log('Time: ' + new Date().toLocaleString());
  Logger.log('Elapsed: ' + formatMs(getElapsedMs()) + ' / ' + formatMs(MAX_RUNTIME_MS));
  Logger.log('Remaining: ' + formatMs(getRemainingMs()));
}

function logFinalSummary() {
  Logger.log('');
  Logger.log('====================================');
  Logger.log('EXECUTION SUMMARY');
  Logger.log('====================================');
  Logger.log('Total Runtime: ' + formatMs(getElapsedMs()));
  Logger.log('Total Cycles: ' + executionState.cycleNumber);
  Logger.log('Total API Calls: ' + executionState.totalApiCalls);
  Logger.log('Total Campaigns Updated: ' + executionState.totalCampaignsUpdated);
  Logger.log('Total Errors: ' + executionState.errors.length);

  if (executionState.errors.length > 0) {
    Logger.log('');
    Logger.log('Error Details:');
    for (var i = 0; i < executionState.errors.length; i++) {
      var error = executionState.errors[i];
      Logger.log('  [' + error.type + '] ' + error.message);
    }
  }

  Logger.log('====================================');
  Logger.log('Script finished at: ' + new Date().toLocaleString());
  Logger.log('====================================');
}

// ============================================
// MAIN EXECUTION LOOP
// ============================================
function main() {
  // Set account ID at startup
  ACCOUNT_ID = getAccountId();
  Logger.log('[STARTUP] Account ID: ' + ACCOUNT_ID);
  
  logScriptStart();

  // Calculate yesterday's data ONCE at startup (expensive query)
  Logger.log('[STARTUP] Calculating yesterday\\'s landing page data (one-time calculation)...');
  YESTERDAY_DATA_CACHE = getYesterdayLandingPages();
  
  if (YESTERDAY_DATA_CACHE) {
    YESTERDAY_TOTAL_CLICKS = 0;
    for (var url in YESTERDAY_DATA_CACHE) {
      YESTERDAY_TOTAL_CLICKS += YESTERDAY_DATA_CACHE[url];
    }
    YESTERDAY_UNIQUE_PAGES = Object.keys(YESTERDAY_DATA_CACHE).length;
    Logger.log('[STARTUP] Cached yesterday data: ' + YESTERDAY_TOTAL_CLICKS + ' clicks, ' + YESTERDAY_UNIQUE_PAGES + ' unique pages');
  } else {
    Logger.log('[STARTUP] No yesterday data available, will use defaults');
    YESTERDAY_TOTAL_CLICKS = 0;
    YESTERDAY_UNIQUE_PAGES = 0;
  }

  // Interval is now fetched dynamically from endpoint before each use
  Logger.log('[STARTUP] Interval will be fetched dynamically from endpoint before each delay');

  try {
    while (hasEnoughTime()) {
      logCycleStart();

      // Fetch interval ONCE at the start of each cycle
      Logger.log('[INTERVAL] Fetching interval for this cycle...');
      var cycleInterval = getCurrentIntervalFromAPI();
      Logger.log('[INTERVAL] Using ' + cycleInterval + 'ms for this entire cycle');

      // Update campaigns - each campaign gets a unique suffix from API
      Logger.log('[UPDATE MODE] Calling API once per campaign for unique parameters');
      var updateResult = updateCampaigns(cycleInterval); // Pass interval to avoid re-fetching
      
      // Log cycle results
      Logger.log('[CYCLE COMPLETE]');
      Logger.log('  API Calls This Cycle: ' + updateResult.apiCalls);
      Logger.log('  Campaigns Updated: ' + updateResult.updated);
      Logger.log('  Campaigns Failed: ' + updateResult.failed);
      Logger.log('  Campaigns Skipped: ' + updateResult.skipped);
      
      executionState.totalApiCalls += updateResult.apiCalls;

      // Sleep using the same interval we already fetched (no re-query)
      if (hasEnoughTime()) {
        Logger.log('[WAITING] Sleeping for ' + cycleInterval + 'ms until next cycle...');
        Utilities.sleep(cycleInterval);
      }
    }

    Logger.log('');
    Logger.log('[TIMEOUT APPROACHING] Stopping execution to prevent timeout');

  } catch (e) {
    Logger.log('[FATAL ERROR] ' + e.toString());
    executionState.errors.push({
      type: 'fatal_error',
      message: e.toString(),
      timestamp: new Date()
    });
  }

  logFinalSummary();
}

// ============================================
// HELPER FUNCTIONS
// ============================================

/**
 * List all enabled campaigns with their IDs
 * Run this once to find Campaign IDs for the CAMPAIGN_IDS array
 */
function listCampaignIds() {
  Logger.log('\\n' + '='.repeat(60));
  Logger.log('CAMPAIGN ID FINDER');
  Logger.log('='.repeat(60));
  
  var campaigns = AdsApp.campaigns()
    .withCondition('Status = ENABLED')
    .get();
  
  var count = 0;
  while (campaigns.hasNext()) {
    var campaign = campaigns.next();
    count++;
    Logger.log(count + '. ' + campaign.getName());
    Logger.log('   ID: ' + campaign.getId());
    Logger.log('   Status: ' + campaign.getStatsFor('LAST_30_DAYS').getClicks() + ' clicks (30d)');
    Logger.log('');
  }
  
  Logger.log('='.repeat(60));
  Logger.log('Total: ' + count + ' enabled campaigns');
  Logger.log('='.repeat(60));
}`,v=`${r}/functions/v1/get-suffix?offer_name=OFFER_NAME&redirect=true`,j=`<script>
(function() {
  // Replace 'OFFER_NAME' with your actual offer name
  var offerName = 'OFFER_NAME';

  var apiUrl = '${r}/functions/v1/get-suffix?offer_name=' + encodeURIComponent(offerName);

  fetch(apiUrl)
    .then(function(response) { return response.json(); })
    .then(function(data) {
      if (data.success && data.suffix) {
        var redirectUrl = data.final_url + '?' + data.suffix;
        window.location.href = redirectUrl;
      } else {
        console.error('Failed to get tracking parameters');
      }
    })
    .catch(function(error) {
      console.error('Error:', error);
    });
})();
<\/script>`,g=`<!-- Replace 'OFFER_NAME' with your actual offer name -->
<img src="${r}/functions/v1/track-hit-instant?offer=OFFER_NAME" width="1" height="1" style="display:none" />`,m=`<!-- Replace 'OFFER_NAME' with your actual offer name -->
<a href="${r}/functions/v1/track-hit-instant?offer=OFFER_NAME&redirect=true">
  Click Here
</a>`,p=`# Get Suffix (with redirect)
curl "${r}/functions/v1/get-suffix?offer_name=OFFER_NAME&redirect=true"

# Track Hit Instant (with instant redirect - RECOMMENDED)
curl "${r}/functions/v1/track-hit-instant?offer=OFFER_NAME&redirect=true"

# Trace Redirects (via EC2 Proxy Service)
# Note: Configure VITE_EC2_PROXY_URL in .env first
curl -X POST "http://YOUR_EC2_IP:3000/trace" \\
  -H "Content-Type: application/json" \\
  -d '{
    "url": "https://example.com/tracking-url",
    "max_redirects": 20,
    "timeout_ms": 60000
  }'`;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-50",children:"Integration Scripts"}),a.jsx("p",{className:"text-neutral-600 dark:text-neutral-400 mt-1",children:"Ready-to-use scripts for Google Ads, landing pages, and tracking. Replace 'OFFER_NAME' with your actual offer name."})]}),a.jsxs("div",{className:"bg-gradient-to-r from-brand-50 to-brand-100 dark:from-brand-900/20 dark:to-brand-800/20 border border-brand-200 dark:border-brand-800 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(co,{className:"text-brand-600 dark:text-brand-400",size:24}),a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"Test Redirect Tracer"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"Tracer Mode"}),a.jsxs("select",{value:i,onChange:S=>l(S.target.value),className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth",children:[a.jsx("option",{value:"http_only",children:"HTTP-Only (Fast, 2-5s) - Recommended for testing"}),a.jsx("option",{value:"browser",children:"Browser (Complex, 10-30s) - Full JS + Popups"}),a.jsx("option",{value:"anti_cloaking",children:"Anti-Cloaking (Advanced, 15-60s) - Stealth mode"}),a.jsx("option",{value:"interactive",children:"Interactive (Engagement, 20-40s) - Session engagement"}),a.jsx("option",{value:"brightdata_browser",children:"Bright Data Browser (5-15s) - Premium proxy, minimal bandwidth"})]}),a.jsxs("div",{className:"mt-2 space-y-1 text-xs text-neutral-600 dark:text-neutral-400",children:[a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-success-700 dark:text-success-400",children:"HTTP-Only:"}),a.jsx("span",{children:"Simple redirect following. Fast and efficient."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-warning-700 dark:text-warning-400",children:"Browser:"}),a.jsx("span",{children:"Full JavaScript execution with popup tracking."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-brand-700 dark:text-brand-400",children:"Anti-Cloaking:"}),a.jsx("span",{children:"Bypasses bot detection, decodes obfuscation, tracks popups."})]}),a.jsxs("p",{className:"flex items-start gap-1",children:[a.jsx("span",{className:"font-semibold text-purple-700 dark:text-purple-400",children:"Bright Data Browser:"}),a.jsx("span",{children:"Premium residential proxy with browser automation, minimal bandwidth usage."})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:"URL to Trace"}),a.jsx("input",{type:"text",value:n,onChange:S=>s(S.target.value),placeholder:"https://example.com",className:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 dark:focus:ring-brand-400/20 focus:border-brand-500 dark:focus:border-brand-400 outline-none transition-smooth placeholder-neutral-400 dark:placeholder-neutral-500"}),a.jsx("p",{className:"mt-2 text-xs text-neutral-600 dark:text-neutral-400",children:"Luna Proxy will be automatically used if credentials are configured in Settings"})]}),a.jsx("button",{onClick:f,disabled:o||!n,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 transition-smooth disabled:opacity-50 disabled:cursor-not-allowed",children:o?a.jsxs(a.Fragment,{children:[a.jsx(rb,{size:18,className:"animate-spin"}),"Tracing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(co,{size:18}),"Trace Redirects"]})}),c&&a.jsx("div",{className:`mt-4 p-4 rounded-lg ${c.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:c.success?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"font-medium text-green-900",children:"Success!"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{className:"text-green-700",children:[c.total_steps," steps in ",c.total_timing_ms,"ms"]}),c.bandwidth_bytes&&a.jsxs("span",{className:"text-green-700 text-xs",children:[" ",c.bandwidth_bytes.toLocaleString()," B"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[c.mode_used&&a.jsxs("div",{children:[a.jsx("span",{className:"text-green-700 font-medium",children:"Mode Used:"}),a.jsx("span",{className:`ml-2 px-2 py-0.5 rounded font-semibold ${c.mode_used==="http_only"?"bg-green-100 text-green-800":c.mode_used==="browser"?"bg-orange-100 text-orange-800":"bg-purple-100 text-purple-800"}`,children:c.mode_used})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-green-700 font-medium",children:"Proxy Used:"}),a.jsx("span",{className:"ml-2 text-green-900",children:c.proxy_used?"Yes":"No"})]}),c.proxy_ip&&a.jsxs("div",{children:[a.jsx("span",{className:"text-green-700 font-medium",children:"Proxy IP:"}),a.jsx("span",{className:"ml-2 text-green-900",children:c.proxy_ip})]}),((_=c.geo_location)==null?void 0:_.country)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-green-700 font-medium",children:"Location:"}),a.jsxs("span",{className:"ml-2 text-green-900",children:[c.geo_location.city,", ",c.geo_location.country]})]}),c.total_popups>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-green-700 font-medium",children:"Popups Detected:"}),a.jsx("span",{className:"ml-2 text-green-900",children:c.total_popups})]}),c.aggressiveness_level&&a.jsxs("div",{children:[a.jsx("span",{className:"text-green-700 font-medium",children:"Aggressiveness:"}),a.jsx("span",{className:"ml-2 text-green-900",children:c.aggressiveness_level})]})]}),c.cloaking_indicators&&c.cloaking_indicators.length>0&&a.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded p-2",children:[a.jsx("p",{className:"text-xs font-semibold text-orange-900 mb-1",children:" Cloaking Indicators Detected:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:c.cloaking_indicators.map((S,N)=>a.jsx("span",{className:"text-xs px-2 py-0.5 bg-orange-100 text-orange-800 rounded",children:S},N))})]}),a.jsxs("div",{className:"border-t border-green-200 pt-3",children:[a.jsx("p",{className:"text-xs font-medium text-green-700 mb-2",children:"Redirect Chain:"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:(C=c.chain)==null?void 0:C.map((S,N)=>a.jsxs("div",{className:"bg-white p-2 rounded text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"font-mono text-green-700",children:["#",N+1]}),a.jsx("span",{className:`px-2 py-0.5 rounded ${S.status>=200&&S.status<300?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:S.status}),a.jsx("span",{className:"text-gray-600",children:S.redirect_type})]}),a.jsx("div",{className:"mt-1 text-gray-700 truncate",children:S.url}),S.timing_ms&&a.jsxs("div",{className:"text-gray-500 mt-1",children:[S.timing_ms,"ms"]})]},N))})]}),c.popup_chains&&c.popup_chains.length>0&&a.jsxs("div",{className:"border-t border-green-200 pt-3",children:[a.jsxs("p",{className:"text-xs font-medium text-green-700 mb-2",children:[" Popup Windows (",c.popup_chains.length,"):"]}),a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:c.popup_chains.map((S,N)=>a.jsxs("div",{className:"bg-purple-50 border border-purple-200 p-2 rounded text-xs",children:[a.jsxs("div",{className:"font-semibold text-purple-900 mb-1",children:["Popup #",S.popup_index]}),a.jsxs("div",{className:"text-gray-700",children:[a.jsx("span",{className:"font-medium",children:"From:"})," ",a.jsx("span",{className:"truncate block",children:S.opener_url})]}),a.jsxs("div",{className:"text-gray-700 mt-1",children:[a.jsx("span",{className:"font-medium",children:"Final:"})," ",a.jsx("span",{className:"truncate block",children:S.final_url})]}),S.chain&&S.chain.length>0&&a.jsxs("div",{className:"mt-1 text-gray-600",children:[S.chain.length," redirect step",S.chain.length!==1?"s":""," inside popup"]})]},N))})]}),c.obfuscated_urls&&c.obfuscated_urls.length>0&&a.jsxs("div",{className:"border-t border-green-200 pt-3",children:[a.jsxs("p",{className:"text-xs font-medium text-green-700 mb-2",children:[" Obfuscated URLs Found (",c.obfuscated_urls.length,"):"]}),a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:c.obfuscated_urls.map((S,N)=>a.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-2 rounded text-xs",children:[a.jsxs("div",{className:"font-semibold text-yellow-900 mb-1",children:["Type: ",S.type]}),S.encoded&&a.jsxs("div",{className:"text-gray-600 truncate",children:[a.jsx("span",{className:"font-medium",children:"Encoded:"})," ",S.encoded]}),S.decoded&&a.jsxs("div",{className:"text-gray-700 truncate mt-1",children:[a.jsx("span",{className:"font-medium",children:"Decoded:"})," ",S.decoded]}),S.url&&a.jsxs("div",{className:"text-gray-700 truncate mt-1",children:[a.jsx("span",{className:"font-medium",children:"URL:"})," ",S.url]})]},N))})]})]}):a.jsxs("div",{className:"text-sm text-red-900",children:[a.jsx("p",{className:"font-medium",children:"Error:"}),a.jsx("p",{children:c.error})]})})]})]}),a.jsx("div",{className:"bg-brand-50 dark:bg-brand-900/20 border border-brand-200 dark:border-brand-800 rounded-lg p-4",children:a.jsxs("p",{className:"text-sm text-brand-900 dark:text-brand-300",children:[a.jsx("strong",{children:"Important:"})," Replace 'OFFER_NAME' in all scripts with your actual offer name from the Offers page. The scripts will fetch fresh parameters on each call."]})}),a.jsxs("div",{className:"grid gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:[a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-850 px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(oo,{className:"text-neutral-600 dark:text-neutral-400",size:24}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"Google Ads Script (Baseline - Constant Delay)"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Fallback option: Simple script with fixed delay (5 seconds) - use if adaptive script fails"})]})]}),a.jsx("button",{onClick:()=>d(y,"google-ads"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-600 dark:bg-neutral-500 text-white rounded-lg hover:bg-neutral-700 dark:hover:bg-neutral-600 transition-smooth",children:e==="google-ads"?a.jsxs(a.Fragment,{children:[a.jsx(He,{size:18}),"Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:18}),"Copy"]})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-300 mb-2",children:" When to Use This Script"}),a.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-400 space-y-2",children:[a.jsx("p",{children:"Use this baseline script if:"}),a.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[a.jsx("li",{children:"The adaptive script (below) fails or encounters errors"}),a.jsx("li",{children:"You want a simple, predictable constant delay"}),a.jsx("li",{children:"You're testing and want no dynamic interval calculation"}),a.jsx("li",{children:"You don't have data history yet (fresh offer)"})]})]})]}),a.jsx("pre",{className:"bg-neutral-900 dark:bg-neutral-950 text-neutral-100 dark:text-neutral-200 text-sm p-4 rounded overflow-x-auto max-h-96",children:y}),a.jsxs("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-warning-900 dark:text-warning-300 mb-2",children:" Rate Control Configuration"}),a.jsxs("div",{className:"text-sm text-warning-800 dark:text-warning-400 space-y-2",children:[a.jsxs("p",{children:["The ",a.jsx("code",{className:"bg-warning-100 dark:bg-warning-900/30 px-1 py-0.5 rounded",children:"DELAY_MS"})," variable controls how fast the script calls your API endpoint."]}),a.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"0 ms"})," - No delay (fastest, for testing)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"1000 ms"})," - 1 second between calls (60 calls/min)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"2000 ms"})," - 2 seconds between calls (30 calls/min)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"5000 ms"})," - 5 seconds between calls (12 calls/min, default)"]})]}),a.jsx("p",{className:"pt-1",children:"Adjust based on your API limits and campaign requirements. Higher delays = slower API calls = lower server load."})]})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-success-200 dark:border-success-800 overflow-hidden",children:[a.jsxs("div",{className:"bg-gradient-to-r from-success-50 to-emerald-50 dark:from-success-900/20 dark:to-emerald-900/20 px-6 py-4 border-b border-success-200 dark:border-success-800 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(oo,{className:"text-success-600 dark:text-success-400",size:24}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"Google Ads Script (Adaptive V2 - Multi-Account) "}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"RECOMMENDED: Script collects & sends real landing page data with multi-account support for superior accuracy"})]})]}),a.jsx("button",{onClick:()=>d(x,"google-ads-scheduled"),className:"flex items-center gap-2 px-4 py-2 bg-success-600 dark:bg-success-500 text-white rounded-lg hover:bg-success-700 dark:hover:bg-success-600 transition-smooth",children:e==="google-ads-scheduled"?a.jsxs(a.Fragment,{children:[a.jsx(He,{size:18}),"Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:18}),"Copy"]})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-success-50 dark:bg-success-900/20 border border-success-300 dark:border-success-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-success-900 dark:text-success-300 mb-2",children:" How Adaptive V2 Works (Better!)"}),a.jsxs("div",{className:"text-sm text-success-800 dark:text-success-400 space-y-2",children:[a.jsx("p",{className:"font-semibold",children:"Yesterday's Performance Data:"}),a.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Historical Data:"})," Queries yesterday's AD_PERFORMANCE_REPORT for expanded landing pages"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Click Aggregation:"})," Groups clicks by landing page URL (sums duplicates)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Formula:"})," next_interval = previous_interval  (5 / max_duplicates)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Example Evolution:"})," Day1 5000ms  15 dup  1666ms  10 dup  833ms  6 dup  694ms  5 dup (stabilizes)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Multi-Account:"})," Uses account_id to track multiple accounts running same offer"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Daily Update:"})," Recalculates each morning using previous day's performance"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Result:"})," Adaptive interval based on yesterday's actual click distribution!"]})]}),a.jsx("p",{className:"pt-2 font-semibold text-success-900 dark:text-success-300",children:" Uses AD_PERFORMANCE_REPORT - real yesterday's data with click metrics!"})]})]}),a.jsx("pre",{className:"bg-neutral-900 dark:bg-neutral-950 text-neutral-100 dark:text-neutral-200 text-sm p-4 rounded overflow-x-auto max-h-96",children:x}),a.jsxs("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-warning-900 dark:text-warning-300 mb-3",children:" Configuration Variables"}),a.jsxs("div",{className:"text-sm text-warning-800 dark:text-warning-400 space-y-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"OFFER_NAME"}),a.jsx("p",{className:"ml-4",children:"Your offer name (required)"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"RUN_INTERVAL_MS"}),a.jsx("p",{className:"ml-4",children:"How often to call API in milliseconds (default: 300000 = 5 minutes)"}),a.jsx("p",{className:"ml-4 text-xs mt-1",children:"Examples: 60000=1m, 300000=5m, 600000=10m, 900000=15m"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"MAX_RUNTIME_MS"}),a.jsx("p",{className:"ml-4",children:"Maximum runtime in milliseconds (default: 1500000 = 25 minutes)"}),a.jsx("p",{className:"ml-4 text-xs mt-1",children:"Examples: 300000=5m, 1500000=25m, 1680000=28m"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"UPDATE_MODE"}),a.jsx("p",{className:"ml-4",children:'"always" = Update every cycle | "on_change" = Only when suffix changes'})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"CAMPAIGN_LABEL_FILTER"}),a.jsx("p",{className:"ml-4",children:"Optional: Filter campaigns by label (empty = all campaigns)"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"DRY_RUN_MODE"}),a.jsx("p",{className:"ml-4",children:"Set to true to test without actually updating campaigns"})]}),a.jsxs("div",{className:"bg-success-100 dark:bg-success-900/30 rounded p-2",children:[a.jsx("p",{className:"font-semibold text-success-900 dark:text-success-200",children:" Smart Delay Calculation"}),a.jsxs("p",{className:"ml-4 text-xs mt-1 text-success-900 dark:text-success-300",children:["Script calculates: ",a.jsx("code",{children:"max(1000, min(30000, yesterday_interval  (5 / max_duplicates)))"})]}),a.jsx("p",{className:"ml-4 text-xs mt-1 text-success-900 dark:text-success-300",children:"Constraint: Between 1000ms (never overload) and 30000ms (max cap)"})]})]})]}),a.jsxs("div",{className:"bg-success-50 dark:bg-success-900/20 border border-success-200 dark:border-success-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-success-900 dark:text-success-300 mb-2",children:" Expected Performance"}),a.jsxs("div",{className:"text-sm text-success-800 dark:text-success-400 space-y-2",children:[a.jsx("p",{children:"With default settings (RUN_INTERVAL_MS = 300000, MAX_RUNTIME_MS = 1500000):"}),a.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"~5 API calls"})," during single execution (5 min intervals over 25 min)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"~5 campaign updates"})," with dynamic intervals"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Automatic data collection:"})," Each API call records the interval used"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Daily optimization:"})," Tomorrow's interval recalculated from today's data"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Detailed logs:"})," Shows actual interval used, API response times, campaign updates"]})]}),a.jsx("p",{className:"pt-2",children:"Schedule this script every 30 minutes in Google Ads for continuous optimization!"})]})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:[a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-850 px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(el,{className:"text-success-600 dark:text-success-400",size:24}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"Tracking Template (Direct)"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Paste directly into Google Ads tracking template field"})]})]}),a.jsx("button",{onClick:()=>d(v,"tracking-template"),className:"flex items-center gap-2 px-4 py-2 bg-success-600 dark:bg-success-500 text-white rounded-lg hover:bg-success-700 dark:hover:bg-success-600 transition-smooth",children:e==="tracking-template"?a.jsxs(a.Fragment,{children:[a.jsx(He,{size:18}),"Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:18}),"Copy"]})})]}),a.jsx("div",{className:"p-6",children:a.jsx("pre",{className:"bg-neutral-900 dark:bg-neutral-950 text-neutral-100 dark:text-neutral-200 text-sm p-4 rounded overflow-x-auto",children:v})})]}),a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:[a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-850 px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(eb,{className:"text-brand-600 dark:text-brand-400",size:24}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"JavaScript Redirect Snippet"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Add to landing page for client-side redirect with fresh parameters"})]})]}),a.jsx("button",{onClick:()=>d(j,"js-snippet"),className:"flex items-center gap-2 px-4 py-2 bg-brand-600 dark:bg-brand-500 text-white rounded-lg hover:bg-brand-700 dark:hover:bg-brand-600 transition-smooth",children:e==="js-snippet"?a.jsxs(a.Fragment,{children:[a.jsx(He,{size:18}),"Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:18}),"Copy"]})})]}),a.jsx("div",{className:"p-6",children:a.jsx("pre",{className:"bg-neutral-900 dark:bg-neutral-950 text-neutral-100 dark:text-neutral-200 text-sm p-4 rounded overflow-x-auto",children:j})})]}),a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:[a.jsx("div",{className:"bg-neutral-50 dark:bg-neutral-850 px-6 py-4 border-b border-neutral-200 dark:border-neutral-800",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(el,{className:"text-warning-600 dark:text-warning-400",size:24}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"Tracking Pixel & Redirect Link"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Use for visitor tracking (pixel) or redirect links"})]})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Tracking Pixel (No Redirect)"}),a.jsx("button",{onClick:()=>d(g,"pixel"),className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-warning-600 dark:bg-warning-500 text-white rounded-lg hover:bg-warning-700 dark:hover:bg-warning-600 transition-smooth",children:e==="pixel"?a.jsxs(a.Fragment,{children:[a.jsx(He,{size:16}),"Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:16}),"Copy"]})})]}),a.jsx("pre",{className:"bg-neutral-900 dark:bg-neutral-950 text-neutral-100 dark:text-neutral-200 text-sm p-4 rounded overflow-x-auto",children:g})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Redirect Link"}),a.jsx("button",{onClick:()=>d(m,"redirect-link"),className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-warning-600 dark:bg-warning-500 text-white rounded-lg hover:bg-warning-700 dark:hover:bg-warning-600 transition-smooth",children:e==="redirect-link"?a.jsxs(a.Fragment,{children:[a.jsx(He,{size:16}),"Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:16}),"Copy"]})})]}),a.jsx("pre",{className:"bg-neutral-900 dark:bg-neutral-950 text-neutral-100 dark:text-neutral-200 text-sm p-4 rounded overflow-x-auto",children:m})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs dark:shadow-none border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:[a.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-850 px-6 py-4 border-b border-neutral-200 dark:border-neutral-800 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(el,{className:"text-neutral-600 dark:text-neutral-400",size:24}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50",children:"cURL Examples"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"API testing and integration examples"})]})]}),a.jsx("button",{onClick:()=>d(p,"curl"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-600 dark:bg-neutral-500 text-white rounded-lg hover:bg-neutral-700 dark:hover:bg-neutral-600 transition-smooth",children:e==="curl"?a.jsxs(a.Fragment,{children:[a.jsx(He,{size:18}),"Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:18}),"Copy"]})})]}),a.jsx("div",{className:"p-6",children:a.jsx("pre",{className:"bg-neutral-900 dark:bg-neutral-950 text-neutral-100 dark:text-neutral-200 text-sm p-4 rounded overflow-x-auto",children:p})})]})]}),a.jsxs("div",{className:"bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-warning-900 dark:text-warning-300 mb-2",children:"API Endpoints"}),a.jsxs("div",{className:"space-y-2 text-sm text-warning-800 dark:text-warning-400",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"GET /functions/v1/get-suffix"}),a.jsx("p",{className:"ml-4",children:"Fetches fresh tracking parameters for an offer"}),a.jsx("p",{className:"ml-4 text-xs",children:"Parameters: offer_name (required), redirect (optional)"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"GET /functions/v1/track-hit-instant"}),a.jsx("p",{className:"ml-4",children:"Instant redirect with background trace processing (RECOMMENDED)"}),a.jsx("p",{className:"ml-4 text-xs",children:"Parameters: offer (required), gclid/fbclid (Google/Facebook tracking)"}),a.jsx("p",{className:"ml-4 text-xs mt-1",children:"Response time: < 200ms, processes traces asynchronously"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"POST /trace (EC2 Proxy Service)"}),a.jsx("p",{className:"ml-4",children:"Traces complete redirect chain with Luna residential proxy and dynamic user agents"}),a.jsx("p",{className:"ml-4 text-xs",children:"Body: url, mode (http_only/browser), max_redirects, timeout_ms, proxy_ip (optional)"}),a.jsx("p",{className:"ml-4 text-xs mt-1",children:"Modes: http_only (fast, 2-5s), browser (full rendering, 10-30s)"})]})]})]})]})}function Eb(){const[e,t]=w.useState([]),[r,n]=w.useState(!0),[s,i]=w.useState("all"),[l,o]=w.useState(""),[u,c]=w.useState(null),[h,d]=w.useState(null);w.useEffect(()=>{f()},[]);const f=async()=>{n(!0);try{const{data:k,error:O}=await H.from("daily_trace_counts").select("*, offers(offer_name)").order("date",{ascending:!1}).order("created_at",{ascending:!1});if(O)throw O;const L=(k||[]).map(W=>{var le;return{...W,offer_name:((le=W.offers)==null?void 0:le.offer_name)||W.offer_id,total_clicks:W.total_clicks||0,unique_landing_pages:W.unique_landing_pages||0,average_repeats:W.unique_landing_pages&&W.total_clicks?W.total_clicks/W.unique_landing_pages:0}});t(L)}catch(k){console.error("Error fetching interval history:",k),alert("Failed to fetch interval history: "+k.message)}finally{n(!1)}},y=k=>{c({offer_id:k.offer_id,date:k.date,interval_used_ms:k.interval_used_ms,total_clicks:k.total_clicks||0,unique_landing_pages:k.unique_landing_pages||0})},x=()=>{c(null)},v=async()=>{if(u)try{const{error:k}=await H.from("daily_trace_counts").update({interval_used_ms:u.interval_used_ms,total_clicks:u.total_clicks,unique_landing_pages:u.unique_landing_pages}).eq("offer_id",u.offer_id).eq("date",u.date);if(k)throw k;c(null),f(),alert(" Successfully updated interval data")}catch(k){console.error("Error updating interval:",k),alert("Failed to update: "+k.message)}},j=async(k,O)=>{if((h==null?void 0:h.offer_id)===k&&(h==null?void 0:h.date)===O)try{const{error:L}=await H.from("daily_trace_counts").delete().eq("offer_id",k).eq("date",O);if(L)throw L;d(null),f(),alert(" Successfully deleted interval record")}catch(L){console.error("Error deleting interval:",L),alert("Failed to delete: "+L.message)}else d({offer_id:k,date:O}),setTimeout(()=>d(null),3e3)},g=["all",...new Set(e.map(k=>k.offer_name||k.offer_id))];let m=s==="all"?e:e.filter(k=>(k.offer_name||k.offer_id)===s);if(l.trim()){const k=l.toLowerCase();m=m.filter(O=>(O.offer_name||O.offer_id).toLowerCase().includes(k)||O.account_id.toLowerCase().includes(k)||O.date.includes(k)||C(O.interval_used_ms).toLowerCase().includes(k))}const p=e.reduce((k,O)=>{const L=O.offer_name||O.offer_id;return(!k[L]||new Date(O.date)>new Date(k[L].date))&&(k[L]=O),k},{}),_=k=>new Date(k).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),C=k=>k<1e3?`${k}ms`:`${(k/1e3).toFixed(1)}s`,S=(k,O)=>(u==null?void 0:u.offer_id)===k&&(u==null?void 0:u.date)===O,N=(k,O)=>(h==null?void 0:h.offer_id)===k&&(h==null?void 0:h.date)===O;return r?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-50",children:"Interval History"}),a.jsx("p",{className:"text-neutral-600 dark:text-neutral-400 mt-1",children:"Daily delay speeds calculated per offer based on landing page frequency"})]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("button",{onClick:f,disabled:r,className:"flex items-center gap-2 px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 hover:bg-neutral-50 dark:hover:bg-neutral-800 transition-smooth disabled:opacity-50",children:[a.jsx(vu,{size:16,className:r?"animate-spin":""}),"Refresh"]})})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(f0,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400",size:18}),a.jsx("input",{type:"text",value:l,onChange:k=>o(k.target.value),placeholder:"Search by offer, account ID, date, or interval...",className:"w-full pl-10 pr-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 placeholder-neutral-400 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"})]}),a.jsx("select",{value:s,onChange:k=>i(k.target.value),className:"px-4 py-2 border border-neutral-300 dark:border-neutral-700 rounded-lg bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none",children:g.map(k=>a.jsx("option",{value:k,children:k==="all"?"All Offers":k},k))}),(l||s!=="all")&&a.jsx("button",{onClick:()=>{o(""),i("all")},className:"px-3 py-2 text-sm text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-50 transition-smooth",children:"Clear Filters"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(p).map(([k,O])=>a.jsxs("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs border border-neutral-200 dark:border-neutral-800 p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold text-neutral-900 dark:text-neutral-50 text-sm truncate flex-1",children:k}),a.jsx(fi,{className:"text-brand-600 dark:text-brand-400 flex-shrink-0",size:18})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-brand-600 dark:text-brand-400",children:C(O.interval_used_ms)}),a.jsx("p",{className:"text-xs text-neutral-600 dark:text-neutral-400",children:"Current Delay"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-neutral-600 dark:text-neutral-400",children:"Avg Repeats"}),a.jsxs("p",{className:"font-semibold text-neutral-900 dark:text-neutral-50",children:[O.average_repeats.toFixed(1),"x"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-neutral-600 dark:text-neutral-400",children:"Last Updated"}),a.jsx("p",{className:"font-semibold text-neutral-900 dark:text-neutral-50",children:_(O.date)})]})]})]})]},k))}),a.jsx("div",{className:"bg-white dark:bg-neutral-900 rounded-lg shadow-xs border border-neutral-200 dark:border-neutral-800 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-neutral-50 dark:bg-neutral-850 border-b border-neutral-200 dark:border-neutral-800",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Offer"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Account ID"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Interval"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Clicks"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Landing Pages"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Avg Repeats"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Trend"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-neutral-200 dark:divide-neutral-800",children:m.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"px-6 py-8 text-center text-neutral-500 dark:text-neutral-400",children:"No interval history available"})}):m.map((k,O)=>{const L=m[O+1],W=L?k.interval_used_ms-L.interval_used_ms:0,le=S(k.offer_id,k.date),ce=N(k.offer_id,k.date);return a.jsxs("tr",{className:`hover:bg-neutral-50 dark:hover:bg-neutral-850 ${ce?"bg-error-50 dark:bg-error-900/20":""}`,children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-900 dark:text-neutral-50",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yu,{size:14,className:"text-neutral-400"}),_(k.date)]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-neutral-900 dark:text-neutral-50",children:k.offer_name}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-600 dark:text-neutral-400 font-mono",children:k.account_id}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right",children:le?a.jsx("input",{type:"number",value:(u==null?void 0:u.interval_used_ms)||0,onChange:Pe=>u&&c({...u,interval_used_ms:parseInt(Pe.target.value)||0}),className:"w-24 px-2 py-1 text-right border border-neutral-300 dark:border-neutral-700 rounded bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"}):a.jsx("span",{className:"font-semibold text-brand-600 dark:text-brand-400",children:C(k.interval_used_ms)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-900 dark:text-neutral-50 text-right",children:le?a.jsx("input",{type:"number",value:(u==null?void 0:u.total_clicks)||0,onChange:Pe=>u&&c({...u,total_clicks:parseInt(Pe.target.value)||0}),className:"w-20 px-2 py-1 text-right border border-neutral-300 dark:border-neutral-700 rounded bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"}):k.total_clicks}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-900 dark:text-neutral-50 text-right",children:le?a.jsx("input",{type:"number",value:(u==null?void 0:u.unique_landing_pages)||0,onChange:Pe=>u&&c({...u,unique_landing_pages:parseInt(Pe.target.value)||0}),className:"w-20 px-2 py-1 text-right border border-neutral-300 dark:border-neutral-700 rounded bg-white dark:bg-neutral-850 text-neutral-900 dark:text-neutral-50 focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 outline-none"}):k.unique_landing_pages}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-900 dark:text-neutral-50 text-right",children:le?a.jsxs("span",{className:"text-neutral-600 dark:text-neutral-400",children:[u&&u.unique_landing_pages>0?(u.total_clicks/u.unique_landing_pages).toFixed(2):"0.00","x"]}):`${k.average_repeats.toFixed(2)}x`}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right",children:W===0?a.jsx("span",{className:"text-neutral-400",children:""}):W>0?a.jsxs("span",{className:"flex items-center justify-end gap-1 text-warning-600 dark:text-warning-400",children:[a.jsx(p0,{size:14}),"+",C(Math.abs(W))]}):a.jsxs("span",{className:"flex items-center justify-end gap-1 text-success-600 dark:text-success-400",children:[a.jsx(fb,{size:14}),"-",C(Math.abs(W))]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right",children:le?a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{onClick:v,className:"p-1.5 text-success-600 dark:text-success-400 hover:bg-success-50 dark:hover:bg-success-900/20 rounded transition-smooth",title:"Save changes",children:a.jsx(Nr,{size:16})}),a.jsx("button",{onClick:x,className:"p-1.5 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded transition-smooth",title:"Cancel",children:a.jsx(Cr,{size:16})})]}):a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("button",{onClick:()=>y(k),className:"p-1.5 text-brand-600 dark:text-brand-400 hover:bg-brand-50 dark:hover:bg-brand-900/20 rounded transition-smooth",title:"Edit",children:a.jsx(h0,{size:16})}),a.jsx("button",{onClick:()=>j(k.offer_id,k.date),className:`p-1.5 rounded transition-smooth ${ce?"bg-error-600 text-white hover:bg-error-700":"text-error-600 dark:text-error-400 hover:bg-error-50 dark:hover:bg-error-900/20"}`,title:ce?"Click again to confirm":"Delete",children:a.jsx(Ss,{size:16})})]})})]},`${k.offer_id}-${k.date}-${k.created_at}`)})})]})})}),a.jsxs("div",{className:"bg-brand-50 dark:bg-brand-900/20 border border-brand-200 dark:border-brand-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-brand-900 dark:text-brand-300 mb-2",children:" How Intervals Work"}),a.jsxs("div",{className:"text-sm text-brand-800 dark:text-brand-400 space-y-2",children:[a.jsx("p",{children:"The system calculates optimal delay intervals based on landing page frequency:"}),a.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Formula:"})," next_interval = yesterday_interval  (5 / average_repeats)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Target:"})," 5 clicks per landing page on average"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Constraints:"})," Between 1000ms (min) and 30000ms (max)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Updates:"})," Calculated once per day based on previous day's data"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Caching:"})," Same interval used throughout the day (recalculates next day)"]})]})]})]})]})}function Cb(){const[e,t]=w.useState(null),[r,n]=w.useState(!0),{theme:s,toggleTheme:i}=gb(),{role:l,loading:o}=g0(),u=Cn();w.useEffect(()=>{H.auth.getSession().then(({data:{session:y}})=>{t((y==null?void 0:y.user)??null),n(!1)});const{data:{subscription:f}}=H.auth.onAuthStateChange((y,x)=>{t((x==null?void 0:x.user)??null)});return()=>f.unsubscribe()},[]);const c=async()=>{await H.auth.signOut()};if(r||o)return a.jsx("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-950 flex items-center justify-center transition-colors",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-2 border-brand-500 border-t-transparent mx-auto mb-3"}),a.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"Loading..."})]})});if(!e)return a.jsx(xb,{});if(!l)return a.jsx("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-950 flex items-center justify-center transition-colors",children:a.jsxs("div",{className:"text-center max-w-md p-6",children:[a.jsx("div",{className:"mb-4 text-error-500",children:a.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h2",{className:"text-lg font-semibold text-neutral-900 dark:text-neutral-50 mb-2",children:"No User Role Assigned"}),a.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mb-4",children:"Your account doesn't have a role assigned yet. Please contact an administrator."}),a.jsx("button",{onClick:c,className:"px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-smooth text-sm font-medium",children:"Logout"})]})});const h=f=>u.pathname===f,d=l==="admin";return a.jsxs("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-950 transition-colors",children:[a.jsx("nav",{className:"sticky top-0 z-50 bg-white/90 dark:bg-neutral-900/90 backdrop-blur-xl border-b border-neutral-200 dark:border-neutral-800/50 shadow-sm dark:shadow-none",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex justify-between items-center h-12",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex items-center justify-center w-7 h-7 bg-brand-600 rounded-lg",children:a.jsx(ar,{className:"text-white",size:14})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h1",{className:"text-sm font-semibold text-neutral-900 dark:text-neutral-50 tracking-tight",children:"URL Tracker"}),a.jsxs("div",{className:`px-1.5 py-0.5 rounded-md text-[10px] font-medium flex items-center gap-1 ${d?"bg-brand-500/10 text-brand-600 dark:text-brand-400 border border-brand-500/20":"bg-success-500/10 text-success-600 dark:text-success-400 border border-success-500/20"}`,children:[d?a.jsx(ma,{size:9}):a.jsx(uo,{size:9}),d?"ADMIN":"VIEWER"]})]})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-1",children:[d&&a.jsxs(Dn,{to:"/",className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-smooth ${h("/")?"bg-neutral-100 dark:bg-neutral-800 text-neutral-900 dark:text-neutral-50":"text-neutral-600 dark:text-neutral-400 hover:bg-neutral-50 dark:hover:bg-neutral-850 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:[a.jsx(ar,{size:14}),a.jsx("span",{className:"hidden lg:inline",children:"Offers"})]}),d&&a.jsxs(Dn,{to:"/scripts",className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-smooth ${h("/scripts")?"bg-neutral-100 dark:bg-neutral-800 text-neutral-900 dark:text-neutral-50":"text-neutral-600 dark:text-neutral-400 hover:bg-neutral-50 dark:hover:bg-neutral-850 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:[a.jsx(oo,{size:14}),a.jsx("span",{className:"hidden lg:inline",children:"Scripts"})]}),d&&a.jsxs(Dn,{to:"/intervals",className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-smooth ${h("/intervals")?"bg-neutral-100 dark:bg-neutral-800 text-neutral-900 dark:text-neutral-50":"text-neutral-600 dark:text-neutral-400 hover:bg-neutral-50 dark:hover:bg-neutral-850 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:[a.jsx(fi,{size:14}),a.jsx("span",{className:"hidden lg:inline",children:"Intervals"})]}),a.jsxs(Dn,{to:"/analytics",className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-smooth ${h("/analytics")?"bg-neutral-100 dark:bg-neutral-800 text-neutral-900 dark:text-neutral-50":"text-neutral-600 dark:text-neutral-400 hover:bg-neutral-50 dark:hover:bg-neutral-850 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:[a.jsx(Gr,{size:14}),a.jsx("span",{className:"hidden lg:inline",children:"Analytics"})]}),d&&a.jsxs(Dn,{to:"/settings",className:`flex items-center gap-1.5 px-2.5 py-1.5 rounded-md text-xs font-medium transition-smooth ${h("/settings")?"bg-neutral-100 dark:bg-neutral-800 text-neutral-900 dark:text-neutral-50":"text-neutral-600 dark:text-neutral-400 hover:bg-neutral-50 dark:hover:bg-neutral-850 hover:text-neutral-900 dark:hover:text-neutral-200"}`,children:[a.jsx(ob,{size:14}),a.jsx("span",{className:"hidden lg:inline",children:"Settings"})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:i,className:"p-1.5 text-neutral-500 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-50 rounded-md transition-smooth",title:`Switch to ${s==="light"?"dark":"light"} mode`,"aria-label":"Toggle theme",children:s==="light"?a.jsx(ab,{size:14}):a.jsx(db,{size:14})}),a.jsxs("button",{onClick:c,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-50 rounded-md transition-smooth text-xs font-medium","aria-label":"Logout",children:[a.jsx(sb,{size:14}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsxs(nx,{children:[d?a.jsxs(a.Fragment,{children:[a.jsx(Nt,{path:"/",element:a.jsx(vb,{})}),a.jsx(Nt,{path:"/scripts",element:a.jsx(Sb,{})}),a.jsx(Nt,{path:"/intervals",element:a.jsx(Eb,{})}),a.jsx(Nt,{path:"/analytics",element:a.jsx(wd,{})}),a.jsx(Nt,{path:"/settings",element:a.jsx(Nb,{})})]}):a.jsxs(a.Fragment,{children:[a.jsx(Nt,{path:"/",element:a.jsx(Wc,{to:"/analytics",replace:!0})}),a.jsx(Nt,{path:"/analytics",element:a.jsx(wd,{})})]}),a.jsx(Nt,{path:"*",element:a.jsx(Wc,{to:d?"/":"/analytics",replace:!0})})]})})]})}function Tb(){return a.jsx(mb,{children:a.jsx(cx,{children:a.jsx(Cb,{})})})}tl.createRoot(document.getElementById("root")).render(a.jsx(Pd.StrictMode,{children:a.jsx(Tb,{})}));
